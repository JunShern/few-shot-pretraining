{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": true,
            "reason": "Text contains ['1', '2', '2', '-', '0', '0', '2', '-', '0', '0', '1', '0', '0', '0', '0', '1', '3', '0', '*', '*', '*', '*', '*', '*', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '*', '4', '4', '-', '4', '-', '5', '3', '3', '3', '2', '2', '2']."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "6854",
    "text": "1. Introduction {#sec1-sensors-15-27142}\n===============\n\nAccurate exhaust gas recirculation (EGR) rate control and air-fuel ratio (AFR) control are important technologies to satisfy the increasingly stringent emission regulations, which are dependent on the precise calculation of the EGR rate and AFR \\[[@B1-sensors-15-27142],[@B2-sensors-15-27142]\\]. The accuracy of the EGR rate and AFR can be improved by a mass air flow (MAF) sensor, in which a sensor element is heated to a fixed temperature, and the difference in temperature attributed to heat transfer from the heating element to the air flow is a measure of the air mass flow \\[[@B3-sensors-15-27142],[@B4-sensors-15-27142],[@B5-sensors-15-27142]\\]. However, there are many different local flow fields within the inlet piping due to the three-dimensional turbulence flow, leading to measurement biases in the MAF sensor installed between the air filter and the intake manifold. In addition, the MAF sensor is also subjected to aging phenomena owing to the accumulation of dust on the sensing element, which causes the deterioration of the measurement accuracy \\[[@B6-sensors-15-27142],[@B7-sensors-15-27142]\\]. These errors will bring about an inaccurate EGR rate and AFR and have adverse impacts on the emission performance of diesel engine.\n\nIt is difficult to accurately establish an analytical model for the MAF sensor error. In view of the relatively low computational load, maps (or lookup tables) have been widely used to characterize systems where the functional relationship is unavailable or too complex to represent analytically \\[[@B8-sensors-15-27142]\\]. Therefore, the relative error of the MAF sensor is described as a one-dimensional (1D) map taking compressor mass air flow as input \\[[@B2-sensors-15-27142]\\]. In order to track MAF sensor aging, the extended Kalman filter (EKF) for updating maps is presented in \\[[@B9-sensors-15-27142],[@B10-sensors-15-27142],[@B11-sensors-15-27142]\\], in which the 1D map is represented as a piecewise linear interpolation model and the map parameters are considered as parameter states. Due to the piecewise linear interpolation model having the characteristic of partition calculation and due to the the map input being able to enter only one input interval of the 1D map at any time, then only two parameter states participating in linear interpolation are observable and the other not. Therefore, the error covariance matrix elements of EKF corresponding to the locally unobservable parameter states will increase linearly. Although the solution is to limit this growth in \\[[@B9-sensors-15-27142],[@B10-sensors-15-27142],[@B11-sensors-15-27142]\\], the convergence of EKF with a confined covariance matrix cannot be guaranteed. In addition, the measurement error of the MAF sensor depends on the engine operating point, which is usually defined as fuel mass injection quantity and engine speed. The 1D map representing MAF sensor error ignores the engine speed, reducing the accuracy when the diesel engine is run over a wide speed range.\n\nThe adaptive observer with the advantage of simple convergence conditions is an alternative method for updating maps. Recursive algorithms designed for joint estimation of states and parameters in state space systems are usually known as adaptive observers, and some early works with adaptive observers to jointly estimate states and parameters in multi-input-multi-output linear time varying systems can be found in \\[[@B12-sensors-15-27142],[@B13-sensors-15-27142]\\]. In order to estimate sensor faults, adaptive observers for linear time varying systems with unknown parameters in output equations have been studied \\[[@B14-sensors-15-27142],[@B15-sensors-15-27142]\\]. However, the existing adaptive observers cannot directly update maps.\n\nIn this paper, an adaptive observer is developed to update the map, in which the MAF sensor error is described as a two-dimensional (2D) map taking the operating point as the input to improve the model accuracy comparing the 1D map. Then, two problems are studied. First, in order to expediently analyze and design the parameter estimation method, the input-output relationship of the MAF sensor error 2D map is expressed as a dot product between the regression vector and the unknown parameter vector. Second, based on the linear parameter varying (LPV) system of the diesel engine with EGR and variable geometry turbocharger (VGT), a 2D map estimation method with a simple structure and low computational load is designed to facilitate the algorithm implementation.\n\nThis paper is organized as follows. In [Section 2](#sec2-sensors-15-27142){ref-type=\"sec\"}, the 2D map is expressed as the dot product between the regression vector and the unknown parameter vector, and the estimation problem for a class of LPV systems with an unknown parameter vector is given. In [Section 3](#sec3-sensors-15-27142){ref-type=\"sec\"}, the LPV adaptive observer is proposed, as well as the convergence analysis. Simulation results from enDYNA are presented in [Section 4](#sec4-sensors-15-27142){ref-type=\"sec\"}, and the conclusions are summarized in [Section 5](#sec5-sensors-15-27142){ref-type=\"sec\"}.\n\n2. Problem Formulation {#sec2-sensors-15-27142}\n======================\n\n2.1. A Diesel Engine Air Path LPV Model {#sec2dot1-sensors-15-27142}\n---------------------------------------\n\n[Figure 1](#sensors-15-27142-f001){ref-type=\"fig\"} shows the model structure of a diesel engine with EGR and VGT, and the model can be expressed as \\[[@B16-sensors-15-27142]\\]: $$\\begin{array}{ll}\n{\\overset{\u02d9}{p}}_{im} & {= \\frac{R_{a}T_{im}}{V_{im}}\\left( {W_{c} + W_{egr} - W_{ei}} \\right)} \\\\\n{\\overset{\u02d9}{p}}_{em} & {= \\frac{R_{e}T_{em}}{V_{em}}\\left( {W_{f} + W_{ei} - W_{t} - W_{egr}} \\right)} \\\\\n{\\overset{\u02d9}{\\omega}}_{t} & {= \\frac{P_{t}\\eta_{m} - P_{c}}{J_{t}\\omega_{t}}} \\\\\n\\end{array}$$ where $W_{c}$ is the compressor mass air flow, $W_{egr}$ is the EGR mass flow, $W_{ei}$ is the cylinder mass flow, $W_{f}$ is the fuel rate injected to cylinder, $W_{t}$ is the turbine mass flow, $P_{t}$ is the turbine power, $P_{c}$ is the compressor power, $\\eta_{m}$ is the turbocharger mechanical efficiency, $p_{im}$ is the intake manifold pressure, $p_{em}$ is the exhaust manifold pressure and $\\omega_{t}$ is the turbine speed.\n\n![Schematic of the diesel engine model with exhaust gas recirculation (EGR) and variable geometry turbocharger (VGT).](sensors-15-27142-g001){#sensors-15-27142-f001}\n\nMeanwhile, $W_{c}$, $W_{egr}$, $W_{ei}$, $W_{t}$, $W_{f}$, $P_{c}$ and $P_{t}\\eta_{m}$ in Equation ([1](#FD1-sensors-15-27142){ref-type=\"disp-formula\"}) can be obtained as follows: $$\\begin{array}{l}\n{W_{c} = \\frac{p_{amb}\\pi R_{c}^{3} \\cdot \\Phi_{c}\\left( {p_{im},\\omega_{t}} \\right)}{R_{a}T_{amb}}\\omega_{t},W_{egr} = \\frac{A_{egr}\\left( u_{egr} \\right) \\cdot \\Psi_{egr}\\left( {p_{im},p_{em}} \\right)}{\\sqrt{T_{em}R_{e}}}p_{em}} \\\\\n{W_{ei} = \\frac{\\eta_{vol}\\left( {p_{im},n_{e}} \\right) \\cdot n_{e}V_{d}}{120R_{a}T_{im}}p_{im},W_{t} = \\frac{A_{vgt\\max} \\cdot f_{\\Pi_{t}}\\left( p_{em} \\right) \\cdot f_{vgt}\\left( u_{vgt} \\right)}{\\sqrt{T_{em}R_{e}}}p_{em}} \\\\\n{W_{f} = \\frac{10^{- 6}}{120}n_{cyl}n_{e}u_{\\delta},P_{c} = \\frac{W_{c}\\left( {p_{im},\\omega_{t}} \\right) \\cdot c_{pa}T_{amb} \\cdot \\left( {\\Pi_{c}^{1 - {1{{/\\phantom{1\\gamma_{a}}}}\\gamma_{a}}} - 1} \\right)}{\\eta_{c}\\left( {p_{im},\\omega_{t}} \\right)}} \\\\\n{P_{t}\\eta_{m} = \\eta_{tm}\\left( {p_{em},\\omega_{t}} \\right) \\cdot W_{t}\\left( {p_{em},u_{vgt}} \\right) \\cdot c_{pe}T_{em} \\cdot \\left( {1 - \\Pi_{t}^{1 - {1{{/\\phantom{1\\gamma_{e}}}}\\gamma_{e}}}} \\right)} \\\\\n\\end{array}$$\n\nHowever, it is difficult to estimate the measurement error of the MAF sensor based on the complicated nonlinear model Equation ([1](#FD1-sensors-15-27142){ref-type=\"disp-formula\"}). In order to simply present the state space equation and the error estimation, define variables:$$\\begin{array}{l}\n{\\rho_{1} = \\frac{p_{amb}\\pi R_{c}^{3} \\cdot \\Phi_{c}\\left( {p_{im},\\omega_{t}} \\right)}{R_{a}T_{amb}},\\rho_{2} = \\frac{A_{egr}\\left( u_{egr} \\right) \\cdot \\Psi_{egr}\\left( {p_{im},p_{em}} \\right)}{\\sqrt{T_{em}R_{e}}}} \\\\\n{\\rho_{3} = \\frac{\\eta_{vol}\\left( {p_{im},n_{e}} \\right) \\cdot n_{e}V_{d}}{120R_{a}T_{im}},\\rho_{4} = \\frac{A_{vgt\\max} \\cdot f_{\\Pi_{t}}\\left( p_{em} \\right) \\cdot f_{vgt}\\left( u_{vgt} \\right)}{\\sqrt{T_{em}R_{e}}}} \\\\\n{\\rho_{5} = \\frac{c_{pa}p_{amb}\\pi R_{c}^{3} \\cdot \\Phi_{c}\\left( {p_{im},\\omega_{t}} \\right) \\cdot \\left( {\\Pi_{c}^{1 - {1{{/\\phantom{1\\gamma_{a}}}}\\gamma_{a}}} - 1} \\right)}{J_{t}\\omega_{t}R_{a} \\cdot \\eta_{c}\\left( {p_{im},\\omega_{t}} \\right)}} \\\\\n\\end{array}$$\n\nAccording to Equation ([3](#FD3-sensors-15-27142){ref-type=\"disp-formula\"}), the variables $\\rho_{i}\\mspace{600mu}\\left( i = 1,2,3,4,5 \\right)$ are available in real-time since $p_{im}$, $p_{em}$, $\\omega_{t}$, $u_{egr}$, $u_{vgt}$, $u_{\\delta}$ and $n_{e}$ can be measured or estimated online. Therefore, the nonlinear model Equation ([1](#FD1-sensors-15-27142){ref-type=\"disp-formula\"}) can be cast into an LPV system:$$\\begin{array}{r}\n{\\overset{\u02d9}{x} = A\\left( \\rho \\right)x + E} \\\\\n\\end{array}$$ where:$$\\begin{array}{l}\n{\\rho = \\begin{pmatrix}\n\\rho_{1} & \\rho_{2} & \\rho_{3} & \\rho_{4} & \\rho_{5} \\\\\n\\end{pmatrix}} \\\\\n{x = \\begin{pmatrix}\np_{im} \\\\\np_{em} \\\\\n\\omega_{t} \\\\\n\\end{pmatrix},A\\left( \\rho \\right) = \\begin{pmatrix}\n{- a_{1}\\rho_{3}} & {a_{1}\\rho_{2}} & {a_{1}\\rho_{1}} \\\\\n{a_{2}\\rho_{3}} & {- a_{2}\\rho_{2} - a_{2}\\rho_{4}} & 0 \\\\\n0 & 0 & {- \\rho_{5}} \\\\\n\\end{pmatrix}} \\\\\n{E = \\begin{pmatrix}\n0 \\\\\n{a_{2}W_{f}} \\\\\n{{P_{t}\\eta_{m}}{{/\\phantom{{P_{t}\\eta_{m}}{J_{t}\\omega_{t}}}}}{J_{t}\\omega_{t}}} \\\\\n\\end{pmatrix},a_{1} = \\frac{R_{a}T_{im}}{V_{im}},a_{2} = \\frac{R_{e}T_{em}}{V_{em}}} \\\\\n\\end{array}$$\n\nIn order to determine the bounds on the parameter vector *\u03c1*, a simulation study is performed using a 1.9 L four-cylinder common rail turbo diesel engine of enDYNA provided by Tesis \\[[@B17-sensors-15-27142],[@B18-sensors-15-27142]\\]. The bounds of the parameter vector *\u03c1* are found using the simulation data from enDYNA over the European Transient Cycle (ETC), Federal Test Procedure 75 (FTP75) and New European Drive Cycle (NEDC) \\[[@B19-sensors-15-27142],[@B20-sensors-15-27142],[@B21-sensors-15-27142]\\]. Then, the results are listed in [Table 1](#sensors-15-27142-t001){ref-type=\"table\"}. It follows that each parameter $\\rho_{i}$ from parameter vector *\u03c1* is bounded by a minimum and maximum value ${\\underline{\\rho}}_{i}$ and ${\\overline{\\rho}}_{i}$.\n\nsensors-15-27142-t001_Table 1\n\n###### \n\nBounds on the parameter vector *\u03c1* under three conditions. ETC, European Transient Cycle; FTP75, Federal Test Procedure 75; NEDC, New European Drive Cycle.\n\n  Parameter    ETC                                                         FTP75                                                        NEDC\n  ------------ ----------------------------------------------------------- ------------------------------------------------------------ ------------------------------------------------------------\n  $\\rho_{1}$   $\\left\\lbrack {19,150} \\right\\rbrack \\times 10^{- 7}$       $\\left\\lbrack {146,110} \\right\\rbrack \\times 10^{- 7}$       $\\left\\lbrack {49,130} \\right\\rbrack \\times 10^{- 7}$\n  $\\rho_{2}$   $\\left\\lbrack {- 1.65,1.6} \\right\\rbrack \\times 10^{- 7}$   $\\left\\lbrack {- 0.56,1.15} \\right\\rbrack \\times 10^{- 7}$   $\\left\\lbrack {- 0.003,1.0} \\right\\rbrack \\times 10^{- 7}$\n  $\\rho_{3}$   $\\left\\lbrack {1.09,6.4} \\right\\rbrack \\times 10^{- 7}$     $\\left\\lbrack {1.18,6} \\right\\rbrack \\times 10^{- 7}$        $\\left\\lbrack {1.1,5.4} \\right\\rbrack \\times 10^{- 7}$\n  $\\rho_{4}$   $\\left\\lbrack {0.61,6.01} \\right\\rbrack \\times 10^{- 7}$    $\\left\\lbrack {0.75,5.4} \\right\\rbrack \\times 10^{- 7}$      $\\left\\lbrack {0.62,4.7} \\right\\rbrack \\times 10^{- 7}$\n  $\\rho_{5}$   $\\left\\lbrack {0,3.15} \\right\\rbrack$                       $\\left\\lbrack {0,2.78} \\right\\rbrack$                        $\\left\\lbrack {0,2.67} \\right\\rbrack$\n\n2.2. 2D Map Description for the MAF Sensor Error {#sec2dot2-sensors-15-27142}\n------------------------------------------------\n\nThe intake manifold pressure $p_{im}$, turbine speed $\\omega_{t}$ and compressor mass air flow $W_{c}$ are the outputs of interest to analyze the MAF sensor error, which is:$$\\begin{array}{r}\n{y = \\begin{pmatrix}\ny_{1} \\\\\ny_{2} \\\\\n\\end{pmatrix} = \\begin{pmatrix}\np_{im} \\\\\n\\omega_{t} \\\\\nW_{c} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$ where $y_{1} = \\begin{pmatrix}\np_{im} & \\omega_{t} \\\\\n\\end{pmatrix}^{T},y_{2} = W_{c}$. Due to the existence of MAF sensor error, the output Equation ([6](#FD6-sensors-15-27142){ref-type=\"disp-formula\"}) becomes: $$\\begin{array}{r}\n{y_{m} = \\begin{pmatrix}\ny_{1m} \\\\\ny_{2m} \\\\\n\\end{pmatrix} = \\begin{pmatrix}\ny_{1} \\\\\n{y_{2} + \\Delta W_{c}} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$ where $y_{m}$ is the measured value from sensors. ${\\Delta W}_{c}$ is the measurement error of the MAF sensor, which depends on the engine operating point (fuel mass injection quantity $u_{\\delta}$ and engine speed $n_{e}$), *i.e.*, $\\Delta W_{c}\\left( {u_{\\delta}.n_{e}} \\right)$. Since it is difficult to accurately build an analytical model for $\\Delta W_{c}\\left( {u_{\\delta}.n_{e}} \\right)$, a 2D map is adopted in this paper to describe $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$. Therefore, define the partition of the 2D map input $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$ as: $$\\begin{matrix}\n{a = u_{\\delta}^{1} < u_{\\delta}^{2} < \\ldots < u_{\\delta}^{p_{1}} = b} \\\\\n{c = n_{e}^{1} < n_{e}^{2} < \\ldots < n_{e}^{p_{2}} = d} \\\\\n\\end{matrix}$$ where $a,b \\in \\mathbb{R}$ are the minimum and maximum values of $u_{\\delta}$ and $p_{1}$ is the number of the grid points in $\\left\\lbrack {a,b} \\right\\rbrack$. $c,d \\in \\mathbb{R}$ are the minimum and maximum values of $n_{e}$, and $p_{2}$ is the number of the grid points in $\\left\\lbrack {c,d} \\right\\rbrack$.\n\nAssume that the measurement error of the input grid points $\\left( {u_{\\delta}^{i},n_{e}^{j}} \\right)$ is $\\theta^{i,j}$, *i.e.*, $$\\begin{matrix}\n{\\theta^{i,j} = \\Delta W_{c}\\left( {u_{\\delta}^{i},n_{e}^{j}} \\right)} \\\\\n{i = 1,2,\\cdots p_{1};j = 1,2,\\cdots p_{2}} \\\\\n\\end{matrix}$$\n\nThen, for $\\forall\\upsilon \\in \\left\\lbrack {u_{\\delta}^{i},u_{\\delta}^{i + 1}} \\right\\rbrack \\times \\left\\lbrack {n_{e}^{j},n_{e}^{j + 1}} \\right\\rbrack$, $\\forall i \\in \\left\\lbrack {1,2,\\cdots,p_{1} - 1} \\right\\rbrack$ and $\\forall j \\in \\left\\lbrack {1,2,\\cdots,p_{2} - 1} \\right\\rbrack$, we can hold the $n_{e}$ value fixed and apply one dimensional (1D) linear interpolation in the $u_{\\delta}$ direction. Using the Lagrange form, the result is: $$\\begin{matrix}\n{q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right) = \\frac{u_{\\delta}^{i + 1} - u_{\\delta}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i,j} + \\frac{u_{\\delta} - u_{\\delta}^{i}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i + 1,j}} \\\\\n{u_{\\delta} \\in \\left\\lbrack {u_{\\delta}^{i},u_{\\delta}^{i + 1}} \\right\\rbrack,i = 1,2,\\cdots p_{1} - 1} \\\\\n\\end{matrix}$$\n\nEquation ([10](#FD10-sensors-15-27142){ref-type=\"disp-formula\"}) can then be used to linearly interpolate along the $n_{e}$ dimension to yield the piecewise bilinear interpolation model of the measurement error $\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right)$ as:$$\\begin{matrix}\n{\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right) = \\frac{n_{e}^{j + 1} - n_{e}}{n_{e}^{j + 1} - n_{e}^{j}}q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right) + \\frac{n_{e} - n_{e}^{j}}{n_{e}^{j + 1} - n_{e}^{j}}q_{u_{\\delta}}^{j + 1}\\left( \\theta^{i,j} \\right)} \\\\\n{\\upsilon \\in \\left\\lbrack {u_{\\delta}^{i},u_{\\delta}^{i + 1}} \\right\\rbrack \\times \\left\\lbrack {n_{e}^{j},n_{e}^{j + 1}} \\right\\rbrack,i = 1,\\cdots p_{1} - 1;j = 1,\\cdots p_{2} - 1} \\\\\n\\end{matrix}$$\n\nFor the undefined region $\\upsilon \\in \\left( {\\mathbb{R} \\times \\mathbb{R}} \\right)\\backslash\\left( {\\left\\lbrack {a,b} \\right\\rbrack \\times \\left\\lbrack {c,d} \\right\\rbrack} \\right)$, we extend Equation ([11](#FD11-sensors-15-27142){ref-type=\"disp-formula\"}) to the final result: $$\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right) = \\left\\{ \\begin{matrix}\n{q_{u_{\\delta}}^{1}\\left( \\theta^{i,j} \\right)} & {,u \\in \\mathbb{R} \\times \\mathbb{R}_{n_{e}}^{0}} \\\\\n{\\frac{n_{e}^{j{ +}1} - n_{e}}{n_{e}^{j{ +}1} - n_{e}^{j}}q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right) + \\frac{n_{e} - n_{e}^{j}}{n_{e}^{j{ +}1} - n_{e}^{j}}q_{u_{\\delta}}^{j{ +}1}\\left( \\theta^{i,j} \\right)} & {,u \\in \\mathbb{R} \\times \\mathbb{R}_{n_{e}}^{j}} \\\\\n{q_{u_{\\delta}}^{p_{2}}\\left( \\theta^{i,j} \\right)} & {,u \\in \\mathbb{R} \\times \\mathbb{R}_{n_{e}}^{p_{2}}} \\\\\n\\end{matrix} \\right.$$ where: $$\\begin{matrix}\n{q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right) = \\left\\{ \\begin{matrix}\n\\theta^{1,j} & {,u_{\\delta} \\in \\mathbb{R}_{u_{\\delta}}^{0}} \\\\\n{\\frac{u_{\\delta}^{i + 1} - u_{\\delta}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i,j} + \\frac{u_{\\delta} - u_{\\delta}^{i}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i + 1,j}} & {,u_{\\delta} \\in \\mathbb{R}_{u_{\\delta}}^{i}} \\\\\n\\theta^{p_{1},j} & {,u_{\\delta} \\in \\mathbb{R}_{u_{\\delta}}^{p_{1}}} \\\\\n\\end{matrix} \\right.} \\\\\n{i = 1,2,\\cdots p_{1} - 1;j = 1,2,\\cdots p_{2} - 1} \\\\\n\\end{matrix}$$ and: $$\\mathbb{R}_{u_{\\delta}}^{k} = \\begin{cases}\n{\\left( {- \\infty,u_{\\delta}^{1}} \\right\\rbrack,} & {k{ = 0}} \\\\\n{\\left( {u_{\\delta}^{k},u_{\\delta}^{k + 1}} \\right\\rbrack,} & {k{ =}1,\\ldots,p_{1} - 1} \\\\\n{\\left( {u_{\\delta}^{p_{1}}, + \\infty} \\right),} & {k{ =}p_{1}} \\\\\n\\end{cases}$$ $$\\mathbb{R}_{n_{e}}^{l} = \\begin{cases}\n{\\left( {- \\infty,n_{e}^{1}} \\right\\rbrack,} & {l{ = 0}} \\\\\n{\\left( {n_{e}^{l},n_{e}^{l + 1}} \\right\\rbrack,} & {l{ =}1,\\ldots,p_{2} - 1} \\\\\n{\\left( {n_{e}^{p_{2}}, + \\infty} \\right),} & {l{ =}p_{2}} \\\\\n\\end{cases}$$\n\nFor the purposes of estimating unknown parameter $\\theta^{i,j}$ in $\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right)$ expediently, Equation ([12](#FD12-sensors-15-27142){ref-type=\"disp-formula\"}) in vector-vector form is needed. According to the input interval Equations ([14](#FD14-sensors-15-27142){ref-type=\"disp-formula\"}) and ([15](#FD15-sensors-15-27142){ref-type=\"disp-formula\"}), we define membership function as: $$\\begin{matrix}\n{\\delta_{u_{\\delta}}^{k} = \\left\\{ \\begin{matrix}\n{1,} & {u_{\\delta} \\in \\mathbb{R}_{u_{\\delta}}^{k}} \\\\\n{0,} & {other} \\\\\n\\end{matrix} \\right.} \\\\\n{k = 0,1,\\cdots,p_{1}} \\\\\n\\end{matrix}$$ and: $$\\begin{matrix}\n{\\delta_{n_{e}}^{l} = \\left\\{ \\begin{matrix}\n{1,} & {n_{e} \\in \\mathbb{R}_{n_{e}}^{l}} \\\\\n{0,} & {other} \\\\\n\\end{matrix} \\right.} \\\\\n{l{ = 0,}1,\\ldots,p_{2}} \\\\\n\\end{matrix}$$\n\nUsing membership function Equations ([16](#FD16-sensors-15-27142){ref-type=\"disp-formula\"}) and ([17](#FD17-sensors-15-27142){ref-type=\"disp-formula\"}), Equation ([12](#FD12-sensors-15-27142){ref-type=\"disp-formula\"}) becomes: $$\\begin{array}{cl}\n{\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right)} & {= \\delta_{n_{e}}^{0}q_{u_{\\delta}}^{1}\\left( \\theta^{i,j} \\right) + \\sum\\limits_{j = 1}^{p_{2} - 1}{\\delta_{n_{e}}^{j}\\left( {\\frac{n_{e}^{j + 1} - n_{e}}{n_{e}^{j + 1} - n_{e}^{j}}q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right) + \\frac{n_{e} - n_{e}^{j}}{n_{e}^{j + 1} - n_{e}^{j}}q_{u_{\\delta}}^{j + 1}\\left( \\theta^{i,j} \\right)} \\right)} + \\delta_{n_{e}}^{p_{2}}q_{u_{\\delta}}^{p_{2}}\\left( \\theta^{i,j} \\right)} \\\\\n & {= \\Psi_{n_{e}} \\cdot q_{u_{\\delta}}\\left( \\theta^{i,j} \\right)} \\\\\n\\end{array}$$ where: $$\\begin{array}{r}\n{\\Psi_{n_{e}} = \\begin{pmatrix}\n{\\delta_{n_{e}}^{0} + \\delta_{n_{e}}^{1}\\frac{n_{e}^{2} - n_{e}}{n_{e}^{2} - n_{e}^{1}}} \\\\\n{\\delta_{n_{e}}^{1}\\frac{n_{e} - n_{e}^{1}}{n_{e}^{2} - n_{e}^{1}} + \\delta_{n_{e}}^{2}\\frac{n_{e}^{3} - n_{e}}{n_{e}^{3} - n_{e}^{2}}} \\\\\n \\vdots \\\\\n{\\delta_{n_{e}}^{p_{1} - 2}\\frac{n_{e} - n_{e}^{p_{2} - 2}}{n_{e}^{p_{2} - 1} - n_{e}^{p_{2} - 2}} + \\delta_{n_{e}}^{p_{1} - 1}\\frac{n_{e}^{p_{2}} - n_{e}}{n_{e}^{p_{2}} - n_{e}^{p_{2} - 1}}} \\\\\n{\\delta_{n_{e}}^{p_{1} - 1}\\frac{n_{e} - n_{e}^{p_{2} - 1}}{n_{e}^{p_{2}} - n_{e}^{p_{2} - 1}} + \\delta_{n_{e}}^{p_{1}}} \\\\\n\\end{pmatrix}^{T},q_{u_{\\delta}}\\left( \\theta^{i,j} \\right) = \\begin{pmatrix}\n{q_{u_{\\delta}}^{1}\\left( \\theta^{i,j} \\right)} \\\\\n{q_{u_{\\delta}}^{2}\\left( \\theta^{i,j} \\right)} \\\\\n \\vdots \\\\\n{q_{u_{\\delta}}^{p_{2} - 1}\\left( \\theta^{i,j} \\right)} \\\\\n{q_{u_{\\delta}}^{p_{2}}\\left( \\theta^{i,j} \\right)} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$ and: $$\\begin{array}{cl}\n{q_{u_{\\delta}}^{j}\\left( \\theta^{i,j} \\right)} & {= \\delta_{u_{\\delta}}^{0}\\theta^{1,j} + \\sum\\limits_{i = 1}^{p_{1} - 1}{\\delta_{u_{\\delta}}^{i}\\left( {\\frac{u_{\\delta}^{i + 1} - u_{\\delta}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i,j} + \\frac{u_{\\delta} - u_{\\delta}^{i}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}}\\theta^{i + 1,j}} \\right)} + \\delta_{u_{\\delta}}^{p_{1}}\\theta^{p_{1},j}} \\\\\n & {= \\Psi_{u_{\\delta}} \\cdot \\theta_{u_{\\delta}}^{j}} \\\\\n\\end{array}$$ where: $$\\begin{array}{r}\n{\\Psi_{u_{\\delta}} = \\begin{pmatrix}\n{\\delta_{u_{\\delta}}^{0} + \\delta_{u_{\\delta}}^{1}\\frac{u_{\\delta}^{2} - u_{\\delta}}{u_{\\delta}^{2} - u_{\\delta}^{1}}} \\\\\n{\\delta_{u_{\\delta}}^{1}\\frac{u_{\\delta} - u_{\\delta}^{1}}{u_{\\delta}^{2} - u_{\\delta}^{1}} + \\delta_{u_{\\delta}}^{2}\\frac{u_{\\delta}^{3} - u_{\\delta}}{u_{\\delta}^{3} - u_{\\delta}^{2}}} \\\\\n \\vdots \\\\\n{\\delta_{u_{\\delta}}^{p_{1} - 2}\\frac{u_{\\delta} - u_{\\delta}^{p_{1} - 2}}{u_{\\delta}^{p_{1} - 1} - u_{\\delta}^{p_{1} - 2}} + \\delta_{u_{\\delta}}^{p_{1} - 1}\\frac{u_{\\delta}^{p_{1}} - u_{\\delta}}{u_{\\delta}^{p_{1}} - u_{\\delta}^{p_{1} - 1}}} \\\\\n{\\delta_{u_{\\delta}}^{p_{1} - 1}\\frac{u_{\\delta} - u_{{}_{\\delta}}^{p_{1} - 1}}{u_{\\delta}^{p_{1}} - u_{\\delta}^{p_{1} - 1}} + \\delta_{u_{\\delta}}^{p_{1}}} \\\\\n\\end{pmatrix}^{T},\\theta_{u_{{}_{\\delta}}}^{j} = \\begin{pmatrix}\n\\theta^{1,j} \\\\\n\\theta^{2,j} \\\\\n \\vdots \\\\\n\\theta^{p_{1} - 1,j} \\\\\n\\theta^{p_{1},j} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$ and $\\Psi_{n_{e}} \\in \\mathbb{R}^{1 \\times p_{1}},\\Psi_{n_{e}} \\in \\mathbb{R}^{1 \\times p_{2}},\\theta_{u_{{}_{\\delta}}}^{j} \\in \\mathbb{R}^{p_{1} \\times 1},q_{u_{\\delta}}\\left( \\theta^{i,j} \\right) \\in \\mathbb{R}^{p_{2} \\times 1}$.\n\nNow, following Equations ([18](#FD18-sensors-15-27142){ref-type=\"disp-formula\"})--([21](#FD21-sensors-15-27142){ref-type=\"disp-formula\"}), $\\Delta W_{c,T}\\left( {\\theta^{i,j},\\upsilon} \\right)$ can be written as a dot product between regression vector $\\Psi\\left( \\upsilon \\right)$ and unknown parameter vector *\u03b8* as follows: $$\\begin{array}{r}\n{\\Delta W_{c,T}\\left( {\\theta,\\upsilon} \\right) = \\Psi\\left( \\upsilon \\right) \\cdot \\theta,\\forall\\upsilon \\in \\mathbb{R} \\times \\mathbb{R}} \\\\\n\\end{array}$$ where: $$\\begin{array}{r}\n{\\Psi\\left( \\upsilon \\right) = \\Psi_{n_{e}} \\cdot \\begin{pmatrix}\n\\Psi_{u_{\\delta}} & 0 & \\cdots & 0 \\\\\n0 & \\Psi_{u_{\\delta}} & \\cdots & 0 \\\\\n \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & \\Psi_{u_{\\delta}} \\\\\n\\end{pmatrix},\\theta = \\begin{pmatrix}\n\\theta_{u_{\\delta}}^{1} \\\\\n\\theta_{u_{\\delta}}^{2} \\\\\n \\vdots \\\\\n\\theta_{u_{\\delta}}^{p_{2}} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$ and $\\Psi\\left( \\upsilon \\right) \\in \\mathbb{R}^{1 \\times p},\\theta \\in \\mathbb{R}^{p \\times 1},p = p_{1} \\cdot p_{2}$.\n\nWith the combination of Equations ([4](#FD4-sensors-15-27142){ref-type=\"disp-formula\"}), ([7](#FD7-sensors-15-27142){ref-type=\"disp-formula\"}) and ([22](#FD22-sensors-15-27142){ref-type=\"disp-formula\"}), the diesel engine air path LPV model can be described by the following state space equation: $$\\begin{aligned}\n\\overset{\u02d9}{x} & {= A\\left( \\rho \\right)x + E} \\\\\ny_{m} & {= C\\left( \\rho \\right)x + G\\Psi\\left( \\upsilon \\right)\\theta} \\\\\n\\end{aligned}$$ where: $$\\begin{array}{r}\n{C\\left( \\rho \\right) = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & \\rho_{1} \\\\\n\\end{pmatrix},G = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n1 \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$\n\nEquation ([24](#FD24-sensors-15-27142){ref-type=\"disp-formula\"}) indicates that the estimation of the MAF sensor error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ becomes joint estimation of state *x* and parameter *\u03b8* for LPV system Equation ([24](#FD24-sensors-15-27142){ref-type=\"disp-formula\"}).\n\n3. Adaptive Observer Design {#sec3-sensors-15-27142}\n===========================\n\nThe observer to estimate state *x* and parameter *\u03b8* jointly for the LPV system Equation ([24](#FD24-sensors-15-27142){ref-type=\"disp-formula\"}) is given: $$\\begin{array}{ll}\n\\overset{\u02d9}{\\hat{x}} & {= A\\left( \\rho \\right)\\hat{x} + E + L\\left( {y_{m} - C\\left( \\rho \\right)\\hat{x} - G\\Psi\\left( \\upsilon \\right)\\hat{\\theta}} \\right)} \\\\\n\\overset{\u02d9}{\\hat{\\theta}} & {= \\Gamma\\Psi\\left( \\upsilon \\right)^{T}\\left( {y_{m2} - C_{2}\\left( \\rho \\right)\\hat{x} - \\Psi\\left( \\upsilon \\right)\\hat{\\theta}} \\right)} \\\\\n\\end{array}$$ where $C_{2}\\left( \\rho \\right) = \\begin{pmatrix}\n0 & 0 & \\rho_{1} \\\\\n\\end{pmatrix}$, $\\hat{x} \\in \\mathbb{R}^{3 \\times 1}$ is the state estimate, $\\hat{\\theta} \\in \\mathbb{R}^{p \\times 1}$ is the parameter estimate, gain $\\Gamma \\in \\mathbb{R}^{p \\times p}$ is the positive definite diagonal matrix and $L \\in \\mathbb{R}^{3 \\times 3}$ is the feedback gain matrix.\n\nThe asymptotical stability of the proposed algorithm Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) is analyzed in the following theorem.\n\n*If the following Conditions (1) and (2) hold, then LPV adaptive observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) is asymptotically stable, i.e., for any initial conditions* $x\\left( 0 \\right),\\hat{x}\\left( 0 \\right),\\hat{\\theta}\\left( 0 \\right)$ *and parameter vector \u03b8, the errors $\\hat{x} - x$ and $\\hat{\\theta} - \\theta$ tend to zero asymptotically when $\\left. t\\rightarrow\\infty \\right.$*.\n\n*(1) There exist matrices L, $P = P^{T} > 0$, $Q = Q^{T} > 0$ and constant $\\varepsilon_{1},\\varepsilon_{2} > 0$, such that the following set of linear matrix inequalities (LMIs) is feasible for $\\forall\\rho_{i} \\in \\left\\lbrack {{\\underline{\\rho}}_{i},{\\overline{\\rho}}_{i}} \\right\\rbrack$, $i = 1,2,3,4,5$:* $$M\\left( \\rho \\right) = \\begin{bmatrix}\n{A_{cl}\\left( \\rho \\right)^{T}P + PA_{cl}\\left( \\rho \\right) + Q} & {PLG} & {C_{2}^{T}\\left( \\rho \\right)} \\\\\n{G^{T}L^{T}P^{T}} & {- \\varepsilon_{1}I} & 0 \\\\\n{C_{2}\\left( \\rho \\right)} & 0 & {- \\varepsilon_{2}I} \\\\\n\\end{bmatrix} < 0$$ $$\\begin{array}{r}\n{2 - \\varepsilon_{1} - \\varepsilon_{2} > 0} \\\\\n\\end{array}$$ *where $A_{cl}\\left( \\rho \\right) = A\\left( \\rho \\right) - LC\\left( \\rho \\right)$* .\n\n*(2) There exists map input \u03c5, such that the regression vector $\\Psi\\left( \\upsilon \\right)$ is persistently exciting, i.e., $\\exists\\delta_{1},\\delta_{2} > 0;\\exists T > 0;\\forall t \\geq 0$:* $$\\begin{array}{r}\n{\\delta_{1}I_{p} \\leq \\int_{t}^{t + T}{\\Psi\\left( {\\upsilon\\left( \\tau \\right)} \\right)^{T}\\Psi\\left( {\\upsilon\\left( \\tau \\right)} \\right)d\\tau} \\leq \\delta_{2}I_{p}} \\\\\n\\end{array}$$\n\nSet the estimation error $\\widetilde{x} = \\hat{x} - x,\\widetilde{\\theta} = \\hat{\\theta} - \\theta$. Notice that $\\overset{\u02d9}{\\theta} = 0$; the error dynamic system between Equations ([24](#FD24-sensors-15-27142){ref-type=\"disp-formula\"}) and ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) is: $$\\begin{aligned}\n\\overset{\u02d9}{\\widetilde{x}} & {= \\left( {A\\left( \\rho \\right) - LC\\left( \\rho \\right)} \\right)\\widetilde{x} - LG\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta}} \\\\\n\\overset{\u02d9}{\\widetilde{\\theta}} & {= - \\Gamma\\Psi\\left( \\upsilon \\right)^{T}\\left( {C_{2}\\left( \\rho \\right)\\widetilde{x} + \\Psi\\left( \\upsilon \\right)\\widetilde{\\theta}} \\right)} \\\\\n\\end{aligned}$$\n\nA valid Lyapunov function candidate is considered as $V = \\eta^{T}P\\eta + {\\widetilde{\\theta}}^{T}\\Gamma^{- 1}\\widetilde{\\theta}$. For $\\forall\\widetilde{x} \\neq 0$, the derivative of *V* along with the error dynamic system Equation ([30](#FD30-sensors-15-27142){ref-type=\"disp-formula\"}) is: $$\\begin{array}{cl}\n\\overset{\u02d9}{V} & {= 2{\\widetilde{x}}^{T}P\\overset{\u02d9}{\\widetilde{x}} + 2{\\widetilde{\\theta}}^{T}\\Gamma^{- 1}\\overset{\u02d9}{\\widetilde{\\theta}}} \\\\\n & {= 2{\\widetilde{x}}^{T}PA_{cl}\\left( \\rho \\right)\\widetilde{x} - 2{\\widetilde{\\theta}}^{T}\\Psi\\left( \\upsilon \\right)^{T}\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta} - 2{\\widetilde{x}}^{T}PLG\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta} - 2{\\widetilde{\\theta}}^{T}\\Psi\\left( \\upsilon \\right)^{T}C_{2}\\left( \\rho \\right)\\widetilde{x}} \\\\\n\\end{array}$$\n\nThere exist $\\varepsilon_{1},\\varepsilon_{2} > 0$, such that the following inequalities hold: $$\\begin{matrix}\n{- 2{\\widetilde{x}}^{T}PLG\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta} \\leqslant {\\parallel {\\frac{1}{\\sqrt{\\varepsilon_{1}}}{\\widetilde{x}}^{T}PLG} \\parallel}^{2} + {\\parallel {\\sqrt{\\varepsilon_{1}}\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta}} \\parallel}^{2}} \\\\\n{- 2{\\widetilde{\\theta}}^{T}\\Psi\\left( \\upsilon \\right)^{T}C_{2}\\left( \\rho \\right)\\widetilde{x} \\leqslant {\\parallel {\\frac{1}{\\sqrt{\\varepsilon_{2}}}C_{2}\\left( \\rho \\right)\\widetilde{x}} \\parallel}^{2} + {\\parallel {\\sqrt{\\varepsilon_{2}}{\\widetilde{\\theta}}^{T}\\Psi\\left( \\upsilon \\right)^{T}} \\parallel}^{2}} \\\\\n\\end{matrix}$$\n\nAccording to Condition (1) and Equation ([31](#FD31-sensors-15-27142){ref-type=\"disp-formula\"}), the following inequality holds: $$\\begin{array}{cl}\n\\overset{\u02d9}{V} & {\\leq {\\widetilde{x}}^{T}\\left( {A_{cl}\\left( \\rho \\right)^{T}P + PA_{cl}\\left( \\rho \\right) + \\frac{1}{\\varepsilon_{1}}PLGG^{T}L^{T}P + \\frac{1}{\\varepsilon_{2}}C_{2}^{T}\\left( \\rho \\right)C_{2}\\left( \\rho \\right)} \\right)\\widetilde{x}} \\\\\n & {- \\left( {2 - \\varepsilon_{1} - \\varepsilon_{2}} \\right){\\widetilde{\\theta}}^{T}\\Psi\\left( \\upsilon \\right)^{T}\\Psi\\left( \\upsilon \\right)\\widetilde{\\theta}} \\\\\n & {< - {\\widetilde{x}}^{T}Q\\widetilde{x} < 0} \\\\\n\\end{array}$$\n\nThat is $\\overset{\u02d9}{V} < - \\omega\\left( t \\right) < 0$, for $\\forall\\rho_{i} \\in \\left\\lbrack {{\\underline{\\rho}}_{i},{\\overline{\\rho}}_{i}} \\right\\rbrack,i = 1,2,3,4,5$, where $\\omega\\left( t \\right) = {\\widetilde{x}}^{T}Q\\widetilde{x}$. Based on the Lyapunov stability theory, we know that the equilibrium $\\widetilde{x} = 0$ and $\\widetilde{\\theta} = 0$ are stable. Now, integrating $\\overset{\u02d9}{V} < - \\omega\\left( t \\right)$ from zero to *t* yields: $$\\begin{array}{r}\n{V\\left( t \\right) + \\int_{0}^{t}{\\omega\\left( \\tau \\right)d\\tau} < V\\left( 0 \\right)} \\\\\n\\end{array}$$ and this means that $\\int_{0}^{t}{\\omega\\left( \\tau \\right)d\\tau} < V\\left( 0 \\right)$ since $V > 0$. Therefore, we have $\\lim\\limits_{t\\rightarrow\\infty}\\int_{0}^{t}{\\omega\\left( \\tau \\right)d\\tau} \\leq V\\left( 0 \\right)$, and this implies that $\\lim\\limits_{t\\rightarrow\\infty}\\int_{0}^{t}{\\omega\\left( \\tau \\right)d\\tau}$ exists and is finite. By Barbalat's Lemma \\[[@B22-sensors-15-27142]\\], we know that $\\lim\\limits_{t\\rightarrow\\infty}\\omega\\left( t \\right) = 0$, and this leads to $\\lim\\limits_{t\\rightarrow\\infty}\\widetilde{x}\\left( t \\right) = 0$.\n\nUnder Condition (2), the vector $\\Psi\\left( \\upsilon \\right)$ is persistently exciting, that is we have $\\lim\\limits_{t\\rightarrow\\infty}\\widetilde{\\theta}\\left( t \\right) = 0$ \\[[@B22-sensors-15-27142]\\]. \u2610\n\n*With the concept of multi-convexity \\[[@B23-sensors-15-27142]\\], the solution of the infinite LMI Equation ([27](#FD27-sensors-15-27142){ref-type=\"disp-formula\"}) can be reduced to be a solution of the finite LMIs for the vertex set, that is:* $$\\begin{matrix}\n{{M\\left( w \\right) < 0},{\\forall w \\in \\mathcal{V} = \\left\\{ {\\left. \\left( {w_{1},\\cdots,w_{5}} \\right) \\right|w_{i} \\in \\left\\{ {{\\underline{\\rho}}_{i},{\\overline{\\rho}}_{i}} \\right\\},i = 1,2,3,4,5} \\right\\}}} \\\\\n\\end{matrix}$$\n\n*Therefore, feedback gain L can be obtained by the solution of inequality Equations ([28](#FD28-sensors-15-27142){ref-type=\"disp-formula\"}) and ([33](#FD35-sensors-15-27142){ref-type=\"disp-formula\"})*.\n\n*With the membership function $\\delta_{u_{\\delta}}^{k},\\delta_{n_{e}}^{l}$ in Equations ([16](#FD16-sensors-15-27142){ref-type=\"disp-formula\"}) and ([17](#FD17-sensors-15-27142){ref-type=\"disp-formula\"}), we know that $\\delta_{u_{\\delta}}^{k}$ = $\\delta_{n_{e}}^{l}$ = 1 when $\\upsilon \\in \\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$ and $\\delta_{u_{\\delta}}^{k}{ =}\\delta_{n_{e}}^{l}{ = 0}$ when $\\upsilon \\notin \\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$. Therefore, the regression vector $\\Psi\\left( \\upsilon \\right)$ is a sparse vector*.\n\nAccording to the partition of the map input $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$ defined in Equation ([8](#FD8-sensors-15-27142){ref-type=\"disp-formula\"}) and the piecewise bilinear interpolation model Equation ([12](#FD12-sensors-15-27142){ref-type=\"disp-formula\"}), the input *\u03c5* (engine operating point) moves in only one region $\\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$ at any time, and only the parameters ${\\hat{\\theta}}^{i,j}$ corresponding to the region $\\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$ can participate in the interpolation. That is, for $\\forall\\upsilon \\in \\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$:\n\nCase 1: $\\left( {k,l} \\right) \\in \\left\\{ {0,p_{1}} \\right\\} \\times \\left\\{ {0,p_{2}} \\right\\}$. Only one parameter ${\\hat{\\theta}}^{i,j},\\left( {i,j} \\right) \\in \\left\\{ {1,p_{1}} \\right\\} \\times \\left\\{ {1,p_{2}} \\right\\}$ takes part in the interpolation, *i.e.*, $\\Delta W_{c,T}\\left( {{\\hat{\\theta}}^{i,j},\\upsilon} \\right) = {\\hat{\\theta}}^{i,j}$.\n\nCase 2: $\\left( {k,l} \\right) \\in \\left\\{ {1,2,\\cdots p_{1} - 1} \\right\\} \\times \\left\\{ {0,p_{2}} \\right\\}$. Two parameters ${\\hat{\\theta}}^{i,j},{\\hat{\\theta}}^{i + 1,j},\\left( {i,j} \\right) \\in \\left\\{ {1,2,\\cdots p_{1} - 1} \\right\\} \\times \\left\\{ {1,p_{2}} \\right\\}$ take part in the interpolation, *i.e.*,\n\n\u0394\n\nW\n\nc\n\n,\n\nT\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n,\n\n\u03c5\n\n=\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n\\+\n\nu\n\n\u03b4\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n\\+\n\n1\n\n,\n\nj\n\nCase 3: $\\left( {k,l} \\right) \\in \\left\\{ {0,p_{1}} \\right\\} \\times \\left\\{ {1,2,\\cdots p_{2} - 1} \\right\\}$. Two parameters ${\\hat{\\theta}}^{i,j},{\\hat{\\theta}}^{i,j + 1},\\left( {i,j} \\right) \\in \\left\\{ {1,p_{1}} \\right\\} \\times \\left\\{ {1,2,\\cdots p_{2} - 1} \\right\\}$ take part in the interpolation, *i.e.*,\n\n\u0394\n\nW\n\nc\n\n,\n\nT\n\n\u03b8\n\ni\n\n,\n\nj\n\n,\n\n\u03c5\n\n=\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n\\+\n\nn\n\ne\n\n\u2212\n\nn\n\ne\n\nj\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n\\+\n\n1\n\nCase 4: $\\left( {k,l} \\right) \\in \\left\\{ {1,2,\\cdots p_{1} - 1} \\right\\} \\times \\left\\{ {1,2,\\cdots p_{2} - 1} \\right\\}$. Four parameters ${\\hat{\\theta}}^{i,j}$, ${\\hat{\\theta}}^{i + 1,j}$, ${\\hat{\\theta}}^{i,j + 1}$, ${\\hat{\\theta}}^{i + 1,j + 1}$, $\\left( {i,j} \\right) \\in \\left\\{ {1,2,\\cdots p_{1} - 1} \\right\\} \\times \\left\\{ {1,2,\\cdots p_{2} - 1} \\right\\}$ take part in the interpolation, *i.e.*,\n\n\u0394\n\nW\n\nc\n\n,\n\nT\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n,\n\n\u03c5\n\n=\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n\\+\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\nu\n\n\u03b4\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n\\+\n\n1\n\n,\n\nj\n\n\\+\n\nn\n\ne\n\n\u2212\n\nn\n\ne\n\nj\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n,\n\nj\n\n\\+\n\n1\n\n\\+\n\nn\n\ne\n\n\u2212\n\nn\n\ne\n\nj\n\nn\n\ne\n\nj\n\n\\+\n\n1\n\n\u2212\n\nn\n\ne\n\nj\n\nu\n\n\u03b4\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\nu\n\n\u03b4\n\ni\n\n\\+\n\n1\n\n\u2212\n\nu\n\n\u03b4\n\ni\n\n\u03b8\n\n\\^\n\ni\n\n\\+\n\n1\n\n,\n\nj\n\n\\+\n\n1\n\nIn order to expediently discuss the convergence of the parameter estimate ${\\hat{\\theta}}^{i,j}$ corresponding to different regions $\\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$, a local regression vector $\\Psi_{l}\\left( \\upsilon \\right)$ is defined based on the above four classifications of the region partition as follow: $$\\Psi_{l}\\left( \\upsilon \\right) = \\begin{cases}\n1 & {{if}~{\\upsilon \\in \\left( {\\mathbb{R}_{u_{\\delta}}^{0} \\cup \\mathbb{R}_{u_{\\delta}}^{p_{1}}} \\right) \\times \\left( {\\mathbb{R}_{n_{e}}^{0} \\cup \\mathbb{R}_{n_{e}}^{p_{2}}} \\right)}} \\\\\n\\begin{pmatrix}\n{1 - \\eta_{1}} & \\eta_{1} \\\\\n\\end{pmatrix} & {{if}~{\\upsilon \\in \\mathbb{R}_{u_{\\delta}}^{i} \\times \\left( {\\mathbb{R}_{n_{e}}^{0} \\cup \\mathbb{R}_{n_{e}}^{p_{2}}} \\right)}} \\\\\n\\begin{pmatrix}\n{1 - \\eta_{2}} & \\eta_{2} \\\\\n\\end{pmatrix} & {{if}~{\\upsilon \\in \\left( {\\mathbb{R}_{u_{\\delta}}^{0} \\cup \\mathbb{R}_{u_{\\delta}}^{p_{1}}} \\right) \\times \\mathbb{R}_{n_{e}}^{j}}} \\\\\n\\begin{pmatrix}\n{\\left( {1 - \\eta_{1}} \\right)\\left( {1 - \\eta_{2}} \\right)} \\\\\n{\\eta_{1}\\left( {1 - \\eta_{2}} \\right)} \\\\\n{\\left( {1 - \\eta_{1}} \\right)\\eta_{2}} \\\\\n{\\eta_{1}\\eta_{2}} \\\\\n\\end{pmatrix}^{T} & {{if}~{\\upsilon \\in \\mathbb{R}_{u_{\\delta}}^{i} \\times \\mathbb{R}_{n_{e}}^{j}}} \\\\\n\\end{cases}$$ where: $$\\begin{matrix}\n{\\eta_{1} = \\frac{u_{\\delta} - u_{\\delta}^{i}}{u_{\\delta}^{i + 1} - u_{\\delta}^{i}},\\eta_{2} = \\frac{n_{e} - n_{e}^{j}}{n_{e}^{j + 1} - n_{e}^{j}}} \\\\\n{i = 1,2,\\cdots p_{1} - 1;j = 1,2,\\cdots p_{2} - 1} \\\\\n\\end{matrix}$$\n\nWhen $\\upsilon \\in \\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$, regression vector $\\Psi\\left( \\upsilon \\right)$ in Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) can be replaced by local regression vector $\\Psi_{l}\\left( \\upsilon \\right)$; then, observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) can be replaced by: $$\\begin{aligned}\n\\overset{\u02d9}{\\hat{x}} & {= A\\left( \\rho \\right)\\hat{x} + E + L\\left( {y_{m} - C\\left( \\rho \\right)\\hat{x} - G\\Psi_{l}\\left( \\upsilon \\right){\\hat{\\theta}}_{l}^{i,j}} \\right)} \\\\\n{\\overset{\u02d9}{\\hat{\\theta}}}_{l}^{i,j} & {= \\Gamma_{l}\\Psi_{l}\\left( \\upsilon \\right)^{T}\\left( {y_{m2} - C_{2}\\left( \\rho \\right)\\hat{x} - \\Psi_{l}\\left( \\upsilon \\right){\\hat{\\theta}}_{l}^{i,j}} \\right)} \\\\\n\\end{aligned}$$ where ${\\hat{\\theta}}_{l}^{i,j}$ is the local parameter estimate of appropriate size and $\\Gamma_{l}$ is a local positive definite diagonal matrix of appropriate size.\n\nAccording to Theorem 1, the local parameter estimate ${\\hat{\\theta}}_{l}^{i,j}$ is convergent if local regression vector $\\Psi_{l}\\left( \\upsilon \\right)$ is persistently exciting. Meanwhile, the parameter estimate $\\hat{\\theta}$ is also convergent if the trajectory of the map input *\u03c5* passes through all of the interpolation regions $\\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{u_{2}}^{l}$.\n\nThere are heavy matrices calculated in real time for the covariance matrix equation of EKF in \\[[@B9-sensors-15-27142],[@B10-sensors-15-27142],[@B11-sensors-15-27142]\\], preventing it from being implemented in commercial electronic control units (ECUs) for map adaptation. Nevertheless, the computational burden of the proposed observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) without the additional matrix equation is lower. Moreover, the number of parameter estimates $\\hat{\\theta}$ updated in Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) is no more than four at any time; then, the computational load can be further reduced by stopping estimating ${\\hat{\\theta}}^{i,j}$ corresponding to $\\upsilon \\notin \\mathbb{R}_{u_{\\delta}}^{k} \\times \\mathbb{R}_{n_{e}}^{l}$.\n\n*For the area S where the trajectory of the map input \u03c5 does not move, the parameters ${\\hat{\\theta}}^{i,j}$ corresponding to the interpolation region belonging to S cannot be estimated by observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}). In order to get the map parameters corresponding to S, an extrapolation model can be taken as follows:* $$\\begin{array}{r}\n{\\Delta W_{c,e}\\left( {u_{\\delta},n_{e}} \\right) = a_{2}u_{\\delta}^{2}{ +}a_{1}u_{\\delta} + b_{2}n_{e}^{2} + b_{1}n_{e} + c_{2}u_{\\delta}n_{e} + c_{1}} \\\\\n\\end{array}$$ *where $a_{2},a_{1},b_{2},b_{1},c_{2},c_{1}$ are polynomial parameters. Based on the data from the estimated map parameters, extrapolation model Equation ([37](#FD39-sensors-15-27142){ref-type=\"disp-formula\"}) can be fitted by polynomial fitting approach, and then map parameters corresponding to S can be obtained*.\n\n4. Simulation Results {#sec4-sensors-15-27142}\n=====================\n\nIn this section, the simulation study of 2D map estimation is presented in the environment of a 1.9 L four-cylinder common rail turbo diesel engine of enDYNA, in which the ETC and FTP75 are used as test conditions, respectively. The observer architecture is illustrated in [Figure 2](#sensors-15-27142-f002){ref-type=\"fig\"}, where $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ is the additive reference error as the true measurement error from enDYNA.\n\n![Schematic diagram of the adaptive observer.](sensors-15-27142-g002){#sensors-15-27142-f002}\n\nBounds on the parameter vector *\u03c1* are presented in [Table 1](#sensors-15-27142-t001){ref-type=\"table\"}. When the inequality Equations ([28](#FD28-sensors-15-27142){ref-type=\"disp-formula\"}) and ([33](#FD35-sensors-15-27142){ref-type=\"disp-formula\"}) are solved with $\\varepsilon_{1} = 0.25$ and $\\varepsilon_{2} = 0.11$, the gain matrix *L* can be given by: $$\\begin{array}{r}\n{L = \\begin{pmatrix}\n\\text{1635.83} & {- \\text{124.95}} & {\\text{6.52} \\times \\text{10}^{- 7}} \\\\\n{- \\text{16,063.4}} & \\text{3135.43} & {\\text{1.67} \\times \\text{10}^{- 7}} \\\\\n\\text{4.2} & \\text{29.7} & {\\text{4.55} \\times \\text{10}^{- 20}} \\\\\n\\end{pmatrix}} \\\\\n\\end{array}$$\n\nThe initial values of observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) used in the simulation are $\\hat{x}\\left( 0 \\right) = \\begin{bmatrix}\n{9.8 \\times 10^{5}} & {9.8 \\times 10^{5}} & 0 \\\\\n\\end{bmatrix}^{T},\\hat{\\theta}\\left( 0 \\right) = 0$, and the parameter gain is $\\Gamma = 200I$. Here, the reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ assumed as MAF sensor measurement error is depicted in [Figure 3](#sensors-15-27142-f003){ref-type=\"fig\"}, which is superimposed on the signal $W_{c}$ in enDYNA as the measured value $y_{m2}$ in the simulation.\n\n![Reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ used as the mass air flow (MAF) sensor error in enDYNA.](sensors-15-27142-g003){#sensors-15-27142-f003}\n\n4.1. 2D Map Estimation under ETC {#sec4dot1-sensors-15-27142}\n--------------------------------\n\nThere are three parts of the ETC representing three different driving conditions, including urban, rural and motorway driving. Due to the engine speed range from ETC Part 1 covering the other two parts, ETC Part 1 is employed as the test condition in this section. Accordingly, the fuel mass injection quantity $u_{\\delta}$ and engine speed $n_{e}$ from ETC Part 1 are plotted in [Figure 4](#sensors-15-27142-f004){ref-type=\"fig\"}a, and the trajectory of the operating point $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$ is depicted in [Figure 4](#sensors-15-27142-f004){ref-type=\"fig\"}b, in which the trajectory does not move in area $S = \\left\\lbrack {\\left( {0,56} \\right) \\times \\left( {0,800} \\right)} \\right\\rbrack \\cup \\left\\lbrack {\\left( {40,56} \\right) \\times \\left( {0,2000} \\right)} \\right\\rbrack$. According to the range $u_{\\delta} \\in \\left\\lbrack {0,56} \\right\\rbrack$ and $n_{e} \\in \\left\\lbrack {0,3100} \\right\\rbrack$ from [Figure 4](#sensors-15-27142-f004){ref-type=\"fig\"}a, an average partition can be respectively given as \\[0:4:56\\] and \\[0:250:3000\\].\n\n![Evolution of operating point $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$ during ETC part one. (**a**) Evolution of $u_{\\delta}$ and $n_{e}$. (**b**) Trajectory of operating point $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$.](sensors-15-27142-g004){#sensors-15-27142-f004}\n\nThe estimation results of the MAF sensor error using observer Equation ([26](#FD26-sensors-15-27142){ref-type=\"disp-formula\"}) under ETC Part 1 are shown in [Figure 5](#sensors-15-27142-f005){ref-type=\"fig\"}a, in which the map parameters have been estimated, except area *S*. According to Remark 3, the map parameters corresponding to area *S* can be obtained from the extrapolation model Equation ([37](#FD39-sensors-15-27142){ref-type=\"disp-formula\"}). Based on the estimated map parameters from [Figure 5](#sensors-15-27142-f005){ref-type=\"fig\"}a, the polynomial parameters in Equation ([37](#FD39-sensors-15-27142){ref-type=\"disp-formula\"}) can be fitted as follows: $$\\begin{array}{l}\n{a_{2} = 9.12 \\times 1\\text{0}^{- 6},a_{1} = - 4.39 \\times 1\\text{0}^{- 4},b_{2} = 1.30 \\times 1\\text{0}^{- 9}} \\\\\n{b_{1} = - 5.74 \\times 1\\text{0}^{- 6},c_{2} = - 5.37 \\times 1\\text{0}^{- 8},c_{1} = 0.0012887} \\\\\n\\end{array}$$\n\nThe parameters corresponding to area *S* obtained from Equation ([37](#FD39-sensors-15-27142){ref-type=\"disp-formula\"}) are presented in [Figure 5](#sensors-15-27142-f005){ref-type=\"fig\"}b, which can roughly reflect the trend of the map.\n\nIn order to evaluate the accuracy of the estimated 2D map shown in [Figure 5](#sensors-15-27142-f005){ref-type=\"fig\"}a, the comparison between the reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and the estimated 2D map during the ETC segment is presented in [Figure 6](#sensors-15-27142-f006){ref-type=\"fig\"}a. Accordingly, the true mass air flow $y_{2}$, measured mass air flow $y_{m2}$ and map compensation are shown in [Figure 6](#sensors-15-27142-f006){ref-type=\"fig\"}b. The mean relative error between reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and estimated 2D map is $10.41\\%$, which demonstrates that the measured output $y_{m2}$ of the MAF sensor after map correction can approximate the true value of $W_{c}$ acceptably.\n\n![The estimated 2D map for the MAF sensor error. (**a**) Estimation results of the 2D map under ETC Part 1; (**b**) Extrapolation results based on the estimated 2D map.](sensors-15-27142-g005){#sensors-15-27142-f005}\n\n![2D map compensation during the ETC segment. (**a**) Simulation results between reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and the estimated 2D map; (**b**) Simulation results of true mass air flow $y_{2}$, measured mass air flow $y_{m2}$ and the map compensation.](sensors-15-27142-g006){#sensors-15-27142-f006}\n\n4.2. 2D Map Estimation under FTP75 {#sec4dot2-sensors-15-27142}\n----------------------------------\n\nIn order to verify the effectiveness of the proposed method under different conditions, the cold start transient phase of the FTP75 is used in this section. Accordingly, $u_{\\delta}$ and $n_{e}$ are plotted in [Figure 7](#sensors-15-27142-f007){ref-type=\"fig\"}a, and the trajectory of *\u03c5* is depicted in [Figure 7](#sensors-15-27142-f007){ref-type=\"fig\"}b, in which the trajectory does not move in area $S = \\left\\lbrack {\\left( {0,56} \\right) \\times \\left( {0,650} \\right)} \\right\\rbrack \\cup \\left\\lbrack {\\left( {25,37} \\right) \\times \\left( {0,2000} \\right)} \\right\\rbrack \\cup \\left\\lbrack {\\left( {37,56} \\right) \\times \\left( {0,3500} \\right)} \\right\\rbrack$.\n\n![Evolution of operating point $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$ FTP75 cold start transient phase. (**a**) Evolution of $u_{\\delta}$ and $n_{e}$; (**b**) Trajectory of operating point $\\upsilon = \\left( {u_{\\delta},n_{e}} \\right)$.](sensors-15-27142-g007){#sensors-15-27142-f007}\n\n![The estimated 2D map for the MAF sensor error. (**a**) Estimation results of the 2D map under FTP75 cold start transient phase; (**b**) Extrapolation results based on the estimated 2D map.](sensors-15-27142-g008){#sensors-15-27142-f008}\n\nThe estimation results of the MAF sensor error under the cold start transient phase of the FTP75 are shown in [Figure 8](#sensors-15-27142-f008){ref-type=\"fig\"}a, and the polynomial parameters in Equation ([37](#FD39-sensors-15-27142){ref-type=\"disp-formula\"}) are fitted as follows: $$\\begin{array}{l}\n{a_{2} = 2.10 \\times 1\\text{0}^{- 5},a_{1} = - 8.62 \\times 1\\text{0}^{- 4},b_{2} = 1.46 \\times 1\\text{0}^{- 9}} \\\\\n{b_{1} = - 6.40 \\times 1\\text{0}^{- 6},c_{2} = - 1.84 \\times 1\\text{0}^{- 8},c_{1} = 0.0032316} \\\\\n\\end{array}$$\n\nThe map added the parameters corresponding to area *S* are shown in [Figure 8](#sensors-15-27142-f008){ref-type=\"fig\"}b, which can also roughly reflect the trend of the map. Under the FTP75 segment, the comparison between the reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and the estimated 2D map from [Figure 8](#sensors-15-27142-f008){ref-type=\"fig\"}a is shown in [Figure 9](#sensors-15-27142-f009){ref-type=\"fig\"}a. Accordingly, the MAF sensor measured value $y_{m2}$ using map compensation is presented in [Figure 9](#sensors-15-27142-f009){ref-type=\"fig\"}b. The mean relative error between reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and the estimated 2D map is $5.28\\%$, demonstrating that the measured output $y_{m2}$ after map correction can approximate the true value of $W_{c}$ acceptably.\n\n![2D map compensation during the FTP75 segment. (**a**) Simulation results between reference error $\\Delta W_{c}\\left( {u_{\\delta},n_{e}} \\right)$ and the estimated 2D map; (**b**) Simulation results of true mass air flow $y_{2}$, measured mass air flow $y_{m2}$ and the map compensation.](sensors-15-27142-g009){#sensors-15-27142-f009}\n\n5. Conclusions {#sec5-sensors-15-27142}\n==============\n\nA method for updating and storing sensor bias from different operating points is developed and investigated. This method achieves simultaneous estimation of model states and map parameters and applies to updating the MAF sensor error 2D map in the engine. The map in the form of a vector-vector dot product is given to conveniently analyze and design the parameter estimation method. An LPV adaptive observer to estimate map parameters is designed, which has the advantage of a simple structure and low computational load. Under ETC Part 1 and the cold start transient phase of the FTP75, the effectiveness of the presented algorithm is verified and validated in the engine software enDYNA. The results demonstrate that the proposed method can estimate the MAF sensor error acceptably.\n\nThe authors would like to acknowledge the support of the National Nature Science Foundations of China (No. 61034001).\n\nChanghui Wang contributed to the theoretical analysis, algorithm design, simulation verification, and the writing. Zhiyuan Liu supervised the research, and participated in writing the paper.\n\nThe authors declare no conflict of interest.\n\np\n\na\n\nm\n\nb\n\nambient pressure (Pa)\n\np\n\ni\n\nm\n\nintake manifold pressure (Pa)\n\np\n\ne\n\nm\n\nexhaust manifold pressure (Pa)\n\n\u03c9\n\nt\n\nturbine speed (rad/s)\n\nn\n\ne\n\nengine speed (rpm)\n\nW\n\nc\n\ncompressor mass air flow (kg/s)\n\nW\n\ne\n\ng\n\nr\n\nEGR mass flow (kg/s)\n\nW\n\ne\n\ni\n\ncylinder mass flow (kg/s)\n\nW\n\nf\n\nfuel rate injected to cylinder (kg/s)\n\nW\n\nt\n\nturbine mass flow (kg/s)\n\nP\n\nc\n\ncompressor power (W)\n\nP\n\nt\n\nturbine power (W)\n\n\u03a6\n\nc\n\nvolumetric flow coefficient\n\n\u03a8\n\ne\n\ng\n\nr\n\nenergy transfer coefficient\n\n\u03b7\n\nv\n\no\n\nl\n\nvolumetric efficiency\n\n\u03b7\n\nt\n\nm\n\nturbine efficiency\n\n\u03b7\n\nm\n\nturbocharger mechanical efficiency\n\n\u03b7\n\nc\n\ncompressor efficiency\n\nT\n\na\n\nm\n\nb\n\nambient temperature (K)\n\nT\n\ni\n\nm\n\nintake manifold temperature (K)\n\nT\n\ne\n\nm\n\nexhaust manifold temperature (K)\n\nV\n\ni\n\nm\n\nintake manifold volume (m\n\n3\n\n)\n\nV\n\ne\n\nm\n\nexhaust manifold volume (m\n\n3\n\n)\n\nV\n\nd\n\ndisplaced volume (m\n\n3\n\n)\n\nR\n\na\n\nair gas constant (J/(kg\u00b7K))\n\nR\n\ne\n\nexhaust gas constant (J/(kg\u00b7K))\n\nR\n\nc\n\ncompressor blade radius (m)\n\n\u03b3\n\na\n\nair specific heat capacity ratio\n\n\u03b3\n\ne\n\nexhaust specific heat capacity ratio\n\n\u03a0\n\nc\n\ncompressor pressure quotient\n\n\u03a0\n\nt\n\nturbine pressure quotient\n\nJ\n\nt\n\nturbine inertia (kg\u00b7m\n\n2\n\n)\n\nn\n\nc\n\ny\n\nl\n\nnumber of cylinders\n\nA\n\ne\n\ng\n\nr\n\nEGR valve effective area (m\n\n2\n\n)\n\nA\n\nv\n\ng\n\nt\n\nm\n\na\n\nx\n\nVGT nozzle maximum effective area (m\n\n2\n\n)\n\nf\n\n\u03a0\n\nt\n\nchoking function\n\nf\n\nv\n\ng\n\nt\n\neffective area ratio function\n\nu\n\ne\n\ng\n\nr\n\nEGR valve opening percentage (%)\n\nu\n\nv\n\ng\n\nt\n\nVGT vane opening percentage (%)\n\nu\n\n\u03b4\n\ninjected amount of fuel (mg/cycle)\n\nc\n\np\n\na\n\nair specific heat capacity at constant pressure (J/(kg\u00b7K))\n\nc\n\np\n\ne\n\nexhaust specific heat capacity at constant pressure (J/(kg\u00b7K))\n"
}