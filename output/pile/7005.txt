{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "Domain",
            "passed": false,
            "reason": "Document source unavailable."
        },
        {
            "criterion": "QuestionAnswerStrings",
            "passed": true,
            "reason": "Text contains Q:."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:', 'A:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefix",
            "passed": false,
            "reason": "Found 0 list prefixes. (Min: 5)"
        },
        {
            "criterion": "ListPrefixV2",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "7005",
    "text": "Q:\n\nEXCEL VBA: Web Page Button Click\n\nI have tried numerous variations of codes on this site to get my VBA to click on a button on a webpage and with the exception of one time have not been able to get any code to work.  The one time was either a fluke or in an attempt to add the next step of the code I somehow inadvertently changed what was happening previously. Below is both the source code of the website and the code I'm using currently.  Right now I do not get any errors, but instead of loading the next page when I include the button click code if just clears the form and stays on the present web page.\nCODE:\nPublic Sub TestIE()\nDim IE As Object\nDim aNodeList As Object, i As Long\nDim bNodeList As Object, p As Long\n\n' Create InternetExplorer Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n' You can uncoment Next line To see form results\nIE.Visible = False\n\n' Send the form data To URL As POST binary request\nIE.Navigate \"https://pe.fanniemae.com/pe/pricing/search\"\n\n' Statusbar\nApplication.StatusBar = \"Page is loading. Please wait...\"\n\n' Wait while IE loading...\nDo While IE.Busy\nApplication.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nIE.Visible = True\n\nSet aNodeList = IE.document.querySelectorAll(\"input[type=checkbox]\")\nIf aNodeList Is Nothing Then Exit Sub\nFor i = 0 To 18\naNodeList.Item(i).Checked = True\nNext i\n\n'IE.document.querySelector(\"button[type=submit]\").Click\n\nSet bNodeList = IE.document.querySelectorAll(\"button[type=submit]\")\nIf bNodeList Is Nothing Then Exit Sub\nFor p = 1 To 1\nbNodeList.Item(p).Click\nNext p\n\nEnd Sub\n\nPage Source:\n<div class=\"row submit\">\n        <button id=\"get-price\" tabindex=\"3\" type=\"submit\" class=\"cell-right- \n         2\">Get Prices</button>\n        <div class=\"pricing-error-message\"></div>\n\nWhen I inspect element on the button it does appear there is a clear form part of the code, which I would expect, but for whatever reason it is clearing the form instead of loading the new page.  When I click on the button manually in IE it loads as expected.\nScript that I believe is running:\n  <script type=\"text/javascript\">\n    define('pageConf', function() {\n\n        return null || JSON.parse('{\\\"lastPricingFactors\\\": \n\n {\\\"priceIncrement\\\":\\\"18\\\",\\\"priceView\\\":\\\"total\\\",\\\"executionType\\\n \":\\\"Mandatory\\\",\\\"levelType\\\":\\\"Product\\\",\\\"remittanceType\\\":\\\"ActualActual\n \\\",\\\"products\\\":\\\"160958\\\",\\\"1036FR\\\",\\\"102422\\\",\\\"163053\\\",\\\"160639\\\",\\\"\n160058\\\",\\\"155509\\\",\\\"154232\\\",\\\"143846\\\",\\\"0005FR\\\",\\\"125331\\\",\\\"102301\\\",\n\\\"114921\\\",\\\"115446\\\",\\\"144854\\\"],\\\"underwrittenWithDu\\\":false,\\\"\nservicingReleased\\\":false,\\\"displayMarketFrozenMessage\\\":false,\\\"windows\\\":\n[10,30,60,90],\\\"requestTimeMs\\\":1531424470700}}')\n    });\n\n    </script>\n\nA:\n\nI was able to utilize a Select Case that inserted the criteria I wanted selected in the URL that was generated by the button vs. having to actually press the button which seems to be a working work around.  Thanks for taking a look at this.\n\n"
}