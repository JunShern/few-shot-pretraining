{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:', 'A:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "7250",
    "text": "Q:\n\nHow to get a picture drawn in canvas using drawImage ()?\n\nI'm trying to write a function that lets a user download an image drawn in a canvas.\nHere's the code:\ncanvas.html:\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <script type=\"text/javascript\" src=\"canvas.js\"> </script>\n  </head>\n  <body onload=\"=\"draw()\">\n    <button type=\"button\" onClick=\"saveImage()\"> save image</button>\n    <canvas width=\"1600\" height=\"1440\" id=\"canvas\"></canvas>\n  </body>\n</html>\n\ncanvas.js\nfunction draw() {\n  var canvas = document.getElementById('canvas');\n  var ctx = canvas.getContext('2d');\n  ctx.fillRect(550, 150, 300, 300);\n  ctx.fill();\n  ctx.moveTo(722, 380);\n  ctx.arc(380,380,350,0,2*Math.PI);\n  ctx.lineWidth=15;\n  ctx.strokeStyle=\"blue\";\n  ctx.stroke();\n}\n\nfunction download_image() {\n  var _image = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n  window.location.href = _image;\n  alert(\"start\")\n}\n\nThe code works - provided the image is drawn \"normally\" / as above - and not loaded with the drawImage() function.\nAs soon as I change the canvas.js file to:\nfunction draw() {\n  var canvas = document.getElementById('canvas');\n  var ctx = canvas.getContext('2d');\n  var img2= new Image();\n  img2.onload=function() {\n    ctx.drawImage(img2, 0, 50);\n  }\n  img2.src=\"./smile.png\";\n}\n\nfunction saveImage() {\n  var _image = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n  // tu sobie pobieramy adres URL i konwertuje na 'octet-stream'\n  window.location.href = _image;\n  alert(\"start\");\n}\n\nUnfortunately, nothing happens. No alert pops up. The console shows the following error: \"Uncaught TypeError: Can not read property 'toDataURL' of undefined\n\u00a0\u00a0\u00a0\u00a0 at saveImage (canvas.js: 17)\n\u00a0\u00a0\u00a0\u00a0 at HTMLButtonElement.onclick \"\nHow to fix it? Can I download a picture drawn with drawImage()? How?\n\nA:\n\n/**\r\n *    Ken Fyrstenberg Nilsen\r\n *    Abidas Software\r\n*/\r\nvar canvas = document.getElementById('canvas'),\r\n    ctx = canvas.getContext('2d');\r\n\r\n/**\r\n * Demonstrates how to download a canvas an image with a single\r\n * direct click on a link.\r\n */\r\nfunction doCanvas() {\r\n    /* draw something */\r\n    ctx.fillStyle = '#f90';\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n    ctx.fillStyle = '#fff';\r\n    ctx.font = '60px sans-serif';\r\n    ctx.fillText('Code Project', 10, canvas.height / 2 - 15);\r\n    ctx.font = '26px sans-serif';\r\n    ctx.fillText('Click link below to save this as image', 15, canvas.height / 2 + 35);\r\n}\r\n\r\n/**\r\n * This is the function that will take care of image extracting and\r\n * setting proper filename for the download.\r\n * IMPORTANT: Call it from within a onclick event.\r\n*/\r\nfunction downloadCanvas(link, canvasId, filename) {\r\n    link.href = document.getElementById(canvasId).toDataURL();\r\n    link.download = filename;\r\n}\r\n\r\n/** \r\n * The event handler for the link's onclick event. We give THIS as a\r\n * parameter (=the link element), ID of the canvas and a filename.\r\n*/\r\ndocument.getElementById('download').addEventListener('click', function() {\r\n    downloadCanvas(this, 'canvas', 'test.png');\r\n}, false);\r\n\r\n/**\r\n * Draw something to canvas\r\n */\r\ndoCanvas();\n body {\r\n     background-color:#555557;\r\n     padding:0;\r\n     margin:0;\r\n     overflow:hidden;\r\n     font-family:sans-serif;\r\n     -webkit-user-select: none;\r\n     -khtml-user-select: none;\r\n     -moz-user-select: none;\r\n     -ms-user-select: none;\r\n     user-select: none;\r\n }\r\n canvas {\r\n     border:1px solid #000;\r\n     float:left;\r\n     clear:both;\r\n }\r\n #download {\r\n     float:left;\r\n     cursor:pointer;\r\n     color:#ccc;\r\n     padding:3px;\r\n }\r\n #download:hover {\r\n     color:#fff;\r\n }\r\n /*\r\n div, input {\r\n     font-size:16px;\r\n     font-family:sans-serif;\r\n     border:1px solid #000;\r\n     border-radius: 5px;\r\n     float:left;\r\n     padding:5px;\r\n     width:50px;\r\n     margin:1px 1px;\r\n     background-color:#bbb;\r\n }\r\n input[type='text'] {\r\n     font-size:16px;\r\n     font-weight:bold;\r\n     width:70px;\r\n     text-align:center;\r\n     background-color:#fff;\r\n     padding-bottom:4px;\r\n }\r\n input[type='button'] {\r\n     font-size:16px;\r\n     font-weight:bold;\r\n     width:110px;\r\n     text-align:center;\r\n     background-color:#333;\r\n     color:#eee;\r\n     padding-bottom:4px;\r\n }\r\n input[type='button']:hover {\r\n     background-color:#fff463;\r\n     color:#000;\r\n }\r\n input[type='range'] {\r\n     width:100px;\r\n     margin:0 0 0 10px;\r\n }\r\n*/\r\n \n<canvas width=\"500\" height=\"300\" id=\"canvas\">Sorry, no canvas available</canvas>\r\n<a id=\"download\">Download as image</a>\n\nfound a solution here:\nhttp://jsfiddle.net/wboykinm/fL0q2uce/\nfunction downloadCanvas(link, canvasId, filename) {\n    link.href = document.getElementById(canvasId).toDataURL();\n    link.download = filename;\n}\n\n"
}