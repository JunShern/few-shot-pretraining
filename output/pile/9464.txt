{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:', 'A:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "9464",
    "text": "Q:\n\nImpossible to fire CSV file download from Ajax query\n\nI want to fire a download window from an Ajax query.\nThe Ajax query is launched when I click on a button on my page.\nHere is the Ajax query (function called on click on the button):\nfunction exportDetailOuvrage(idData){\n\n    $.ajax({\n        url : 'ouvrage.php',\n        type : 'POST',\n        data : { typeOuvrage : idData },\n        success : function (data){\n            $('body').append(data);\n        }\n    });\n}\n\nHere is the PHP code to generate the CSV:\n<?php\n\n$csv = \"Town;Name;Code\\r\\n\" ;\n\nforeach($result as $row){\n\n    $csv .= $row['town'].\";\".$row['name'].\";\".$row['code'].\"\\r\\n\" ;\n\n}\n\nheader(\"Content-Type: text/csv; charset=utf-8\");\nheader(\"Content-Disposition: attachment; filename=data.csv\");\n\necho $csv;\n\n?>\n\nIn the PHP code, $result is an array built on a SQL query in a database.\nThe CSV string is generated as wanted, the server answer is 200 (no errors using firebug). I have checked the sent parameters and the CSV string returned: everyting is OK.\nThe only issue is that no download window appears and no data.csv file is saved...\nI was wondering if my Ajax code, especially the content of success parameter is good. I don't know what to put exactly inside this parameter.\n\nEDIT :\nAccording to @MonkeyZeus answer and comments, here is the content of my gimme_file.php:\n<?php\n\n    session_start();\n\n    header(\"Content-Type: text/csv; charset=utf-8\");\n    header(\"Content-Disposition: attachment; filename=data.csv\");\n    readfile($_SESSION['I_CAN_DOWNLOAD_ONLY_THIS']);\n\n    exit;\n\n?>\n\nI get the following error message inside the data.csv downloaded file:\n<br />\n<b>Notice</b>:  Undefined index: I_CAN_DOWNLOAD_ONLY_THIS in <b>D:\\STAT\\modele\\gimme_file.php</b> on line <b>7</b><br />\n<br />\n<b>Warning</b>:  readfile(): Filename cannot be empty in <b>D:\\STAT\\modele\\gimme_file.php</b> on line <b>7</b><br />\n\nA:\n\nJavascript (jQuery) can absolutely NOT trigger a file download natively; it would be a gigantic security issue.\nWhat you must do is the following:\n\nCall the CSV generator\nSave the CSV to the server with a unique name\nPass this unique name to your success: callback\nUse window.location to redirect the browser to the CSV file\n\nMy apologies if my post is very terse but I just do not want you to chase your tail for hours trying to achieve something that is fundamentally blocked by web browsers.\n\njQuery\nfunction exportDetailOuvrage(idData){\n\n    $.ajax({\n        url : 'ouvrage.php',\n        type : 'POST',\n        data : { typeOuvrage : idData },\n        success : function (data){\n            window.location = 'http://www.mywebsite.com/gimme_file.php';\n        }\n    });\n}\n\nouvrage.php\n<?php\n\nsession_start();\n\n$csv = \"Town;Name;Code\\r\\n\" ;\n\nforeach($result as $row){\n\n    $csv .= $row['town'].\";\".$row['name'].\";\".$row['code'].\"\\r\\n\" ;\n\n}\n\n$filename = 'ouvrage_'.uniqid('', TRUE).'.csv';\n\nfile_put_contents($filename, $csv);\n\n$_SESSION['I_CAN_DOWNLOAD_ONLY_THIS'] = $filename;\n\n?>\n\ngimme_file.php\n<?php\nsession_start();\n\nheader(\"Content-Type: text/csv; charset=utf-8\");\nheader(\"Content-Disposition: attachment; filename=data.csv\");\nreadfile($_SESSION['I_CAN_DOWNLOAD_ONLY_THIS']);\nexit;\n\n?>\n\n"
}