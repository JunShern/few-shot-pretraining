{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:', 'A:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": true,
            "reason": "Text contains ['*', '+', '+', '+', '+', '*', '+', '+', '+', '+']."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "372",
    "text": "Q:\n\nSQL Join Tables Apply Value Only Once To Each Set\n\nI need to join two tables together. However, the table being joined must only apply its value once to a set a rows with the same value. This is what I mean...\nTABLE JOIN I WANT IS BELOW\n\n** LOGGED HOURS **   ** SICK HOURS **        ** RESULT TABLE **\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|Name    | Hours |  |Name    | Hours |  |Name    |Hours  |Sick   |\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|David   |47     |  |David   |9      |  |David   |47     |9      |\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|David   |9      |                      |David   |9      |0      |\n+--------+-------+                      +--------+-------+-------+\n\nNORMAL LEFT TABLE JOIN RESULT:\n\n** LOGGED HOURS **   ** SICK HOURS **        ** RESULT TABLE **\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|Name    | Hours |  |Name    | Hours |  |Name    |Hours  |Sick   |\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|David   |47     |  |David   |9      |  |David   |47     |9      |\n+--------+-------+  +--------+-------+  +--------+-------+-------+\n|David   |9      |                      |David   |9      |9      |\n+--------+-------+                      +--------+-------+-------+\n\nNotice, 9 is applied to EACH row in a normal left table join. I want 9 to be applied ONLY ONCE to the set of rows whose name is DAVID.\nFeel free to as any questions, thanks.\nEDIT: If you're going to down-vote my question, please provide the courtesy of explaining why and how I can improve my question in the future. Thank you.\n\nA:\n\nSince you just want a single record for each \"Name\" to get your sick hours and the selection can be arbitrary, you can use a Window Function:\nSELECT\n    LoggedHours.Name,\n    LoggedHours.Hours,\n    CASE WHEN ROW_NUMBER() OVER (PARTITION BY LoggedHours.Name ORDER BY 1) = 1 THEN SickHours.Hours ELSE NULL END AS SickHoursLogged\nFROM \n    LoggedHours LEFT OUTER JOIN SickHours on LoggedHours.Name = SickHours.Name\n\nSo... that Window/Analytics function says:\n\nSplit the result set by Name (group of records with \"David\" for\n  example) and order them by whatever. Then give that group of records\n  row numbers starting at 1. If this particular record is row 1, then it\n  gets the sick hours from the SickHours table. Otherwise it gets\n  Null.\n\nIf... you wanted it to not be arbitrary, but instead wanted the record with the largest logged hours for each person to get the sick hours, you could change that ROW_NUMBER() function to:\nROW_NUMBER() OVER (PARTITION BY LoggedHours.Name ORDER BY LoggedHours.Hours DESC) = 1 \n\n"
}