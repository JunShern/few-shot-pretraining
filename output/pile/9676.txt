{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "Domain",
            "passed": false,
            "reason": "Document source unavailable."
        },
        {
            "criterion": "QuestionAnswerStrings",
            "passed": true,
            "reason": "Text contains Q:."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefix",
            "passed": false,
            "reason": "Found 0 list prefixes. (Min: 5)"
        },
        {
            "criterion": "ListPrefixV2",
            "passed": true,
            "reason": "Text contains ['-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '1', '2', '*', '*', '*', '*', '*', '-', '-', '-', '1', '2', '3', '-', '1', '-', '0', '-', '1', '2', '-', '-', '1', '2', '-', '-', '1', '2', '1', '2', '2', '-', '2', '2', '3', '1', '2', '3', '1', '2', '3', '4', '-', '-', '1', '-', '-', '-', '1', '2', '-', '-', '-', '-', '1', '2', '3', '4', '1', '2', '-', '-', '2', '-', '-', '-', '-', '-', '-', '-', '2']."
        }
    ],
    "doc_id": "9676",
    "text": "---\nabstract: 'This paper has four main parts. In the first part, we construct a noncommutative residue for the hypoelliptic calculus on Heisenberg manifolds, that is, for the class of [$\\Psi_{H}$DO]{}\u00a0operators introduced by Beals-Greiner and Taylor. This noncommutative residue appears as the residual trace on integer order [$\\Psi_{H}$DOs]{}\u00a0 induced by the analytic extension of the usual trace to non-integer order [$\\Psi_{H}$DOs]{}. Moreover, it agrees with the integral of the density defined by the logarithmic singularity of the Schwartz kernel of the corresponding [$\\Psi_{H}$DO]{}. In addition, we show that this noncommutative residue provides us with the unique trace up to constant multiple on the algebra of integer order [$\\Psi_{H}$DOs]{}. In the second part, we give some analytic applications of this construction concerning zeta functions of hypoelliptic operators, logarithmic metric estimates for Green kernels of hypoelliptic operators, and the extension of the Dixmier trace to the whole algebra of integer order [$\\Psi_{H}$DOs]{}. In the third part, we present examples of computations of noncommutative residues of some powers of the horizontal sublaplacian and the contact Laplacian on contact manifolds. In the fourth part, we present two applications in CR geometry. First, we give some examples of geometric computations of noncommutative residues of some powers of the horizontal sublaplacian and of the Kohn Laplacian. Second, we make use of the framework of noncommutative geometry and of our noncommutative residue to define lower dimensional volumes in pseudohermitian geometry, e.g., we can give sense to the area of any 3-dimensional CR manifold. On the way we obtain a spectral interpretation of the Einstein-Hilbert action in pseudohermitian geometry.'\naddress: 'Department of Mathematics, University of Toronto, Canada.'\nauthor:\n- Rapha\u00ebl Ponge\ntitle: 'Noncommutative residue for Heisenberg manifolds. Applications in CR and contact geometry'\n---\n\nIntroduction\n============\n\nThe aim of this paper is to construct a noncommutative residue trace for the Heisenberg calculus and to present several of its applications, in particular in CR and contact geometry. The Heisenberg calculus was built independently by Beals-Greiner\u00a0[@BG:CHM] and Taylor\u00a0[@Ta:NCMA] as the relevant pseudodifferential tool to study the main geometric operators on contact and CR manifolds, which fail to be elliptic, but may be hypoelliptic (see also\u00a0[@BdM:HODCRPDO], [@EM:HAITH], [@FS:EDdbarbCAHG], [@Po:MAMS1]). This calculus holds in the general setting of a Heisenberg manifold, that is, a manifold $M$ together with a distinguished hyperplane bundle $H\\subset TM$, and we construct a noncommutative residue trace in this general context.\n\nThe noncommutative residue trace of Wodzicki\u00a0([@Wo:LISA], [@Wo:NCRF]) and Guillemin\u00a0[@Gu:NPWF] was originally constructed for classical [$\\Psi$DOs]{}\u00a0and it appears as the residual trace on integer order [$\\Psi$DOs]{}\u00a0induced by analytic extension of the operator trace to [$\\Psi$DOs]{}\u00a0of non-integer order. It has numerous applications and generalizations (see, e.g., [@Co:AFNG], [@Co:GCMFNCG], [@CM:LIFNCG], [@FGLS:NRMB], [@Gu:RTCAFIO], [@Ka:RNC], [@Le:NCRPDOLPS], [@MMS:FIT], [@MN:HPDO1], [@PR:CDBFCF], [@Po:IJM1], [@Sc:NCRMCS], [@Vas:PhD]). In particular, the existence of a residual trace is an essential ingredient in the framework for the local index formula in noncommutative geometry of Connes-Moscovici\u00a0[@CM:LIFNCG].\n\nAccordingly, the noncommutative residue for the Heisenberg calculus has various applications and several of them are presented in this paper. Further geometric applications can be found in\u00a0[@Po:Crelle2].\n\nNoncommutative residue for Heisenberg manifolds\n-----------------------------------------------\n\nOur construction of a noncommutative residue trace for [$\\Psi_{H}$DOs]{}, i.e., for the pseudodifferential operators in the Heisenberg calculus, follows the approach of\u00a0[@CM:LIFNCG]. It has two main ingredients:\n\n\\(i) The observation that the coefficient of the logarithmic singularity of the Schwartz kernel of a [$\\Psi_{H}$DO]{}\u00a0operator $P$ can be defined globally as a density $c_{P}(x)$ functorial with respect to the action of Heisenberg diffeomorphisms, i.e., diffeomorphisms preserving the Heisenberg structure (see Proposition\u00a0\\[thm:NCR.log-singularity\\]).\n\n\\(ii) The analytic extension of the operator trace to [$\\Psi_{H}$DOs]{}\u00a0of complex non-integer order (Proposition\u00a0\\[thm:NCR.TR.global\\]).\n\nThe analytic extension of the trace from (ii) is obtained by working directly at the level of densities and induces on [$\\Psi_{H}$DOs]{}\u00a0of integer order a residual trace given by (minus) the integral of the density from (i) (Proposition\u00a0\\[thm:NCR.TR.local\\]). This residual trace is our noncommutative residue for the Heisenberg calculus.\n\nIn particular, as an immediate byproduct of this construction the noncommutative residue is invariant under the action of Heisenberg diffeomorphisms. Moreover, in the foliated case our noncommutative residue agrees with that of\u00a0[@CM:LIFNCG], and on the algebra of Toeplitz pseudodifferential operators on a contact manifold of Boutet de Monvel-Guillemin\u00a0[@BG:STTO] we recover the noncommutative residue of Guillemin\u00a0[@Gu:RTCAFIO]. As a first application of this construction we show that when the Heisenberg manifold is connected the noncommutative residue is the unique trace up to constant multiple on the algebra of integer order [$\\Psi_{H}$DOs]{}\u00a0(Theorem\u00a0\\[thm:Traces.traces\\]). As a consequence we get a characterization sums of [$\\Psi_{H}$DO]{}\u00a0commutators and we obtain that any smoothing operator can be written as a sum of [$\\Psi_{H}$DO]{}\u00a0 commutators.\n\nThese results are the analogues for [$\\Psi_{H}$DOs]{}\u00a0of well known results of Wodzicki\u00a0([@Wo:PhD]; see also\u00a0[@Gu:RTCAFIO]) for classical [$\\Psi$DOs]{}. Our arguments are somewhat elementary and partly rely on the characterization of the Schwartz kernels of [$\\Psi_{H}$DOs]{}\u00a0that was used in the analysis of their logarithmic singularities near the diagonal.\n\nAnalytic applications on general Heisenberg manifolds\n-----------------------------------------------------\n\nThe analytic extension of the trace allows us to directly define the zeta function $\\zeta_{\\theta}(P;s)$ of a hypoelliptic [$\\Psi_{H}$DO]{}\u00a0operator $P$ as a meromorphic functions on ${\\ensuremath{\\mathbb{C}}}$. The definition depends on the choice of a ray $L_{\\theta}=\\{\\arg \n  \\lambda =\\theta\\}$, $0\\leq \\theta <2\\pi$, which is a ray of principal values for the principal symbol of $P$ in the sense of\u00a0[@Po:CPDE1] and is not through an eigenvalue of $P$, so that $L_{\\theta}$ is a ray of minimal growth for $P$. Moreover, the residues at the potential singularity points of $\\zeta_{\\theta}(P;s)$ can be expressed as noncommutative residues.\n\nWhen the set of principal values of the principal symbol of $P$ contains the left half-plane $\\Re \\lambda\\leq 0$ we further can relate the residues and regular values of $\\zeta_{\\theta}(P;s)$ to the coefficients in the heat kernel asymptotics for $P$ (see Proposition\u00a0\\[prop:Zeta.heat-zeta-global\\] for the precise statement). We then use this to derive a local formula for the index of a hypoelliptic [$\\Psi_{H}$DO]{}\u00a0and to rephrase in terms of noncommutative residues the Weyl asymptotics for hypoelliptic [$\\Psi$DOs]{}\u00a0from\u00a0[@Po:MAMS1] and\u00a0[@Po:CPDE1]. An interesting application concerns logarithmic metric estimates for Green kernels of hypoelliptic [$\\Psi_{H}$DOs]{}. It is not true that a positive hypoelliptic [$\\Psi_{H}$DO]{}\u00a0has a Green kernel positive near the diagonal. Nevertheless, by making use of the spectral interpretation of the noncommutative residue as a residual trace, we show that the positivity still pertains when the order is equal to the critical dimension $\\dim M+1$ (Proposition\u00a0\\[prop:Metric.positivity-cP\\]).\n\nWhen the bracket condition $H+[H,H]=TM$ holds, i.e., $H$ is a Carnot-Carath\u00e9odory distribution, this allows us to get metric estimates in terms of the Carnot-Carath\u00e9odory metric associated to any given subriemannian metric on $H$ (Theorem\u00a0\\[thm:Metric.metric-estimate\\]). This result connects nicely with the work of Fefferman, Stein and their collaborators on metric estimates for Green kernels of subelliptic sublaplacians on general Carnot-Carath\u00e9odory manifolds (see, e.g.,\u00a0[@FS:FSSOSO], [@Ma:EPKLCD], [@NSW:BMDVF1], [@Sa:FSGSSVF]).\n\nFinally, we show that on a Heisenberg manifold $(M,H)$ the Dixmier trace is defined for [$\\Psi_{H}$DOs]{}\u00a0of order less than or equal to the critical order $-(\\dim M+1)$ and on such operators agrees with the noncommutative residue (Theorem\u00a0\\[thm:NCG.Dixmier\\]). Therefore, the noncommutative residue allows us to extend the Dixmier trace to the whole algebra of [$\\Psi_{H}$DOs]{}\u00a0of integer order. In noncommutative geometry the Dixmier trace plays the role of the integral on infinitesimal operator of order\u00a0$\\leq 1$. Therefore, our result allows us to integrate any [$\\Psi_{H}$DO]{}\u00a0even though it is not an infinitesimal operator of order\u00a0$\\leq 1$. This is the analogue of a well known result of Connes\u00a0[@Co:AFNG] for classical [$\\Psi$DOs]{}.\n\nNoncommutative residue and contact geometry\n-------------------------------------------\n\nLet $(M^{2n+1},H)$ be a compact orientable contact manifold, so that the hyperplane bundle $H\\subset TM$ can be realized as the kernel of a contact form $\\theta$ on $M$. The additional datum of a *calibrated* almost complex structure on $H$ defines a Riemannian metric on $M$ whose volume ${{\\operatorname{Vol}}}_{\\theta}M$ depends only on $\\theta$.\n\nLet $\\Delta_{b;k}$ be the horizontal sublaplacian associated to the above Riemannian metric acting on horizontal forms of degree $k$, $k\\neq n$. This operator is hypoelliptic for $k\\neq n$ and by making use of the results of\u00a0[@Po:MAMS1] we can explicitly express the noncommutative residue of $\\Delta_{b;k}^{-(n+1)}$ as a constant multiple of ${{\\operatorname{Vol}}}_{\\theta}M$ (see Proposition\u00a0\\[prop:Contact.residue-Deltab\\]).\n\nNext, the contact complex of Rumin\u00a0[@Ru:FDVC] is a complex of horizontal forms on a contact manifold whose Laplacians are hypoelliptic in every bidegree. Let $\\Delta_{R;k}$ denote the contact Laplacian acting on forms degree $k$, $k=0,\\ldots,n$. Unlike the horizontal sublaplacian $\\Delta_{R}$ does not act on all horizontal forms, but on the sections of a subbundle of horizontal forms. Moreover, it is not a sublaplacian and it even has order 4 on forms of degree $n$. Nevertheless, by making use of the results of\u00a0[@Po:MAMS1] we can show that the noncommutative residues of $\\Delta_{R;k}^{-(n+1)}$ for $k\\neq n$ and of $\\Delta_{R;n}^{-\\frac{n+1}{2}}$ are universal constant multiples of the contact volume ${{\\operatorname{Vol}}}_{\\theta}M$ (see Proposition\u00a0\\[prop:Contact.residue-DeltaR\\]).\n\nApplications in CR geometry\n---------------------------\n\nLet $(M^{2n+1},H)$ be a compact orientable $\\kappa$-strictly pseudoconvex CR manifold equipped with a pseudohermitian contact form $\\theta$, i.e., the hyperplane bundle $H\\subset TM$ has an (integrable) complex structure and the Levi form associated to $\\theta$ has at every point $n-\\kappa$ positive eigenvalues and $\\kappa$ negative eigenvalues. If $h$ is a Levi metric on $M$ then the volume with respect to this metric depends only on $\\theta$ and is denoted ${{\\operatorname{Vol}}}_{\\theta}M$.\n\nAs in the general contact case we can explicitly relate the pseudohermitian volume ${{\\operatorname{Vol}}}_{\\theta}M$ to the noncommutative residues of the following operators:\n\n- ${\\square}_{b;pq}^{-(n+1)}$, where ${\\square}_{b;pq}$ denotes the Kohn Laplacian acting on $(p,q)$-forms with $q\\neq \\kappa$ and $q\\neq n-\\kappa$ (see Proposition\u00a0\\[prop:CR.residue-Boxb1\\]);\n\n- $\\Delta_{b;pq}^{-(n+1)}$, where $\\Delta_{b;pq}$ denotes the horizontal sublaplacian acting on $(p,q)$-forms with $(p,q)\\neq (n-\\kappa,\\kappa)$ and $(p,q)\\neq (\\kappa,n-\\kappa)$ (see Proposition\u00a0\\[prop:CR.residue-Deltab1\\]).\n\nFrom now on we assume $M$ strictly pseudoconvex (i.e.\u00a0we have $\\kappa=0$) and consider the following operators:\n\n- ${\\square}_{b;pq}^{-n}$, with $q\\neq 0$ and $q\\neq n$,;\n\n- $\\Delta_{b;pq}^{-n}$, with $(p,q)\\neq (n,0)$ and $(p,q)\\neq (0,n)$.\n\nThen we can make use of the results of\u00a0[@BGS:HECRM] to express the noncommutative residues of these operators as universal constant multiple of the integral $\\int_{M}R_{n}d\\theta^{n}\\wedge \\theta$, where $R_{n}$ denotes the scalar curvature of the connection of Tanaka\u00a0[@Ta:DGSSPCM] and Webster\u00a0[@We:PHSRH] (see Propositions\u00a0\\[prop:CR.residue-Boxb2\\] and\u00a0\\[prop:CR.residue-Deltab2\\]). These last results provide us with a spectral interpretation of the Einstein-Hilbert action in pseudohermitian geometry, which is analogous to that of Connes\u00a0([@Co:GCMFNCG], [@KW:GNGWR], [@Ka:DOG]) in the Riemannian case. Finally, by using an idea of Connes\u00a0[@Co:GCMFNCG] we can make use of the noncommutative residue for classical [$\\Psi$DOs]{}\u00a0to define the $k$-dimensional volumes Riemannian manifold of dimension $m$ for $k=1,\\ldots,m-1$, e.g.\u00a0we can give sense to the area in any dimension (see\u00a0[@Po:LMP07]). Similarly, we can make use of the noncommutative residue for the Heisenberg calculus to define the $k$-dimensional pseudohermitian volume ${{\\operatorname{Vol}}}^{(k)}_{\\theta}M$ for any $k=1,\\ldots,2n+2$. The argument involves noncommutative geometry, but we can give a purely differential geometric expression of these lower dimensional volumes (see\u00a0Proposition\u00a0\\[prop:CR.lower-dim.-volumes\\]). Furthermore, in dimension 3 the area (i.e.\u00a0the 2-dimensional volume) is a constant multiple of the integral of the Tanaka-Webster scalar curvature (Theorem\u00a0\\[thm:spectral.area\\]). In particular, we find that the area of the sphere $S^{3}\\subset {\\ensuremath{\\mathbb{C}}}^{2}$ endowed with its standard pseudohermitian structure has area $\\frac{\\pi^{2}}{8\\sqrt{2}}$.\n\nPotential geometric applications\n--------------------------------\n\nThe boundaries of a strictly pseudoconvex domain of ${\\ensuremath{\\mathbb{C}}}^{n+1}$ naturally carry strictly pseudoconvex CR structures, so one can expect the above results to be useful for studying from the point of view of noncommutative geometry strictly pseudoconvex boundaries, and more generally Stein manifolds with boundaries and the asymptotically complex hyperbolic manifolds of\u00a0[@EMM:RLSPD]. Similarly, the boundary of a symplectic manifold naturally inherits a contact structure, so we could also use the results of this papers to give a noncommutative geometric study of symplectic manifolds with boundary.\n\nAnother interesting potential application concerns a special class of Lorentzian manifolds, the Fefferman\u2019s spaces\u00a0([@Fe:MAEBKGPCD], [@Le:FMPHI]). A Fefferman\u2019s Lorentzian space ${\\ensuremath{\\mathcal{F}}}$ can be realized as the total space of a circle bundle over a strictly pseudoconvex CR manifold $M$ and it carries a Lorentzian metric naturally associated to any pseudohermitian contact form on $M$. For instance, the curvature tensor of ${\\ensuremath{\\mathcal{F}}}$ can be explicitly expressed in terms of the curvature and torsion tensors of the Tanaka-Webster connection of $M$ and the Dalembertian of ${\\ensuremath{\\mathcal{F}}}$ pushes down to the horizontal sublaplacian on $M$. This strongly suggests that one could deduce a noncommutative geometric study of Fefferman spaces from a noncommutative geometric study of strictly pseudoconvex CR manifolds. An item of special interest would be to get a spectral interpretation of the Einstein-Hilbert action in this setting.\n\nFinally, it would be interesting to extend the results of this paper to other subriemannian geometries such as the quaternionic contact manifolds of Biquard\u00a0[@Bi:MEAS].\n\nOrganization of the paper\n-------------------------\n\nThe rest of the paper is organized as follows.\n\nIn Section\u00a0\\[sec:Heisenberg-calculus\\], we recall the main facts about Heisenberg manifold and the Heisenberg calculus.\n\nIn Section\u00a0\\[sec:NCR\\], we study the logarithmic singularity of the Schwartz kernel of a [$\\Psi_{H}$DO]{}\u00a0and show that it gives rise to a well defined density. We then construct the noncommutative residue for the Heisenberg calculus as the residual trace induced on integer order [$\\Psi_{H}$DOs]{}\u00a0by the analytic extension of the usual trace to non-integer order [$\\Psi_{H}$DOs]{}. Moreover, we show that the noncommutative residue of an integer order [$\\Psi_{H}$DO]{}\u00a0 agrees with the integral of the density defined by the logarithmic singularity of its Schwartz kernel. We end the section by proving that, when the Heisenberg manifold is connected, the noncommutative residue is the only trace up to constant multiple.\n\nIn Section\u00a0\\[sec:Analytic-Applications\\], we give some analytic applications of the construction of the noncommutative residue. First, we deal with zeta functions of hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0and relate their singularities to the heat kernel asymptotics of the corresponding operators. Second, we prove logarithmic metric estimates for Green kernels of hypoelliptic [$\\Psi_{H}$DOs]{}. Finally, we show that the noncommutative residue allows us to extend the Dixmier trace to *all* integer order [$\\Psi_{H}$DOs]{}.\n\nIn Section\u00a0\\[sec:Contact\\], we present examples of computations of noncommutative residues of some powers of the horizontal sublaplacian and of the contact Laplacian of Rumin on contact manifolds.\n\nIn Section\u00a0\\[sec:CR\\], we present some applications in CR geometry. First, we give some examples of geometric computations of noncommutative residues of some powers of the horizontal sublaplacian and of the Kohn Laplacian. Second, we make use of the framework of noncommutative geometry and of the noncommutative residue for the Heisenberg calculus to define lower dimensional volumes in pseudohermitian geometry.\n\nFinally, in Appendix for reader\u2019s convenience we present a detailed proof of Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\] about the extension of a homogeneous symbol into a homogeneous distribution. This is needed for the analysis of the logarithmic singularity of the Schwartz kernel of a [$\\Psi_{H}$DO]{}\u00a0in Section\u00a0\\[sec:NCR\\].\n\nPart of the results of this paper were announced in\u00a0[@Po:CRAS1] and\u00a0[@Po:CRAS2] and were presented as part of my PhD thesis at the University of Paris-Sud (Orsay, France) in December 2000. I am grateful to my advisor, Alain Connes, and to Charlie Epstein, Henri Moscovici and Michel Rumin, for stimulating and helpful discussions related to the subject matter of this paper. In addition, I would like to thank Olivier Biquard, Richard Melrose and Pierre Pansu for their interests in the results of this paper.\n\nHeisenberg calculus {#sec:Heisenberg-calculus}\n===================\n\nThe Heisenberg calculus is the relevant pseudodifferential calculus to study hypoelliptic operators on Heisenberg manifolds. It was independently introduced by Beals-Greiner\u00a0[@BG:CHM] and Taylor\u00a0[@Ta:NCMA] (see also\u00a0[@BdM:HODCRPDO], [@Dy:POHG], [@Dy:APOHSC], [@EM:HAITH], [@FS:EDdbarbCAHG], [@Po:MAMS1], [@RS:HDONG]). In this section we recall the main facts about the Heisenberg calculus following the point of view of\u00a0[@BG:CHM] and\u00a0[@Po:MAMS1].\n\nHeisenberg manifolds\n--------------------\n\nIn this subsection we gather the main definitions and examples concerning Heisenberg manifolds and their tangent Lie group bundles.\n\n1\\) A Heisenberg manifold is a pair $(M,H)$ consisting of a manifold $M$ together with a distinguished hyperplane bundle $H \n\\subset TM$.\n\n2\\) Given Heisenberg manifolds $(M,H)$ and $(M',H')$ a diffeomorphism $\\phi:M\\rightarrow M'$ is said to be a Heisenberg diffeomorphism when $\\phi_{*}H=H'$.\n\nFollowing are the main examples of Heisenberg manifolds:\n\n*- Heisenberg group.* The $(2n+1)$-dimensional Heisenberg group ${\\ensuremath{\\mathbb{H}}}^{2n+1}$ is the 2-step nilpotent group consisting of ${\\ensuremath{\\mathbb{R}}}^{2n+1}={\\ensuremath{\\mathbb{R}}}\\times {\\ensuremath{\\mathbb{R}}}^{2n}$ equipped with the group law, $$x.y=(x_{0}+y_{0}+\\sum_{1\\leq j\\leq n}(x_{n+j}y_{j}-x_{j}y_{n+j}),x_{1}+y_{1},\\ldots,x_{2n}+y_{2n}).  \n$$ A left-invariant basis for its Lie algebra ${\\ensuremath{\\mathfrak{h}}}^{2n+1}$ is then provided by the vector fields, $$X_{0}=\\frac{\\partial}{\\partial x_{0}}, \\quad X_{j}=\\frac{\\partial}{\\partial x_{j}}+x_{n+j}\\frac{\\partial}{\\partial \n        x_{0}}, \\quad X_{n+j}=\\frac{\\partial}{\\partial x_{n+j}}-x_{j}\\frac{\\partial}{\\partial \n        x_{0}}, \\quad 1\\leq j\\leq n.\n$$ For $j,k=1,\\ldots,n$ and $k\\neq j$ we have the Heisenberg relations $[X_{j},X_{n+k}]=-2\\delta_{jk}X_{0}$ and $[X_{0},X_{j}]=[X_{j},X_{k}]=[X_{n+j},X_{n+k}]=0$. In particular, the subbundle spanned by the vector field $X_{1},\\ldots,X_{2n}$ yields a left-invariant Heisenberg structure on ${\\ensuremath{\\mathbb{H}}}^{2n+1}$.\n\n*- Foliations.* A (smooth) foliation is a manifold $M$ together with a subbundle ${\\ensuremath{\\mathcal{F}}}\\subset TM$ integrable in Frobenius\u2019 sense, i.e., the space of sections of $H$ is closed under the Lie bracket of vector fields. Therefore, any codimension 1 foliation is a Heisenberg manifold.\n\n*- Contact manifolds.* Opposite to foliations are contact manifolds. A contact manifold is a Heisenberg manifold $(M^{2n+1}, H)$ such that $H$ can be locally realized as the kernel of a contact form, that is, a $1$-form $\\theta$ such that $d\\theta_{|H}$ is nondegenerate. When $M$ is orientable it is equivalent to require $H$ to be globally the kernel of a contact form. Furthermore, by Darboux\u2019s theorem any contact manifold is locally Heisenberg-diffeomorphic to the Heisenberg group ${\\ensuremath{\\mathbb{H}}}^{2n+1}$ equipped with the standard contact form $\\theta^{0}= dx_{0}+\\sum_{j=1}^{n}(x_{j}dx_{n+j}-x_{n+j}dx_{j})$.\n\n*- Confoliations.* According to Elyashberg-Thurston\u00a0[@ET:C] a *confoliation structure* on an oriented manifold $M^{2n+1}$ is given by a global non-vanishing $1$-form $\\theta$ on $M$ such that $(d\\theta)^{n}\\wedge \\theta\\geq 0$. In particular, if we let $H=\\ker \\theta$ then $(M,H)$ is a Heisenberg manifold which is a foliation when $d\\theta\\wedge \\theta=0$ and a contact manifold when $(d\\theta)^{n}\\wedge \\theta>0$.\n\n*- CR manifolds.* A CR structure on an orientable manifold $M^{2n+1}$ is given by a rank $n$ complex subbundle $T_{1,0}\\subset T_{{\\ensuremath{\\mathbb{C}}}}M$ such that $T_{1,0}$ is integrable in Frobenius\u2019 sense and we have $T_{1,0}\\cap T_{0,1}=\\{0\\}$, where we have set $T_{0,1}=\\overline{T_{1,0}}$. Equivalently, the subbundle $H=\\Re (T_{1,0}\\otimes T_{0,1})$ has the structure of a complex bundle of (real) dimension $2n$. In particular, $(M,H)$ is a Heisenberg manifold. The main example of a CR manifold is that of the (smooth) boundary $M=\\partial D$ of a bounded complex domain $D \\subset {\\ensuremath{\\mathbb{C}}}^{n+1}$. In particular, when $D$ is strongly pseudoconvex with defining function $\\rho$ the 1-form $\\theta=i(\\partial\n-\\bar{\\partial})\\rho$ is a contact form on $M$.\n\nNext, the terminology Heisenberg manifold stems from the fact that the relevant tangent structure in this setting is that of a bundle $GM$ of graded nilpotent Lie groups (see\u00a0[@BG:CHM], [@Be:TSSRG], [@EMM:RLSPD], [@FS:EDdbarbCAHG], [@Gr:CCSSW], [@Po:Pacific1], [@Ro:INA], [@Va:PhD]). This tangent Lie group bundle can be described as follows.\n\nFirst, there is an intrinsic Levi form ${\\ensuremath{\\mathcal{L}}}:H\\times H\\rightarrow TM/H$ such that, for any point $a \n\\in M$ and any sections $X$ and $Y$ of $H$ near $a$, we have $${\\ensuremath{\\mathcal{L}}}_{a}(X(a),Y(a))=[X,Y](a) \\qquad \\bmod H_{a}.\n     \\label{eq:Heisenberg.Levi-form}$$ In other words the class of $[X,Y](a)$ modulo $H_{a}$ depends only on the values $X(a)$ and $Y(a)$, not on the germs of $X$ and $Y$ near $a$ (see\u00a0[@Po:Pacific1]). This allows us to define the tangent Lie algebra bundle ${\\ensuremath{\\mathfrak{g}}}M$ as the vector bundle $(TM/H)\\oplus H$ together with the grading and field of Lie brackets such that, for sections $X_{0}$, $Y_{0}$ of $TM/H$ and $X'$, $Y'$ of $H$, we have $$\\begin{gathered}\n     t.(X_{0}+X')=t^{2}X_{0}+t X', \\qquad t\\in {\\ensuremath{\\mathbb{R}}},   \n     \\label{eq:Heisenberg.Heisenberg-dilations}\\\\\n     [X_{0}+X',Y_{0}+Y']_{{\\ensuremath{\\mathfrak{g}}}M}={\\ensuremath{\\mathcal{L}}}(X',Y').\n   \\end{gathered}$$\n\nSince each fiber ${\\ensuremath{\\mathfrak{g}}}_{a}M$ is 2-step nilpotent, ${\\ensuremath{\\mathfrak{g}}}M$ is the Lie algebra bundle of a Lie group bundle $GM$ which can be realized as $(TM/H)\\oplus H$ together with the field of group law such that, for sections $X_{0}$, $Y_{0}$ of $TM/H$ and $X'$, $Y'$ of $H$, we have $$(X_{0}+X').(Y_{0}+Y')=X_{0}+Y_{0}+\\frac{1}{2}{\\ensuremath{\\mathcal{L}}}(X',Y')+X'+Y'.\n      \\label{eq:Heisenberg.group-law}$$ We call $GM$ the *tangent Lie group bundle* of $M$.\n\nLet $\\phi$ be a Heisenberg diffeomorphism from $(M,H)$ onto a Heisenberg manifold $(M',H')$. Since we have $\\phi_{*}H=H'$ the linear differential $\\phi'$ induces linear vector bundle isomorphisms $\\phi':H\\rightarrow H'$ and $\\overline{\\phi'}:TM/H\\rightarrow TM'/H'$, so that we get a linear vector bundle isomorphism $\\phi_{H}':(TM/H)\\oplus H\\rightarrow (TM'/H')\\oplus H'$ by letting $$\\phi_{H}'(a).(X_{0}+X')= \\overline{\\phi'}(a)X_{0}+\\phi'(a)X',\n     \\label{eq:Heisenberg.tangent-map}$$ for any $a \\in M$ and any $X_{0}$ in $(T_{a}M/H_{a})$ and $X'$ in $H_{a}$. This isomorphism commutes with the dilations in\u00a0(\\[eq:Heisenberg.Heisenberg-dilations\\]) and it can be further shown that it gives rise to a Lie group isomorphism from $GM$ onto $GM'$ (see\u00a0[@Po:Pacific1]).\n\nThe above description of $GM$ can be related to the extrinsic approach of\u00a0[@BG:CHM] as follows.\n\nA local frame $X_{0},X_{1},\\ldots,X_{d}$ of $TM$ such that $X_{1},\\ldots,X_{d}$ span $H$ is called a $H$-frame.\n\nLet $U \\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of local coordinate equipped with a $H$-frame $X_{0},\\ldots,X_{d}$.\n\n\\[def:Heisenberg-privileged-coordinates\\] For $a\\in U$ we let $\\psi_{a}:{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\rightarrow {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ denote the unique affine change of variable such that $\\psi_{a}(a)=0$ and $(\\psi_{a})_{*}X_{j}(0)=\\frac{\\partial}{\\partial x_{j}}$ for $j=0,\\ldots,d$. The coordinates provided by the map $\\psi_{a}$ are called privileged coordinates centered at $a$.\n\nIn addition, on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ we consider the dilations, $$t.x=(t^{2}x_{0},tx_{1},\\ldots,tx_{d}), \\qquad t \\in {\\ensuremath{\\mathbb{R}}}.\n        \\label{eq:Heisenberg.Heisenberg-dilations-Rd}$$\n\nIn privileged coordinates centered at $a$ we can write $X_{j}=\\frac{\\partial}{\\partial x_{j}}+\\sum_{k=0}^{d}a_{jk}(x)\\frac{\\partial}{\\partial x_{j}}$ with $a_{jk}(0)=0$. Let $X_{0}^{(a)}=\\frac{\\partial}{\\partial x_{0}}$ and for $j=1,\\ldots,d$ let $X_{j}^{(a)}=\\frac{\\partial}{\\partial_{x_{j}}}+\\sum_{k=1}^{d}b_{jk}x_{k} \n    \\frac{\\partial}{\\partial_{x_{0}}}$, where $b_{jk}= \\partial_{x_{k}}a_{j0}(0)$. With respect to the dilations\u00a0(\\[eq:Heisenberg.Heisenberg-dilations-Rd\\]) the vector field $X_{j}^{(a)}$ is homogeneous of degree $w_{0}=-2$ for $j=0$ and of degree $w_{j}=-1$ for $j=1,\\ldots,d$. In fact, using Taylor expansions at $x=0$ we get a formal expansion $X_{j} \\sim X_{j}^{(a)}+X_{j,w_{j}-1}+\\ldots$, with $X_{j,l}$ homogeneous vector field of degree $l$.\n\nThe subbundle spanned by the vector fields $X_{j}^{(a)}$ is a 2-step nilpotent Lie algebra under the Lie bracket of vectors fields. Its associated Lie group $G^{(a)}$ can be realized as ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ equipped with the group law, $$x.y=(x_{0}+\\sum_{j,k=1}^{d}b_{kj}x_{j}x_{k},x_{1},\\ldots,x_{d}).\n$$\n\nOn the other hand, the vectors $X_{0}(a),\\ldots,X_{d}(a)$ provide us with a linear basis of the space $(T_{a}M/H_{a})\\oplus H_{a}$. This allows us to identify $G_{a}M$ with ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ equipped with the group law, $$x.y=(x_{0}+y_{0}+\\frac{1}{2}L_{jk}(a)x_{j}y_{k},x_{1}+y_{1},\\ldots,x_{d}+y_{d}). \n    \\label{eq:Heisenberg.group-law-tangent-group-coordinates}$$ Here the functions $L_{jk}$ denote the coefficients of the Levi form\u00a0(\\[eq:Heisenberg.Levi-form\\]) with respect to the $H$-frame $X_{0},\\ldots,X_{d}$, i.e., we have ${\\ensuremath{\\mathcal{L}}}(X_{j},X_{k})=[X_{j},X_{k}]=L_{jk}X_{0} \n\\bmod H$.\n\nThe Lie group $G^{(a)}$ is isomorphic to $G_{a}M$ since one can check that $L_{jk}=b_{jk}-b_{kj}$. An explicit isomorphism is given by $$\\phi_{a}(x_{0},\\ldots,x_{d})= (x_{0}-\\frac{1}{4}\\sum_{j,k=1}^{d}(b_{jk}+b_{kj})x_{j}x_{k},x_{1},\\ldots,x_{d}). \n$$\n\n\\[def:Heisenberg-Heisenberg-coordinates\\] The local coordinates provided by the map $\\varepsilon_{a}:=\\phi_{a}\\circ\\psi_{a}$ are called Heisenberg coordinates centered at $a$.\n\nThe Heisenberg coordinates refines the privileged coordinates in such way that the above realizations of $G^{(a)}$ and $G_{a}M$ agree. In particular, the vector fields $X_{j}^{(a)}$ and $X_{j}^{a}$ agree in these coordinates. This allows us to see $X_{j}^{a}$ as a first order approximation of $X_{j}$. For this reason $X_{j}^{a}$ is called the *model vector field of $X_{j}$* at $a$.\n\nLeft-invariant pseudodifferential operators\n-------------------------------------------\n\nLet $(M^{d+1},H)$ be a Heisenberg manifold and let $G$ be the tangent group $G_{a}M$ of $M$ at a given point $a\\in M$. We briefly recall the calculus for homogeneous left-invariant [$\\Psi$DOs]{}\u00a0on the nilpotent group $G$.\n\nRecall that if $E$ is a finite dimensional vector space the Schwartz class ${\\ensuremath{\\mathcal{S}}}(E)$ carries a natural Fr\u00e9chet space topology and the Fourier transform of a function $f\\in {\\ensuremath{\\mathcal{S}}}(E)$ is the element $\\hat{f}\\in {\\ensuremath{\\mathcal{S}}}(E^{*})$ such that $\\hat{f}(\\xi)=\\int_{E}e^{i{\\ensuremath{\\langle \\xi , x \\rangle}}}f(x)dx$ for any $\\xi \\in E^{*}$, where $dx$ denotes the Lebesgue measure of $E$. In the case where $E=(T_{a}M/H_{a})\\oplus H_{a}$ the Lebesgue measure actually agrees with the Haar measure of $G$, so ${\\ensuremath{\\mathcal{S}}}(E)$ and ${\\ensuremath{\\mathcal{S}}}(G)$ agree. Furthermore, as $E^{*}=(T_{a}M/H_{a})^{*}\\otimes H_{a}^{*}$ is just the linear dual ${\\ensuremath{\\mathfrak{g}}}^{*}$ of the Lie algebra of $G$, we also see that ${\\ensuremath{\\mathcal{S}}}(E^{*})$ agrees with ${\\ensuremath{\\mathcal{S}}}({\\ensuremath{\\mathfrak{g}}}^{*})$.\n\nLet ${\\ensuremath{\\mathcal{S}}}_{0}(G)$ denote the closed subspace of ${\\ensuremath{\\mathcal{S}}}(G)$ consisting of functions $f \\in {\\ensuremath{\\mathcal{S}}}(G)$ such that for any differential operator $P$ on ${\\ensuremath{\\mathfrak{g}}}^{*}$ we have $(P\\hat{f})(0)=0$. Notice that the image $\\hat{{\\ensuremath{\\mathcal{S}}}}_{0}(G)$ of ${\\ensuremath{\\mathcal{S}}}(G)$ under the Fourier transform consists of functions $v\\in {\\ensuremath{\\mathcal{S}}}({\\ensuremath{\\mathfrak{g}}}^{*})$ such that, given any norm $|.|$ on $G$, near $\\xi=0$ we have $|g(\\xi)|={\\operatorname{O}}(|\\xi|^{N})$ for any $N\\in {\\ensuremath{\\mathbb{N}}}$.\n\nWe endow ${\\ensuremath{\\mathfrak{g}}}^{*}$ with the dilations $\\lambda.\\xi=(\\lambda^{2}\\xi_{0},\\lambda\\xi')$ coming from\u00a0(\\[eq:Heisenberg.Heisenberg-dilations\\]). For $m\\in {\\ensuremath{\\mathbb{C}}}$ we let $S_{m}({\\ensuremath{\\mathfrak{g}}}^{*}M)$ denote the closed subspace of $C^{\\infty}({\\ensuremath{\\mathfrak{g}}}^{*}\\setminus 0)$ consisting in functions $p(\\xi)\\in C^{\\infty}({\\ensuremath{\\mathfrak{g}}}^{*}\\setminus 0)$ such that $p(\\lambda.\\xi)=\\lambda^{m}p(\\xi)$ for any $\\lambda>0$.\n\nIf $p(\\xi)\\in S_{m}({\\ensuremath{\\mathfrak{g}}}^{*})$ then it defines an element of $\\hat{{\\ensuremath{\\mathcal{S}}}}_{0}({\\ensuremath{\\mathfrak{g}}}^{*})'$ by letting $${\\ensuremath{\\langle p , g \\rangle}}= \\int_{{\\ensuremath{\\mathfrak{g}}}^{*}}p(\\xi)g(\\xi)d\\xi, \\qquad g \\in \\hat{{\\ensuremath{\\mathcal{S}}}}_{0}({\\ensuremath{\\mathfrak{g}}}^{*}).$$ This allows us to define the inverse Fourier transform of $p$ as the element $\\check{p}\\in {\\ensuremath{\\mathcal{S}}}_{0}(G)'$ such that ${\\ensuremath{\\langle \\check{p} , f \\rangle}}={\\ensuremath{\\langle p , \\check{f} \\rangle}}$ for any $f \\in {\\ensuremath{\\mathcal{S}}}_{0}(G)$. It then can be shown (see, e.g., [@BG:CHM], [@CGGP:POGD]) that the left-convolution with $p$ defines a continuous endomorphism of ${\\ensuremath{\\mathcal{S}}}_{0}(G)$ via the formula, $${\\operatorname{Op}}(p)f(x)=\\check{p}*f(x)={\\ensuremath{\\langle \\check{p}(y) , f(xy) \\rangle}}, \\qquad f\\in {\\ensuremath{\\mathcal{S}}}_{0}(G).\n     \\label{Heisenberg.left-invariant-PDO}$$ Moreover, we have a bilinear product, $$*:S_{m_{1}}({\\ensuremath{\\mathfrak{g}}}^{*})\\times S_{m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}) \n\\longrightarrow S_{m_{1}+m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}),\n\\label{eq:Heisenberg.product-symbols}$$ in such way that, for any $p_{1}\\in S_{m_{1}}({\\ensuremath{\\mathfrak{g}}}^{*})$ and any $p_{2}\\in S_{m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*})$, we have $${\\operatorname{Op}}(p_{1})\\circ {\\operatorname{Op}}(p_{2})={\\operatorname{Op}}(p_{1}*p_{2}).''$$\n\nIn addition, if $p \\in S_{m}({\\ensuremath{\\mathfrak{g}}}^{*})$ then ${\\operatorname{Op}}(p)$ really is a pseudodifferential operator. Indeed, let $X_{0}(a),\\ldots,X_{d}(a)$ be a (linear) basis of ${\\ensuremath{\\mathfrak{g}}}$ so that $X_{0}(a)$ is in $T_{a}M/H_{a}$ and $X_{1}(a),\\ldots,X_{d}(a)$ span $H_{a}$. For $j=0,\\ldots,d$ let $X_{j}^{a}$ be the left-invariant vector field on $G$ such that $X^{a}_{j|_{x=0}}=X_{j}(a)$. The basis $X_{0}(a),\\ldots,X_{d}(a)$ yields a linear isomorphism ${\\ensuremath{\\mathfrak{g}}}\\simeq {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$, hence a global chart of $G$. In the corresponding local coordinates $p(\\xi)$ is a homogeneous symbol on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\setminus 0$ with respect to the dilations\u00a0(\\[eq:Heisenberg.Heisenberg-dilations-Rd\\]). Similarly, each vector field $\\frac{1}{i}X_{j}^{a}$, $j=0,\\ldots,d$, corresponds to a vector field on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ with symbol $\\sigma_{j}^{a}(x,\\xi)$. If we set $\\sigma^{a}(x,\\xi)=(\\sigma_{0}^{a}(x,\\xi),\\ldots,\\sigma_{d}^{a}(x,\\xi))$, then it can be shown that in these local coordinates we have $${\\operatorname{Op}}(p)f(x)= (2\\pi)^{-(d+1)}\\int_{{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}} e^{i{\\ensuremath{\\langle x , \\xi \\rangle}}}p(\\sigma^{a}(x,\\xi))\\hat{f}(\\xi)d\\xi, \\qquad f \\in {\\ensuremath{\\mathcal{S}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}).\n      \\label{eq:PsiHDO.PsiDO-convolution}$$ In other words ${\\operatorname{Op}}(p)$ is the pseudodifferential operator $p(-iX^{a}):=p(\\sigma^{a}(x,D))$ acting on ${\\ensuremath{\\mathcal{S}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nThe [$\\Psi_{H}$DO]{}\u00a0operators\n------------------------------\n\nThe original idea in the Heisenberg calculus, which goes back to Elias Stein, is to construct a class of operators on a given Heisenberg manifold $(M^{d+1},H)$, called [$\\Psi_{H}$DOs]{}, which at any point $a \\in M$ are modeled in a suitable sense on left-invariant pseudodifferential operators on the tangent group $G_{a}M$.\n\nLet $U \\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of local coordinates equipped with a $H$-frame $X_{0},\\ldots,X_{d}$.\n\n$S_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $m\\in{\\ensuremath{\\mathbb{C}}}$, consists of functions $p(x,\\xi)$ in $C^{\\infty}(U\\times{{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0})$ which are homogeneous of degree $m$ in the $\\xi$-variable with respect to the dilations\u00a0(\\[eq:Heisenberg.Heisenberg-dilations-Rd\\]), i.e., we have $p(x,t.\\xi)=t^m p(x,\\xi)$ for any $t>0$.\n\nIn the sequel we endow ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ with the pseudo-norm, $$\\|\\xi\\|=(\\xi_{0}^{2}+\\xi_{1}^{4}+\\ldots+\\xi_{d}^{4})^{1/4}, \\qquad \\xi\\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}.\n$$ In addition, for any multi-order $\\beta\\in {\\ensuremath{\\mathbb{N}}}^{d+1}_{0}$ we set ${\\ensuremath{\\langle\\! \\beta\\!\\rangle}}=2\\beta_{0}+\\beta_{1}+\\ldots+\\beta_{d}$.\n\n$S^m({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $m\\in{\\ensuremath{\\mathbb{C}}}$, consists of functions $p(x,\\xi)$ in $C^{\\infty}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ with an asymptotic expansion $ p \\sim \\sum_{j\\geq 0} p_{m-j}$, $p_{k}\\in S_{k}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, in the sense that, for any integer $N$, any compact $K \\subset U$ and any multi-orders $\\alpha$, $\\beta$, there exists $C_{NK\\alpha\\beta}>0$ such that, for any $x\\in K$ and any $\\xi\\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ so that $\\|\\xi \\| \\geq 1$, we have $$| \\partial^\\alpha_{x}\\partial^\\beta_{\\xi}(p-\\sum_{j<N}p_{m-j})(x,\\xi)| \\leq \n    C_{NK\\alpha\\beta }\\|\\xi\\|^{\\Re m-{\\ensuremath{\\langle\\! \\beta\\!\\rangle}} -N}.\n    \\label{eq:Heisenberg.asymptotic-expansion-symbols}$$\n\nNext, for $j=0,\\ldots,d$ let $\\sigma_{j}(x,\\xi)$ denote the symbol (in the classical sense) of the vector field $\\frac{1}{i}X_{j}$ and set $\\sigma=(\\sigma_{0},\\ldots,\\sigma_{d})$. Then for $p \\in S^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ we let $p(x,-iX)$ be the continuous linear operator from $C^{\\infty}_{c}(U)$ to $C^{\\infty}(U)$ such that $$p(x,-iX)f(x)= (2\\pi)^{-(d+1)} \\int e^{ix.\\xi} p(x,\\sigma(x,\\xi))\\hat{f}(\\xi)d\\xi,\n    \\qquad f\\in C^{\\infty}_{c}(U).$$\n\nIn the sequel we let ${\\ensuremath{\\Psi^{-\\infty}}}(U)$ denote the space of smoothing operators on $U$, that is, the space of continuous operators $P:{\\ensuremath{\\mathcal{E}}}'(U)\\rightarrow {\\ensuremath{\\mathcal{D}}}'(U)$ with a smooth Schwartz kernel.\n\n${\\ensuremath{\\Psi_{H}}}^{m}(U)$, $m\\in {\\ensuremath{\\mathbb{C}}}$, consists of operators $P:C^{\\infty}_{c}(U)\\rightarrow C^{\\infty}(U)$ of the form $$P= p(x,-iX)+R, \n$$ with $p$ in $S^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ (called the symbol of $P$) and $R$ smoothing operator.\n\nThe class of [$\\Psi_{H}$DOs]{}\u00a0is invariant under changes of $H$-framed charts (see\u00a0[@BG:CHM Sect.\u00a016], [@Po:MAMS1 Appendix A]). Therefore, we can extend the definition of [$\\Psi_{H}$DOs]{}\u00a0to the Heisenberg manifold $(M^{d+1},H)$ and let them act on sections of a vector bundle ${\\ensuremath{\\mathcal{E}}}^{r}$ over $M$ as follows.\n\n${\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $m\\in {\\ensuremath{\\mathbb{C}}}$, consists of continuous operators $P$ from $C^{\\infty}_{c}(M,{\\ensuremath{\\mathcal{E}}})$ to $C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ such that:\n\n\\(i) The Schwartz kernel of $P$ is smooth off the diagonal;\n\n\\(ii) For any $H$-framed local chart $\\kappa:U\\rightarrow V\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ over which there is a trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|U}\\rightarrow U\\times \n  {\\ensuremath{\\mathbb{C}}}^{r}$ the operator $\\kappa_{*}\\tau_{*}(P_{|U})$ belongs to ${\\ensuremath{\\Psi_{H}}}^{m}(V,{\\ensuremath{\\mathbb{C}}}^{r}):={\\ensuremath{\\Psi_{H}}}^{m}(V)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathbb{C}}}^{r}$.\n\nLet $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $m \\in {\\ensuremath{\\mathbb{C}}}$.\n\n\\(1) Let $Q\\in {\\ensuremath{\\Psi_{H}}}^{m'}(M,{\\ensuremath{\\mathcal{E}}})$, $m'\\in {\\ensuremath{\\mathbb{C}}}$, and suppose that $P$ or $Q$ is uniformly properly supported. Then the operator $PQ$ belongs to ${\\ensuremath{\\Psi_{H}}}^{m+m'}(M,{\\ensuremath{\\mathcal{E}}})$.\n\n\\(2) The transpose operator $P^{t}$ belongs to ${\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}}^{*})$.\n\n\\(3) Suppose that $M$ is endowed with a density\u00a0$>0$ and ${\\ensuremath{\\mathcal{E}}}$ is endowed with a Hermitian metric. Then the adjoint $P^{*}$ of $P$ belongs to ${\\ensuremath{\\Psi_{H}}}^{\\overline{m}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\nIn this setting the principal symbol of a [$\\Psi_{H}$DO]{}\u00a0can be defined intrinsically as follows.\n\nLet ${\\ensuremath{\\mathfrak{g}}}^{*}M=(TM/H)^{*}\\oplus H^{*}$ denote the (linear) dual of the Lie algebra bundle ${\\ensuremath{\\mathfrak{g}}}M$ of $GM$ with canonical projection $\\text{pr}: M\\rightarrow {\\ensuremath{\\mathfrak{g}}}^{*}M$. For $m \\in {\\ensuremath{\\mathbb{C}}}$ we let $S_{m}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}})$ be the space of sections $p\\in C^{\\infty}({\\ensuremath{\\mathfrak{g}}}^{*}M\\setminus 0,{\\ensuremath{{\\operatorname{End}}}}\\text{pr}^{*}{\\ensuremath{\\mathcal{E}}})$ such that $p(x,t.\\xi)=t^{m}p(x,\\xi)$ for any $t>0$.\n\n\\[def:Heisenberg.principal-symbol\\] The principal symbol of an operator $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ is the unique symbol $\\sigma_{m}(P)$ in $S_{m}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}})$ such that, for any $a\\in M$ and for any trivializing $H$-framed local coordinates near $a$, in Heisenberg coordinates centered at $a$ we have $\\sigma_{m}(P)(0,\\xi)=p_{m}(0,\\xi)$, where $p_{m}(x,\\xi)$ is the principal symbol of $P$ in the sense of\u00a0(\\[eq:Heisenberg.asymptotic-expansion-symbols\\]).\n\nGiven a point $a\\in M$ the principal symbol $\\sigma_{m}(P)$ allows us to define the model operator of $P$ at $a$ as the left-invariant [$\\Psi$DO]{}\u00a0on ${\\ensuremath{\\mathcal{S}}}_{0}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}}_{a})$ with symbol $p_{m}^{a}(\\xi):=\\sigma_{m}(P)(a,\\xi)$ so that, in the notation of\u00a0(\\[Heisenberg.left-invariant-PDO\\]), the operator $P^{a}$ is just ${\\operatorname{Op}}(p_{m}^{a})$.\n\nFor $m \\in {\\ensuremath{\\mathbb{C}}}$ let $S_{m}({\\ensuremath{\\mathfrak{g}}}^{*}_{a}M,{\\ensuremath{\\mathcal{E}}}_{a})$ be the space of functions $p\\in C^{\\infty}({\\ensuremath{\\mathfrak{g}}}^{*}_{a}M\\setminus 0,{\\ensuremath{\\mathcal{E}}}_{a})$ which are homogeneous of degree $m$. Then the product\u00a0(\\[eq:Heisenberg.product-symbols\\]) yields a bilinear product, $$*^{a}:S_{m_{1}}({\\ensuremath{\\mathfrak{g}}}^{*}_{a}M,{\\ensuremath{\\mathcal{E}}}_{a})\\times S_{m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}_{a}M,{\\ensuremath{\\mathcal{E}}}_{a})\\rightarrow S_{m_{1}+m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}_{a}M,{\\ensuremath{\\mathcal{E}}}_{a}).\n$$ This product depends smoothly on $a$ as much so to gives rise to the bilinear product, $$\\begin{gathered}\n    *:S_{m_{1}}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}})\\times S_{m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}}) \\longrightarrow S_{m_{1}+m_{2}}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}}),\n    \\label{eq:CPCL.product-symbols}\\\\\n    p_{m_{1}}*p_{m_{2}}(a,\\xi)=(p_{m_{1}}(a,.)*^{a}p_{m_{2}}(a,.))(\\xi), \\qquad p_{m_{j}}\\in S_{m_{j}}({\\ensuremath{\\mathfrak{g}}}^{*}M).\n    $$\n\n\\[prop:Heisenberg.operations-principal-symbols\\] Let $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $m \\in {\\ensuremath{\\mathbb{C}}}$.\n\n1\\) Let $Q\\in {\\ensuremath{\\Psi_{H}}}^{m'}(M,{\\ensuremath{\\mathcal{E}}})$, $m'\\in {\\ensuremath{\\mathbb{C}}}$, and suppose that $P$ or $Q$ is uniformly properly supported. Then we have $\\sigma_{m+m'}(PQ)=\\sigma_{m}(P)*\\sigma_{m'}(Q)$, and for any $a \\in M$ the model operator of $PQ$ at $a$ is $P^{a}Q^{a}$.\n\n2\\) We have $\\sigma_{m}(P^{t})(x,\\xi)=\\sigma_{m}(P)(x,-\\xi)^{t}$, and for any $a \\in M$ the model operator of $P^{t}$ at $a$ is $(P^{a})^{t}$.\n\n3\\) Suppose that $M$ is endowed with a density\u00a0$>0$ and ${\\ensuremath{\\mathcal{E}}}$ is endowed with a Hermitian metric. Then we have $\\sigma_{\\overline{m}}(P^{*})(x,\\xi)=\\sigma_{m}(P)(x,\\xi)^{*}$, and for any $a \\in M$ the model operator of $P^{*}$ at $a$ is $(P^{a})^{*}$.\n\nIn addition, there is a complete symbolic calculus for [$\\Psi_{H}$DOs]{}\u00a0which allows us to carry out the classical parametrix construction for an operator $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ whenever its principal symbol $\\sigma_{m}(P)$ is invertible with respect to the product $*$ (see\u00a0[@BG:CHM]). In general, it may be difficult to determine whether $\\sigma_{m}(P)$ is invertible with respect to that product. Nevertheless, given a point $a\\in M$ we have an invertibility criterion for $P^{a}$ in terms of the representation theory of $G_{a}M$; this is the so-called Rockland condition (see, e.g., [@Ro:HHGRTC], [@CGGP:POGD]). We then can completely determine the invertibility of the principal symbol of $P$ in terms of the Rockland conditions for its model operators and those of its transpose (see\u00a0[@Po:MAMS1 Thm.\u00a03.3.19]).\n\nFinally, the [$\\Psi_{H}$DOs]{}\u00a0enjoy nice Sobolev regularity properties. These properties are best stated in terms of the weighted Sobolev of\u00a0[@FS:EDdbarbCAHG] and\u00a0[@Po:MAMS1]. These weighted Sobolev spaces can be explicitly related to the usual Sobolev spaces and allows us to show that if $P\\in \n{\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $\\Re m>0$, has an invertible principal symbol, then $P$ is maximal hypoelliptic, which implies that $P$ is hypoelliptic with gain of $\\frac{m}{2}$-derivatives. We refer to\u00a0[@BG:CHM] and\u00a0[@Po:MAMS1] for the precise statements. In the sequel we will only need the following.\n\n\\[prop:Heisenberg.L2-boundedness\\] Assume $M$ compact and let $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $\\Re m\\geq 0$. Then $P$ extends to a bounded operator from $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ to itself and this operator is compact if we further have $\\Re m<0$.\n\nHolomorphic families of [$\\Psi_{H}$DOs]{}\n-----------------------------------------\n\nIn this subsection we recall the main definitions and properties of holomorphic families of [$\\Psi_{H}$DOs]{}. Throughout the subsection we let $(M^{d+1},H)$ be a Heisenberg manifold, we let ${\\ensuremath{\\mathcal{E}}}^{r}$ be a vector bundle over $M$ and we let $\\Omega$ be an open subset of ${\\ensuremath{\\mathbb{C}}}$.\n\nLet $U\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of local coordinates equipped with a $H$-frame $X_{0},\\ldots,X_{d}$. We define holomorphic families of symbols on ${U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}$ as follows.\n\n\\[def:Heisenberg.hol-family-symbols\\] A family $(p(z))_{z\\in\\Omega}\\subset S^*({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ is holomorphic when:\n\n\\(i) The order $w(z)$ of $p(z)$ depends analytically on $z$;\n\n\\(ii) For any $(x,\\xi)\\in {U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}$ the function $z\\rightarrow p(z)(x,\\xi)$ is holomorphic on $\\Omega$;\n\n\\(iii) The bounds of the asymptotic expansion\u00a0(\\[eq:Heisenberg.asymptotic-expansion-symbols\\]) for $p(z)$ are locally uniform with respect to $z$, i.e., we have $p(z) \\sim \\sum_{j\\geq 0} p(z)_{ w(z)-j}$, $p(z)_{w(z)-j}\\in S_{w(z)-j}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, and, for any integer $N$, any compacts $K\\subset U$ and $L\\subset \\Omega$ and any multi-orders $\\alpha$ and $\\beta$, there exists a constant $ C_{NKL\\alpha\\beta}>0$ such that, for any $(x,z)\\in K\\times L$ and any $\\xi \\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ so that $\\|\\xi\\|\\geq  1$, we have $$| \\partial_{x}^\\alpha\\partial_{\\xi}^\\beta (p(z)-\\sum_{j<N}  \n            p(z)_{w(z)-j})(x,\\xi)| \\leq C_{NKL\\alpha\\beta} \\|\\xi\\|^{\\Re w(z)-N-{\\ensuremath{\\langle\\! \\beta\\!\\rangle}}}.\n    \\label{eq:Heisenberg.symbols.asymptotic-expansion-hol-families}$$\n\nIn the sequel we let ${{\\operatorname{Hol}}}(\\Omega,S^*({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}))$ denote the class of holomorphic families with values in $S^*({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$. Notice also that the properties (i)\u2013(iii) imply that each homogeneous symbol $p(z)_{w(z)-j}(x,\\xi)$ depends analytically on $z$, that is, it gives rise to a holomorphic family with values in $C^{\\infty}({U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)})$ (see\u00a0[@Po:MAMS1 Rem.\u00a04.2.2]).\n\nSince ${\\ensuremath{\\Psi^{-\\infty}}}(U)={\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{E}}}'(U),C^{\\infty}(U))$ is a Fr\u00e9chet space which is isomorphic to $C^{\\infty}(U\\times U)$ by Schwartz\u2019s Kernel Theorem, we can define holomorphic families of smoothing operators as families of operators given by holomorphic families of smooth Schwartz kernels. We let ${{\\operatorname{Hol}}}(\\Omega,{\\ensuremath{\\Psi^{-\\infty}}}(U))$ denote the class of such families.\n\n\\[def:Heisenberg.hol-family-PsiHDO\u2019s\\] A family $(P(z))_{z\\in \\Omega}\\subset {\\ensuremath{\\Psi_{H}}}^{m}(U)$ is holomorphic when it can be put in the form, $$P(z) = p(z)(x,-iX) + R(z),  \\qquad z \\in \\Omega, \n$$ with $(p(z))_{z\\in \\Omega}\\in {{\\operatorname{Hol}}}(\\Omega, S^{*}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}))$ and $(R(z))_{z\\in \\Omega} \\in {{\\operatorname{Hol}}}(\\Omega,{\\ensuremath{\\Psi^{-\\infty}}}(U))$.\n\nThe above notion of holomorphic families of [$\\Psi_{H}$DOs]{}\u00a0is invariant under changes of $H$-framed charts (see\u00a0[@Po:MAMS1]). Therefore, it makes sense to define holomorphic families of [$\\Psi_{H}$DOs]{}\u00a0on the Heisenberg manifold $(M^{d+1},H)$ acting on sections of the vector bundle ${\\ensuremath{\\mathcal{E}}}^{r}$ as follows.\n\nA family $(P(z))_{z\\in \\Omega}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ is holomorphic when:\n\n\\(i) The order $w(z)$ of $P(z)$ is a holomorphic function of $z$;\n\n\\(ii) For $\\varphi$ and $\\psi$ in $C^\\infty_{c}(M)$ with disjoint supports $(\\varphi P(z)\\psi)_{z\\in \\Omega}$ is a holomorphic family of smoothing operators; (iii) For any trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|_{U}}\\rightarrow U\\times {\\ensuremath{\\mathbb{C}}}^{r}$ over a local $H$-framed chart $\\kappa:U \\rightarrow V\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ the family $(\\kappa_{*}\\tau_{*}(P_{z|_{U}}))_{z\\in\\Omega}$ belongs to ${{\\operatorname{Hol}}}(\\Omega, {\\ensuremath{\\Psi_{H}}}^{*}(V,{\\ensuremath{\\mathbb{C}}}^{r})):={{\\operatorname{Hol}}}(\\Omega, {\\ensuremath{\\Psi_{H}}}^{*}(V))\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathbb{C}}}^{r}$.\n\nWe let ${{\\operatorname{Hol}}}(\\Omega,{\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}}))$ denote the class of holomorphic families of [$\\Psi_{H}$DOs]{}\u00a0on $M$ and acting on the sections of ${\\ensuremath{\\mathcal{E}}}$.\n\nLet $(P(z))_{z\\in\\Omega}\\subset  {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic family of [$\\Psi_{H}$DOs]{}.\n\n1\\) Let $(Q(z))_{z\\in\\Omega}\\subset  {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic family of [$\\Psi_{H}$DOs]{}\u00a0and assume that $(P(z))_{z\\in\\Omega}$ or $(Q(z))_{z\\in\\Omega}$ is uniformly properly supported with respect to $z$. Then the family $(P(z)Q(z))_{z \\in \\Omega}$ belongs to ${{\\operatorname{Hol}}}(\\Omega,{\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}}))$. 2) Let $\\phi:(M,H)\\rightarrow (M',H')$ be a Heisenberg diffeomorphism. Then the family $(\\phi_{*}P(z))_{z\\in \\Omega}$ belongs to ${{\\operatorname{Hol}}}(\\Omega, \\Psi_{H'}^{*}(M',\\phi_{*}{\\ensuremath{\\mathcal{E}}}))$.\n\nComplex powers of hypoelliptic [$\\Psi_{H}$DOs]{}\n------------------------------------------------\n\nIn this subsection we recall the constructions in\u00a0[@Po:MAMS1] and\u00a0[@Po:CPDE1] of complex powers of hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0as holomorphic families of [$\\Psi_{H}$DOs]{}.\n\nThroughout this subsection we let $(M^{d+1},H)$ be a compact Heisenberg manifold equipped with a density\u00a0$>0$ and we let ${\\ensuremath{\\mathcal{E}}}$ be a Hermitian vector bundle over $M$.\n\nLet $P:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a differential operator of Heisenberg order $m$ which is positive, i.e., we have ${\\ensuremath{\\langle Pu , u \\rangle}}\\geq \n0$ for any $u \\in C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$, and assume that the principal symbol of $P$ is invertible, that is, $P$ satisfies the Rockland condition at every point.\n\nBy standard functional calculus for any $s\\in {\\ensuremath{\\mathbb{C}}}$ we can define the power $P^{s}$ as an unbounded operator on $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ whose domain contains $C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$. In particular $P^{-1}$ is the partial inverse of $P$ and we have $P^{0}=1-\\Pi_{0}(P)$, where $\\Pi_{0}(P)$ denotes the orthogonal projection onto the kernel of $P$. Furthermore, we have:\n\n\\[prop:Heisenberg.complex-powers.positive\\] Assume that $H$ satisfies the bracket condition $H+[H,H]=TM$. Then the complex powers $(P^{s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ form a holomorphic 1-parameter group of [$\\Psi_{H}$DOs]{}\u00a0such that ${{{\\operatorname{ord}}}}P^{s}=ms\\  \\forall s\\in {\\ensuremath{\\mathbb{C}}}$.\n\nThis construction has been generalized to more general hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0in\u00a0[@Po:CPDE1]. Let $P:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a [$\\Psi_{H}$DO]{}\u00a0of order $m>0$. In\u00a0[@Po:CPDE1] there is a notion of *principal cut* for the principal symbol $\\sigma_{m}(P)$ of $P$ as a ray $L\\subset {\\ensuremath{\\mathbb{C}}}\\setminus 0$ such that $P-\\lambda$ admits a parametrix in a version of the Heisenberg calculus with parameter in a conical neighborhood $\\Theta \\subset {\\ensuremath{\\mathbb{C}}}\\setminus 0$ of $L$.\n\nLet $\\Theta(P)$ be the union set of all principal cuts of $\\sigma_{m}(P)$. Then $\\Theta(P)$ is an open conical subset of ${\\ensuremath{\\mathbb{C}}}\\setminus 0$ and for any conical subset $\\Theta$ of $\\Theta(P)$ such that $\\overline{\\Theta}\\setminus 0\\subset \\Theta(P)$ there are at most finitely many eigenvalues of $P$ in $\\Theta$ (see\u00a0[@Po:CPDE1]).\n\nLet $L_{\\theta}=\\{\\arg \\lambda=\\theta\\}$, $0\\leq \\theta<2\\pi$, be a principal cut for $\\sigma_{m}(P)$ such that no eigenvalue of $P$ lies in $L$. Then $L_{\\theta}$ is ray of minimal growth for $P$, so for $\\Re s<0$ we define a bounded operator on $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ by letting $$\\begin{gathered}\n   P_{\\theta}^{s}= \\frac{-1}{2i\\pi} \\int_{\\Gamma_{\\theta}} \\lambda^{s}_{\\theta}(P-\\lambda)^{-1}d\\lambda,\n     \\label{eq:Heisenberg.complex-powers-definition}\\\\\n\\Gamma_{\\theta}=\\{ \\rho e^{i\\theta}; \\infty <\\rho\\leq r\\}\\cup\\{ r e^{it}; \n\\theta\\geq t\\geq \\theta-2\\pi \\}\\cup\\{ \\rho e^{i(\\theta-2\\pi)};  r\\leq \\rho\\leq \\infty\\},  \n\\label{eq:Heisenberg.complex-powers-definition-Gammat}\\end{gathered}$$ where $r>0$ is such that no nonzero eigenvalue of $P$ lies in the disc $|\\lambda|<r$.\n\n\\[prop:Heisenberg.powers2\\] The family\u00a0(\\[eq:Heisenberg.complex-powers-definition\\]) gives rise to a unique holomorphic family $(P_{\\theta}^{s})_{s\\in {\\ensuremath{\\mathbb{C}}}}$ of [$\\Psi_{H}$DOs]{}\u00a0such that:\n\n\\(i) We have ${{{\\operatorname{ord}}}}P_{\\theta}^{s}=ms$ for any $s \\in {\\ensuremath{\\mathbb{C}}}$;\n\n\\(ii) We have the 1-parameter group property $P_{\\theta}^{s_{1}+s_{2}}=P_{\\theta}^{s_{1}} P_{\\theta}^{s_{2}}$ $\\forall s_{j}\\in {\\ensuremath{\\mathbb{C}}}$;\n\n\\(iii) We have $P_{\\theta}^{k+s}=P^{k} P_{\\theta}^{s}$ for any $k\\in {\\ensuremath{\\mathbb{N}}}$ and any $s \\in {\\ensuremath{\\mathbb{C}}}$.\n\nLet $E_{0}(P)=\\cup_{j \\geq 0} \\ker P^{j}$ be the characteristic subspace of $P$ associated to $\\lambda=0$. This is a finite dimensional subspace of $C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ and so the projection $\\Pi_{0}(P)$ onto $E_{0}(P)$ and along $E_{0}(P^{*})^{\\perp}$ is a smoothing operator (see\u00a0[@Po:CPDE1]). Then we have: $$P_{\\theta}^{0}=1-\\Pi_{0}(P), \\qquad P_{\\theta}^{-k}=P^{-k}, \\quad k=1,2,\\ldots, \n     \\label{eq:PsiDO.complex-powers-integers}$$ where $P^{-k}$ denotes the partial inverse of $P^{k}$, i.e., the operator that inverts $P^{k}$ on $E_{0}(P^{*})^{\\perp}$ and is zero on $E_{0}(P)$.\n\nAssume further that $0$ is not in the spectrum of $P$. Let $Q\\in {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ and for $z \\in {\\ensuremath{\\mathbb{C}}}$ set $Q(z)=QP_{\\theta}^{z/m}$. Then $(Q(z))_{z \\in {\\ensuremath{\\mathbb{C}}}}$ is a holomorphic family of [$\\Psi_{H}$DOs]{}\u00a0such that $Q_{0}=Q$ and ${{{\\operatorname{ord}}}}Q(z)=z+{{{\\operatorname{ord}}}}Q$. Following the terminology of\u00a0[@Gu:GLD] a holomorphic family of [$\\Psi_{H}$DOs]{}\u00a0with these properties is called a *holomorphic gauging* for $Q$.\n\nNoncommutative residue trace for the Heisenberg calculus {#sec:NCR}\n========================================================\n\nIn this section we construct a noncommutative residue trace for the algebra of integer order [$\\Psi_{H}$DOs]{}\u00a0on a Heisenberg manifold. We start by describing the logarithmic singularity near the diagonal of the Schwartz kernel of a [$\\Psi_{H}$DO]{}\u00a0of integer order and we show that it gives rise to a well-defined density. We then construct the noncommutative residue for the Heisenberg calculus as the residual trace induced by the analytic continuation of the usual trace to [$\\Psi_{H}$DOs]{}\u00a0of non-integer orders. Moreover, we show that it agrees with the integral of the density defined by the logarithmic singularity of the Schwartz kernel of the corresponding [$\\Psi_{H}$DO]{}. Finally, we prove that when the manifold is connected then every other trace on the algebra of integer order [$\\Psi_{H}$DOs]{}\u00a0is a constant multiple of our noncommutative residue. This is the analogue of a well-known result of Wodzicki and Guillemin.\n\nLogarithmic singularity of the kernel of a [$\\Psi_{H}$DO]{}\n-----------------------------------------------------------\n\nIn this subsection we show that the logarithmic singularity of the Schwartz kernel of any integer order [$\\Psi_{H}$DO]{}\u00a0 gives rise to a density which makes sense intrinsically. This uses the characterization of [$\\Psi_{H}$DOs]{}\u00a0in terms of their Schwartz kernels, which we shall now recall.\n\nFirst, we extend the notion of homogeneity of functions to distributions. For $K$ in ${\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and for $\\lambda >0$ we let $K_{\\lambda}$ denote the element of ${\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $${\\ensuremath{\\langle K_{\\lambda} , f \\rangle}}=\\lambda^{-(d+2)} {\\ensuremath{\\langle K(x) , f(\\lambda^{-1}.x) \\rangle}} \\quad \\forall f\\in{\\ensuremath{\\mathcal{S}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}). \n            \\label{eq:PsiHDO.homogeneity-K-m}$$ It will be convenient to also use the notation $K(\\lambda.x)$ for denoting $K_{\\lambda}(x)$. We say that $K$ is homogeneous of degree $m$, $m\\in{\\ensuremath{\\mathbb{C}}}$, when $K_{\\lambda}=\\lambda^m K$ for any $\\lambda>0$.\n\nIn the sequel we let $E$ be the anisotropic radial vector field $2x_{0}\\partial_{x_{0}}+\\partial_{x_{1}}+\\ldots+\\partial_{x_{d}}$, i.e., $E$ is the infinitesimal generator of the flow $\\phi_{s}(\\xi)=e^{s}.\\xi$.\n\n\\[lem:Heisenberg.extension-symbol\\] Let $p(\\xi) \\in S_{m}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, $m \\in {\\ensuremath{\\mathbb{C}}}$.\n\n1\\) If $m$ is not an integer\u00a0$\\leq -(d+2)$, then $p(\\xi)$ can be uniquely extended into a homogeneous distribution $\\tau \\in {\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\n2\\) If $m$ is an integer $\\leq -(d+2)$, then at best we can extend $p(\\xi)$ into a distribution $\\tau \\in {\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $$\\tau_{\\lambda}=\\lambda^{m}\\tau +\\lambda^{m}\\log \\lambda\\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=-(m+d+2)} c_{\\alpha}(p)\\delta^{(\\alpha)} \\quad \\text{for any $\\lambda \n       >0$},\n     \\label{eq:NCR.log-homogeneity}$$ where we have let $c_{\\alpha}(p) = \\frac{(-1)^{|\\alpha|}}{\\alpha!}\\int_{\\|\\xi\\|=1}\\xi^\\alpha p(\\xi)i_{E}d\\xi$. In particular, $p(\\xi)$ admits a homogeneous extension if and only if all the coefficients $c_{\\alpha}(p)$ vanish.\n\nFor reader\u2019s convenience a detailed proof of this lemma is given in Appendix.\n\nLet $\\tau\\in {\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and let $\\lambda>0$. Then for any $f \\in {\\ensuremath{\\mathcal{S}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ we have $${\\ensuremath{\\langle (\\check{\\tau})_{\\lambda} , f \\rangle}}= \\lambda^{-(d+2)}{\\ensuremath{\\langle \\tau , (f_{\\lambda^{-1}})^{\\vee} \\rangle}}= \n   {\\ensuremath{\\langle \\tau , (\\check{f})_{\\lambda} \\rangle}}= \\lambda^{-(d+2)}{\\ensuremath{\\langle (\\tau_{\\lambda^{-1}})^{\\vee} , f \\rangle}}.\n    \\label{eq:NCR.Fourier-transform-scaling}$$ Hence $(\\check{\\tau})_{\\lambda} = \\lambda^{-(d+2)}(\\tau_{\\lambda^{-1}})^{\\vee}$. Therefore, if we set $\\hat{m}=-(m+d+2)$ then we see that:\n\n- $\\tau$ is homogeneous of degree $m$ if and only if $\\check{\\tau}$ is homogeneous of degree $\\hat{m}$;\n\n- $\\tau$ satisfies\u00a0(\\[eq:NCR.log-homogeneity\\]) if and only if for any $\\lambda>0$ we have $$\\check{\\tau}(\\lambda.y)= \\lambda^{\\hat{m}} \\check{\\tau}(y) - \\lambda^{\\hat{m}}\\log \\lambda \n    \\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}} =\\hat{m}} (2\\pi)^{-(d+1)}c_{\\alpha}(p) (-iy)^{\\alpha} .\n     \\label{eq:NCR.log-homogeneity-kernel}$$\n\nLet $U\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of local coordinates equipped with a $H$-frame $X_{0},\\ldots,X_{d}$. In the sequel we set ${\\ensuremath{\\mathbb{N}}}_{0}={\\ensuremath{\\mathbb{N}}}\\cup\\{0\\}$ and we let ${\\ensuremath{\\mathcal{S}}}'_{{{\\text{reg}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be the space of tempered distributions on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ which are smooth outside the origin. We endow ${\\ensuremath{\\mathcal{S}}}'_{{{\\text{reg}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ with the weakest locally convex topology that makes continuous the embeddings of ${\\ensuremath{\\mathcal{S}}}'_{{{\\text{reg}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ into ${\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and $C^{\\infty}({{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0})$. In addition, recall also that if $E$ is a topological vector space contained in ${\\ensuremath{\\mathcal{D}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ then $C^{\\infty}(U){\\hat\\otimes}E$ can be identified as the space $C^{\\infty}(U,E)$ seen as a subspace of ${\\ensuremath{\\mathcal{D}}}'({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$.\n\nThe discussion above about the homogeneity of the (inverse) Fourier transform leads us to consider the classes of distributions below.\n\n${\\ensuremath{\\mathcal{K}}}_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $m\\in{\\ensuremath{\\mathbb{C}}}$, consists of distributions $K(x,y)$ in $C^\\infty(U){\\hat\\otimes}{\\ensuremath{\\mathcal{S}}}'_{{{\\text{reg}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that, for any $\\lambda>0$, we have: $$K(x,\\lambda y)= \\left\\{\n      \\begin{array}{ll}\n          \\lambda^m K(x,y) & \\text{if $m\\not \\in {\\ensuremath{\\mathbb{N}}}_{0}$},  \\\\\n          \\lambda^m K(x,y) + \\lambda^m\\log\\lambda\n                    \\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=m}c_{K,\\alpha}(x)y^\\alpha & \\text{if $m\\in {\\ensuremath{\\mathbb{N}}}_{0}$},\n      \\end{array}\\right.\n    \\label{eq:NCR.log-homogeneity-Km}$$ where the functions $c_{K,\\alpha}(x)$, ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=m$, are in $C^{\\infty}(U)$ when $m\\in {\\ensuremath{\\mathbb{N}}}_{0}$.\n\n\\[rem:NCR.regularity-cKm1\\] For $\\Re m>0$ we have $K_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})\\subset C^{\\infty}(U){\\hat\\otimes}C^{[\\frac{\\Re m}{2}]'}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, where $[\\frac{\\Re m}{2}]'$ denotes the greatest integer\u00a0$< \\Re m$ (see\u00a0[@Po:MAMS1 Lemma\u00a0A.1]).\n\n${\\ensuremath{\\mathcal{K}}}^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $m\\in {\\ensuremath{\\mathbb{C}}}$, consists of distributions $K(x,y)$ in ${\\ensuremath{\\mathcal{D}}}'({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ with an asymptotic expansion $K\\sim \\sum_{j\\geq0}K_{m+j}$, $K_{l}\\in {\\ensuremath{\\mathcal{K}}}_{l}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, in the sense that, for any integer $N$, as soon as $J$ is large enough $K-\\sum_{j\\leq J}K_{m+j}$ is in $C^{N}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$.\n\n\\[rem:NCR.regularity-cKm2\\] The definition implies that any distribution $K\\in{\\ensuremath{\\mathcal{K}}}^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ is smooth on ${U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)}$. Furthermore, using Remark\u00a0\\[rem:NCR.regularity-cKm1\\] we see that for $\\Re m>0$ we have ${\\ensuremath{\\mathcal{K}}}^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})\\subset C^{\\infty}(U){\\hat\\otimes}C^{[\\frac{\\Re m}{2}]'}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nUsing Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\] we can characterize homogeneous symbols on ${U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}$ as follows.\n\n\\[lem:NCR.extension-symbolU\\] Let $m \\in {\\ensuremath{\\mathbb{C}}}$ and set $\\hat{m}=-(m+d+2)$.\n\n1\\) If $p(x,\\xi)\\in S_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ then $p(x,\\xi)$ can be extended into a distribution $\\tau(x,\\xi)\\in C^{\\infty}(U){\\hat\\otimes}{\\ensuremath{\\mathcal{S}}}_{{{\\text{reg}}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $K(x,y):=\\check{\\tau}_{{{\\xi\\rightarrow y}}}(x,y)$ belongs to ${\\ensuremath{\\mathcal{K}}}_{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$. Furthermore, if $m$ is an integer\u00a0$\\leq -(d+2)$ then, using the notation of\u00a0(\\[eq:NCR.log-homogeneity-Km\\]), we have $c_{K,\\alpha}(x)= (2\\pi)^{-(d+1)}\\int_{\\|\\xi\\|=1}\\frac{(i\\xi)^{\\alpha}}{\\alpha!}p(x,\\xi)\\iota_{E}d\\xi$.\n\n2\\) If $K(x,y)\\in {\\ensuremath{\\mathcal{K}}}_{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ then the restriction of $\\hat{K}_{{{y\\rightarrow\\xi}}}(x,\\xi)$ to ${U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)}$ is a symbol in $S_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$.\n\nNext, for any $x \\in U$ we let $\\psi_{x}$ (resp.\u00a0$\\varepsilon_{x}$) denote the change of variable to the privileged (resp.\u00a0Heisenberg) coordinates centered at $x$ (cf.\u00a0Definitions\u00a0\\[def:Heisenberg-privileged-coordinates\\] and\u00a0\\[def:Heisenberg-Heisenberg-coordinates\\]).\n\nLet $p \\in S_{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ and let $k(x,y)\\in C^{\\infty}(U){\\hat\\otimes}{\\ensuremath{\\mathcal{D}}}'(U)$ denote the Schwartz kernel of $p(x,-iX)$, so that $[p(x,-iX)u](x)={\\ensuremath{\\langle k(x,y) , u(y) \\rangle}}$ for any $u\\in C^{\\infty}_{c}(U)$. Then one can check (see, e.g., [@Po:MAMS1 p.\u00a054]) that we have: $$k(x,y)=|\\psi_{x}'| \\check{p}_{{{\\xi\\rightarrow y}}}(x,-\\psi_{x}(y))=|\\varepsilon_{x}'|\\check{p}_{{{\\xi\\rightarrow y}}}(x,\\phi_{x}(-\\varepsilon_{x}(y))).\n    \\label{eq:Heisenberg.kernel-quantization-symbol-psiy}$$ Combining this with Lemma\u00a0\\[lem:NCR.extension-symbolU\\] leads us to the characterization of [$\\Psi_{H}$DOs]{}\u00a0below.\n\n\\[prop:PsiVDO.characterisation-kernel1\\] Consider a continuous operator $P:C_{c}^\\infty(U)\\rightarrow C^\\infty(U)$ with Schwartz kernel $k_{P}(x,y)$. Let $m \\in \n {\\ensuremath{\\mathbb{C}}}$ and set $\\hat{m}=-(m+d+2)$. Then the following are equivalent:\n\n\\(i) $P$ is a [$\\Psi_{H}$DO]{}\u00a0of order $m$.\n\n\\(ii) We can put $k_{P}(x,y)$ in the form, $$k_{P}(x,y)=|\\psi_{x}'|K(x,-\\psi_{x}(y)) +R(x,y) ,\n      \\label{eq:PsiHDO.characterization-kernel.privileged}$$ for some $K\\in{\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $K\\sim \\sum K_{\\hat{m}+j}$, and some $R \\in C^{\\infty}(U\\times U)$.\n\n\\(iii) We can put $k_{P}(x,y)$ in the form, $$k_{P}(x,y)=|\\varepsilon_{x}'|K_{P}(x,-\\varepsilon_{x}(y)) +R_{P}(x,y) ,\n      \\label{eq:PsiHDO.characterization-kernel.Heisenberg}$$ for some $K_{P}\\in {\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $K_{P}\\sim \\sum K_{P,\\hat{m}+j}$, and some $R_{P} \\in C^{\\infty}(U\\times U)$.\n\nFurthermore, if (i)\u2013(iii) hold then we have $K_{P,l}(x,y)=K_{l}(x,\\phi_{x}(y))$ and $P$ has symbol $p\\sim \\sum_{j\\geq 0} p_{m-j}$, where $p_{m-j}(x,\\xi)$ is the restriction to ${U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)}$ of $(K_{m+j})^{\\wedge}_{{{y\\rightarrow\\xi}}}(x,\\xi)$.\n\nNow, let $U\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of local coordinates equipped with a $H$-frame $X_{0},X_{1},\\ldots,X_{d}$. Let $m\\in{\\ensuremath{\\mathbb{Z}}}$ and let $K\\in {\\ensuremath{\\mathcal{K}}}^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $K\\sim \\sum_{j\\geq m} K_{j}$. Then: - For $j \\leq -1$ the distribution $K_{j}(x,y)$ is homogeneous of degree $j$ with respect to $y$ and is smooth for $y\\neq 0$;\n\n- For $j=0$ and $\\lambda>0$ we have $K_{0}(x,\\lambda.y)=K_{0}(x,y)-c_{K_{0},0}(x)\\log \\lambda$, which by setting $\\lambda=\\|y\\|^{-1}$ with $y\\neq 0$ gives $$K_{0}(x,y)=K_{0}(x,\\|y\\|^{-1}.y)-c_{K_{0},0}\\log \\|y\\|.\n     \\label{eq:Log.behavior-K0}$$\n\n- The remainder term $K-\\sum_{j\\geq 1}K_{j}$ is in $C^{0}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ (cf.\u00a0Remarks\u00a0\\[rem:NCR.regularity-cKm1\\] and\u00a0\\[rem:NCR.regularity-cKm2\\]).\n\nIt follows that $K(x,y)$ has a behavior near $y=0$ of the form, $$K(x,y)=\\sum_{m\\leq j\\leq -1} K_{j}(x,y)-c_{K}(x)\\log \\|y\\| +{\\operatorname{O}}(1), \\qquad c_{K}(x)=c_{K_{0},0}(x).\n     \\label{eq:Log.behavior-K}$$\n\nLet $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(U)$ have kernel $k_{P}(x,y)$ and set $\\hat{m}=-(m+d+2)$.\n\n1\\) Near the diagonal $k_{P}(x,y)$ has a behavior of the form, $$k_{P}(x,y)=\\sum_{\\hat{m}\\leq j \\leq -1}a_{j}(x,-\\psi_{x}(y)) -c_{P}(x) \\log \\|\\psi_{x}(y)\\| +{\\operatorname{O}}(1),\n         \\label{eq:Log.behavior-kP}$$ with $a_{j}(x,y)\\in C^{\\infty}({U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)})$ homogeneous of degree $j$ in $y$ and $c_{P}(x)\\in C^{\\infty}(U)$.\n\n2\\) If we write $k_{P}(x,y)$ in the forms\u00a0(\\[eq:PsiHDO.characterization-kernel.privileged\\]) and\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K(x,y)$ and $K_{P}(x,y)$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, then we have $$c_{P}(x)=|\\psi_{x}'|c_{K}(x)=|\\varepsilon_{x}'|c_{K_{P}}(x)=\\frac{|\\psi_{x}'|}{(2\\pi)^{d+1}}\\int_{\\|\\xi\\|=1}p_{-(d+2)}(x,\\xi)\\imath_{E}d\\xi,\n     \\label{eq:NCR.formula-cP}$$ where $p_{-(d+2)}$ denotes the symbol of degree $-(d+2)$ of $P$.\n\nIf we put $k_{P}(x,y)$ in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.privileged\\]) with $K\\in {\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $K\\sim \\sum K_{\\hat{m}+j}$, then it follows from\u00a0(\\[eq:Log.behavior-K\\]) that $k_{P}(x,y)$ has a behavior near the diagonal of the form\u00a0(\\[eq:Log.behavior-kP\\]) with $c_{P}(x)=|\\psi_{x}'|c_{K}(x)=|\\psi_{x}'|c_{K_{0},0}(x)$. Furthermore, by Proposition\u00a0\\[prop:PsiVDO.characterisation-kernel1\\] the symbol $p_{-(d+2)}(x,\\xi)$ of degree $-(d+2)$ of $P$ is the restriction to ${U\\times({\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0)}$ of $(K_{0})^{\\wedge}_{{{y\\rightarrow\\xi}}}(x,\\xi)$, so by Lemma\u00a0\\[lem:NCR.extension-symbolU\\] we have $c_{K}(x)=c_{K_{0},0}(x)=(2\\pi)^{-(d+1)}\\int_{\\|\\xi\\|=1}p_{-(d+2)}(x,\\xi)\\imath_{E}d\\xi$.\n\nNext, if we put $k_{P}(x,y)$ in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{P}\\in {\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $K_{P}\\sim \\sum K_{P,\\hat{m+j}}$ then by Proposition\u00a0\\[prop:PsiVDO.characterisation-kernel1\\] we have $K_{P,0}(x,y)=K_{0}(x,\\phi_{x}(y))$. Let $\\lambda>0$. Since $\\phi_{x}(\\lambda.y)=\\lambda.\\phi_{x}(y)$, using\u00a0(\\[eq:NCR.log-homogeneity-Km\\]) we get $$K_{P,0}(x,\\lambda.y)-K_{P,0}(x,y)=  K_{0}(x,\\lambda.\\phi_{x}(y))-K_{0}(x,\\phi_{x}(y))=c_{K_{0}}(x) \\log \\lambda . \\\\\n$$ Hence $c_{K_{P,0}}(x)=c_{K,0}(x)$. As $|\\varepsilon_{x}'|=|\\phi_{x}'|.|\\psi_{x}'|=|\\psi_{x}'|$ we see that $|\\psi_{x}'|c_{K}(x)=|\\varepsilon_{x}'|c_{K_{P}}(x)$. The proof is thus achieved.\n\n\\[lem:log-sing.invariance\\] Let $\\phi : U\\rightarrow \\tilde{U}$ be a change of $H$-framed local coordinates. Then for any $\\tilde{P}\\in \n  {\\ensuremath{\\Psi_{H}}}^{m}(\\tilde{U})$ we have $c_{\\phi^{*}\\tilde{P}}(x)=|\\phi'(x)|c_{\\tilde{P}}(\\phi(x))$.\n\nLet $P=\\phi^{*}\\tilde{P}$. Then $P$ is a [$\\Psi_{H}$DO]{}\u00a0of order $m$ on $U$ (see\u00a0[@BG:CHM]). Moreover, by\u00a0[@Po:MAMS1 Prop.\u00a03.1.18] if we write the Schwartz kernel $k_{\\tilde{P}}(\\tilde{x},\\tilde{y})$ in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{\\tilde{P}}(\\tilde{x},\\tilde{y})$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}(\\tilde{U}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, then the Schwartz kernel $k_{P}(x,y)$ of $P$ can be put in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{P}(x,y)$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}(U\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $$K_{P}(x,y) \\sim \\sum_{{\\ensuremath{\\langle\\! \\beta\\!\\rangle}}\\geq \\frac{3}{2}{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}} \\frac{1}{\\alpha!\\beta!} \n       a_{\\alpha\\beta}(x)y^{\\beta}(\\partial_{\\tilde{y}}^{\\alpha}K_{\\tilde{P}})(\\phi(x),\\phi_{H}'(x).y),\n        \\label{eq:PsiHDO.asymptotic-expansion-KP}$$ where we have let $a_{\\alpha\\beta}(x)=\\partial^{\\beta}_{y}[|\\partial_{y}(\\varepsilon_{\\phi(x)}\\circ \\phi\\circ \\tilde{\\varepsilon}_{x}^{-1})(y)| \n   (\\tilde{\\varepsilon}_{\\phi(x)}\\circ \\phi\\circ \\varepsilon_{x}^{-1}(y)-\\phi_{H}'(x)y)^{\\alpha}]_{|_{y=0}}$, the map $\\phi_{H}'(x)$ is the tangent map\u00a0(\\[eq:Heisenberg.tangent-map\\]), and $\\tilde{\\varepsilon}_{\\tilde{x}}$ denotes the change to the Heisenberg coordinates at $\\tilde{x}\\in \\tilde{U}$. In particular, we have $$K_{P}(x,y)= a_{00}(x) K_{\\tilde{P}}(\\phi(x),\\phi_{H}'(x).y) \\quad \n           \\bmod y_{j}{\\ensuremath{\\mathcal{K}}}^{\\hat{m}+1}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}),\n     \\label{eq:PsiHDO.asymptotic-expansion-KP2}$$ where $a_{00}(x)=|\\varepsilon_{\\phi(x)}'||\\phi'(x)||\\varepsilon_{x}'|^{-1}$.\n\nNotice that $\\tilde{K}(x,y):= K_{\\tilde{P}}(\\phi(x),\\phi_{H}'(x).y)$ is an element of ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, since we have $\\phi'_{H}(x).(\\lambda.y)=\\lambda.(\\phi'_{H}(x).y)$ for any $\\lambda>0$. Moreover, the distributions in $y_{j}{\\ensuremath{\\mathcal{K}}}^{*}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $j=0,..,d$, cannot have a logarithmic singularity near $y=0$. To see this it is enough to look at a distribution $H(x,y)\\in {\\ensuremath{\\mathcal{K}}}^{-l}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, $l\\in {\\ensuremath{\\mathbb{N}}}_{0}$. Then $H(x,y)$ has a behavior near $y=0$ of the form: $$H(x,y)=\\sum_{-l\\leq k \\leq -1}b_{k}(x,y)-c_{H}(x)\\log \\|y\\|+{\\operatorname{O}}(1),\n$$ with $b_{k}(x,y)$ homogeneous of degree $k$ with respect to the $y$-variable. Thus, $$y_{j}H(x,y)=\\sum_{-l\\leq k \\leq -1}y_{j}b_{k}(x,y)-c_{H}(x)y_{j}\\log \\|y\\|+{\\operatorname{O}}(1).\n$$ Observe that each term $y_{j}b_{k}(x,y)$ is homogeneous of degree $k+1$ with respect to $y$ and the term $y_{j}\\log \\|y\\|$ converges to $0$ as $y\\rightarrow 0$. Therefore, we see that the singularity of $y_{j}H(x,y)$ near $y=0$ cannot contain a logarithmic term.\n\nCombining the above observations with\u00a0(\\[eq:PsiHDO.asymptotic-expansion-KP\\]) shows that the coefficients of the logarithmic singularities of $K_{P}(x,y)$ and $a_{00}(x)\\tilde{K}(x,y)$ must agree, i.e., we have $c_{K_{P}}(x)=c_{a_{00}\\tilde{K}}(x)=a_{00}(x)c_{\\tilde{K}}(x)=|\\varepsilon_{\\phi(x)}'||\\phi'(x)||\\varepsilon_{x}'|^{-1}c_{\\tilde{K}}(x)$. Furthermore, the only contribution to the logarithmic singularity of $\\tilde{K}(x,y)$ comes from $$\\begin{gathered}\n     c_{K_{\\tilde{P}}}(\\phi(x))\\log\\|\\phi_{H}'(x)y\\|= c_{K_{\\tilde{P}}}(\\phi(x))\\log[\\|y\\| \n     \\|\\phi_{H}'(x).(\\|y\\|^{-1}.y\\|)] \\\\ =c_{K_{\\tilde{P}}}(\\phi(x))\\log\\|y\\| +{\\operatorname{O}}(1).\n \\end{gathered}$$ Hence $c_{\\tilde{K}}(x)=c_{K_{\\tilde{P}}}(\\phi(x))$. Therefore, we get $c_{K_{P}}(x)=|\\varepsilon_{\\phi(x)}'||\\phi'(x)||\\varepsilon_{x}'|^{-1}c_{K_{\\tilde{P}}}(\\phi(x))$, which by combining with\u00a0(\\[eq:NCR.formula-cP\\]) shows that $c_{P}(x)=|\\phi'(x)|c_{\\tilde{P}}(\\phi(x))$ as desired.\n\nLet $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ and let $\\kappa:U\\rightarrow V$ be a $H$-framed chart over which there is a trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|_{U}}\\rightarrow U\\times {\\ensuremath{\\mathbb{C}}}^{r}$. Then the Schwartz kernel of $P_{\\kappa,\\tau}:=\\kappa_{*}\\tau_{*}(P_{|_{U}})$ has a singularity near the diagonal of the form\u00a0(\\[eq:Log.behavior-kP\\]). Moreover, if $\\tilde{\\kappa}:\\tilde{U}\\rightarrow \\tilde{V}$ be a $H$-framed chart over which there is a trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|_{\\tilde{U}}}\\rightarrow \n\\tilde{U}\\times {\\ensuremath{\\mathbb{C}}}^{r}$ and if we let $\\phi$ denote the Heisenberg diffeomorphism $\\tilde{\\kappa}\\circ \\kappa^{-1}:\\kappa(U\\cap \\tilde{U})\\rightarrow \n\\tilde{\\kappa}(U\\cap \\tilde{U})$, then by Lemma\u00a0\\[lem:log-sing.invariance\\] we have $c_{P_{\\kappa,\\tau}}(x)=|\\phi'(x)|c_{P_{\\tilde{\\kappa},\\tilde{\\tau}}}(\\phi(x))$ for any $x \\in U$. Therefore, on $U\\cap \\tilde{U}$ we have the equality of densities, $$\\tau^{*}\\kappa^{*}(c_{P_{\\kappa,\\tau}}(x)dx)= \\tilde{\\tau}^{*}\\tilde{\\kappa}^{*}(c_{P_{\\tilde{\\kappa},\\tilde{\\tau}}}(x)dx).$$\n\nNow, the space $C^{\\infty}(M,|\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$ of ${\\ensuremath{{\\operatorname{END}}}}{\\ensuremath{\\mathcal{E}}}$-valued densities is a sheaf, so there exists a unique density $c_{P}(x) \\in C^{\\infty}(M,|\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$ such that, for any local $H$-framed chart $\\kappa:U\\rightarrow V$ and any trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|_{U}}\\rightarrow U\\times {\\ensuremath{\\mathbb{C}}}^{r}$, we have $$c_{P}(x)|_{U}=\\tau^{*}\\kappa^{*}(c_{\\kappa_{*}\\tau_{*}(P_{|_{U}})}(x)dx).\n$$ Moreover, this density is functorial with respect to Heisenberg diffeomorphisms, i.e., for any Heisenberg diffeomorphism $\\phi:(M,H)\\rightarrow \n(M',H')$ we have $$c_{\\phi_{*}P}(x)=\\phi_{*}(c_{P}(x)).\n     \\label{eq:Log.functoriality-cP}$$\n\nSummarizing all this we have proved:\n\n\\[thm:NCR.log-singularity\\] Let $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $m \\in {\\ensuremath{\\mathbb{Z}}}$. Then:\n\n1\\) On any trivializing $H$-framed local coordinates the Schwartz kernel $k_{P}(x,y)$ of $P$ has a behavior near the diagonal of the form, $$k_{P}(x,y)=\\sum_{-(m+d+2)\\leq j\\leq -1}a_{j}(x,-\\psi_{x}(y)) - c_{P}(x)\\log \\|\\psi_{x}(y)\\| + \n        {\\operatorname{O}}(1),$$ where $c_{P}(x)$ is given by\u00a0(\\[eq:NCR.formula-cP\\]) and each function $a_{j}(x,y)$ is smooth for $y\\neq 0$ and homogeneous of degree $j$ with respect to $y$.\n\n2\\) The coefficient $c_{P}(x)$ makes sense globally on $M$ as a smooth ${\\ensuremath{{\\operatorname{END}}}}{\\ensuremath{\\mathcal{E}}}$-valued density which is functorial with respect to Heisenberg diffeomorphisms.\n\nFinally, the following holds.\n\n\\[prop.Sing.transpose-adjoint\\] Let $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$, $m \\in {\\ensuremath{\\mathbb{Z}}}$. 1) Let $P^{t}\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}}^{*})$ be the transpose of $P$. Then we have $c_{P^{t}}(x)=c_{P}(x)^{t}$.\n\n2\\) Suppose that $M$ is endowed with a density $\\rho>0$ and ${\\ensuremath{\\mathcal{E}}}$ is endowed with a Hermitian metric. Let $P^{*}\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ be the adjoint of $P$. Then we have $c_{P^{*}}(x)=c_{P}(x)^{*}$.\n\nLet us first assume that ${\\ensuremath{\\mathcal{E}}}$ is the trivial line bundle. Then it is enough to prove the result in $H$-framed local coordinates $U\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$, so that the Schwartz kernel $k_{P}(x,y)$ can be put in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{P}(x,y)$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$.\n\nWe know that $P^{t}$ is a [$\\Psi_{H}$DO]{}\u00a0 of order $m$ (see\u00a0[@BG:CHM Thm.\u00a017.4]). Moreover, by\u00a0[@Po:MAMS1 Prop.\u00a03.1.21] we can put its Schwartz kernel $k_{P^{t}}(x,y)$ in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{P^{t}}(x,y)$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ such that $$K_{P^{t}}(x,y) \\sim  \\sum_{\\frac{3}{2}{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}} \\leq {\\ensuremath{\\langle\\! \\beta\\!\\rangle}}} \\sum_{|\\gamma|\\leq |\\delta| \\leq 2|\\gamma|} \n       a_{\\alpha\\beta\\gamma\\delta}(x) y^{\\beta+\\delta}  \n       (\\partial^{\\gamma}_{x}\\partial_{y}^{\\alpha}K_{P})(x,-y),$$ where $a_{\\alpha\\beta\\gamma\\delta}(x)=\\frac{|\\varepsilon_{x}^{-1}|}{\\alpha!\\beta!\\gamma!\\delta!}\n   [\\partial_{y}^{\\beta}(|\\varepsilon_{\\varepsilon_{x}^{-1}(-y)}'|(y-\\varepsilon_{\\varepsilon_{x}^{-1}(y)}(x))^{\\alpha})\n   \\partial_{y}^{\\delta}(\\varepsilon_{x}^{-1}(-y)-x)^{\\gamma}](x,0)$. In particular, we have $K_{P^{t}}(x,y)=K_{P}(x,-y) \\bmod y_{j}{\\ensuremath{\\mathcal{K}}}^{\\hat{m}+1}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$. Therefore, in the same way as in the proof of Lemma\u00a0\\[lem:log-sing.invariance\\], we see that the logarithmic singularity near $y=0$ of $K_{P}(x,y)$ agrees with that of $K_{P^{t}}(x,-y)$, hence with that of $K_{P^{t}}(x,y)$. Therefore, we have $c_{K_{P^{t}}}(x)=c_{K_{P}}(x)$. Combining this with\u00a0(\\[eq:NCR.formula-cP\\]) then shows that $c_{P^{t}}(x)=c_{P}(x)$.\n\nNext, suppose that $U$ is endowed with a smooth density $\\rho(x)>0$. Then the corresponding adjoint $P^{*}$ is a [$\\Psi_{H}$DO]{}\u00a0of order $m$ on $U$ with Schwartz kernel $k_{P^{*}}(x,y)=\\rho(x)^{-1}\\overline{k_{P^{t}}(x,y)}\\rho(y)$. Thus $k_{P^{*}}(x,y)$ can be put in the form\u00a0(\\[eq:PsiHDO.characterization-kernel.Heisenberg\\]) with $K_{P^{*}}(x,y)$ in ${\\ensuremath{\\mathcal{K}}}^{\\hat{m}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ such that $$\\begin{gathered}\n       K_{P^{*}}(x,y)=[\\rho(x)^{-1}\\rho(\\varepsilon_{x}^{-1}(-y))]\\overline{K_{P^{t}}(x,y)}\\\\\n       =\\overline{K_{P^{t}}(x,y)} \\  \\bmod y_{j}{\\ensuremath{\\mathcal{K}}}^{\\hat{m}+1}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}}).\n   \\end{gathered}$$ Therefore, $K_{P^{*}}(x,y)$ and $\\overline{K_{P^{t}}(x,y)}$ same logarithmic singularity near $y=0$, so that we have $c_{K_{P^{*}}}(x)=\\overline{c_{K_{P^{t}}}(x)}=\\overline{c_{K_{P}}(x)}$. Hence $c_{P^{*}}(x)=\\overline{c_{P}(x)}$.\n\nFinally, when ${\\ensuremath{\\mathcal{E}}}$ is a general vector bundle, we can argue as above to show that we still have $c_{P^{t}}(x)=c_{P}(x)^{t}$, and if $P^{*}$ is the adjoint of $P$ with respect to the density $\\rho$ and some Hermitian metric on ${\\ensuremath{\\mathcal{E}}}$, then we have $c_{P^{*}}(x)=c_{P}(x)^{*}$.\n\nNoncommutative residue\n----------------------\n\nLet $(M^{d+1},H)$ be a Heisenberg manifold and let ${\\ensuremath{\\mathcal{E}}}$ be a vector bundle over $M$. We shall now construct a noncommutative residue trace on the algebra ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ as the residual trace induced by the analytic extension of the operator trace to [$\\Psi_{H}$DOs]{}\u00a0of non-integer order.\n\nLet ${\\ensuremath{\\Psi_{H}^{\\text{int}}}}(M,{\\ensuremath{\\mathcal{E}}}) := \\cup_{\\Re m < -(d+2)}{\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ the class of [$\\Psi_{H}$DOs]{}\u00a0whose symbols are integrable with respect to the $\\xi$-variable (this notation is borrowed from\u00a0[@CM:LIFNCG]). If $P$ belongs to this class, then it follows from Remark\u00a0\\[rem:NCR.regularity-cKm2\\] that the restriction to the diagonal of $M\\times M$ of its Schwartz kernel defines a smooth density $k_{P}(x,x)$ with values in ${\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}$. Therefore, when $M$ is compact then $P$ is a trace-class operator on $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ and we have $${\\ensuremath{{\\operatorname{Trace}}}}(P) = \\int_{M} {{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}k_{P}(x,x).\n$$\n\nWe shall now construct an analytic extension of the operator trace to the class ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ of [$\\Psi_{H}$DOs]{}\u00a0of non-integer order. As in\u00a0 [@Gu:GLD] (see also [@KV:GDEO], [@CM:LIFNCG]) the approach consists in working directly at the level of densities by constructing an analytic extension of the map $P\\rightarrow k_{P}(x,x)$ to ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$. Here analyticity is meant with respect to holomorphic families of [$\\Psi_{H}$DOs]{}, e.g., the map $P \\rightarrow k_{P}(x,x)$ is analytic since for any holomorphic family $(P(z))_{z\\in \\Omega}$ with values in ${\\ensuremath{\\Psi_{H}^{\\text{int}}}}(M,{\\ensuremath{\\mathcal{E}}})$ the output densities $k_{P(z)}(x,x)$ depend analytically on $z$ in the Fr\u00e9chet space $C^{\\infty}(M,|\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$.\n\nLet $U \\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be an open of trivializing local coordinates equipped with equipped with a $H$-frame $X_{0}, \\ldots, X_{d}$, and for any $x\\in U$ let $\\psi_{x}$ denote the affine change of variables to the privileged coordinates at $x$. Any $P \\in {\\ensuremath{\\Psi_{H}}}^{m}(U)$ can be written as $P=p(x,-iX)+R$ with $p\\in S^{m}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ and $R\\in \\Psi^{-\\infty}(U)$. Therefore, if $\\Re m <-(d+2)$ then using\u00a0(\\[eq:Heisenberg.kernel-quantization-symbol-psiy\\]) we get $$k_{P}(x,x)=|\\psi_{x}'| (2\\pi)^{-(d+2)}\\int p(x,\\xi)d\\xi +k_{R}(x,x). \n    \\label{eq:NCR.kP(x,x)}$$ This leads us to consider the functional, $$L(p):=(2\\pi)^{-(d+2)}\\int p(\\xi) d\\xi, \\qquad p\\in{\\ensuremath{S^{\\text{int}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}). \n$$\n\nIn the sequel, as in Section\u00a0\\[sec:Heisenberg-calculus\\] for [$\\Psi_{H}$DOs]{}, we say that a holomorphic family of symbols $(p(z))_{z\\in{\\ensuremath{\\mathbb{C}}}}\\subset S^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is a *gauging* for a given symbol $p\\in \nS^{*}({\\ensuremath{\\mathbb{R}}}^{d+1})$ when we have $p(0)=p$ and ${{{\\operatorname{ord}}}}p(z)=z+{{{\\operatorname{ord}}}}p$ for any $z\\in {\\ensuremath{\\mathbb{C}}}$.\n\n\\[lem:Spectral.tildeL\\] 1) The functional $L$ has a unique analytic continuation $\\tilde{L}$ to $S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. The value of $\\tilde{L}$ on a symbol $p\\sim \\sum_{j\\geq 0} p_{m-j}$ of order $m \\in{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}$ is given by $$\\tilde{L}(p)= (p- \\sum_{j\\leq N}\\tau_{m-j})^{\\vee}(0),  \\qquad N\\geq  \\Re{m}+d+2,\n     \\label{eq:NCR.L-tilda}$$ where the value of the integer $N$ is irrelevant and the distribution $\\tau_{m-j}\\in {\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is the unique homogeneous extension of $p_{m-j}(\\xi)$ provided by Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\].\n\n2\\) Let $ p\\in S^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, $p\\sim \\sum p_{m-j}$, and let $(p(z))_{z \\in {\\ensuremath{\\mathbb{C}}}}\\subset S^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be a holomorphic gauging for $p$. Then $\\tilde{L}(p(z))$ has at worst a simple pole singularity at $z=0$ in such way that $${\\ensuremath{{\\operatorname{Res}}}}_{z=0}\\tilde{L}(p(z)) =  \\int_{\\|\\xi\\|=1} p_{-(d+2)}(\\xi) \\imath_{E}d\\xi, \n$$ where $p_{-(d+2)}(\\xi)$ is the symbol of degree $-(d+2)$ of $p(\\xi)$ and $E$ is the anisotropic radial vector field $2\\xi_{0}\\partial_{x_{0}}+\\xi_{1}\\partial_{\\xi_{1}}+\\ldots+\\xi_{d}\\partial_{\\xi_{d}}$.\n\nFirst, the extension is necessarily unique since the functional $L$ is holomorphic on ${\\ensuremath{S^{\\text{int}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and each symbol $p\\in S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ can be connected to ${\\ensuremath{S^{\\text{int}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ by means of a holomorphic family with values in $S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nLet $p\\in S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, $p\\sim \\sum_{j\\geq 0} p_{m-j}$, and for $j=0,1,\\ldots$ let $\\tau_{m-j} \\in {\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ denote the unique homogeneous extension of $p_{m-j}$ provided by Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\]. For $N\\geq  \\Re{m}+d+2$ the distribution $p-\\sum_{j\\leq N}\\tau_{m-j}$ agrees with an integrable function near $\\infty$, so its Fourier transform is continuous and we may define $$\\tilde{L}(p)= (p-\\sum_{j\\leq N}\\tau_{m-j})^\\wedge (0).\n    \\label{eq:Spectral.tildeL}$$ Notice that if $j>\\Re m +d+2$ then $\\tau_{m-j}$ is also integrable near $\\infty$, so $\\hat\\tau_{m-j}(0)$ makes well sense. However, its value must be $0$ for homogeneity reasons. This shows that the value of $N$ in\u00a0(\\[eq:Spectral.tildeL\\]) is irrelevant, so this formula defines a linear functional on $S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. In particular, if $\\Re m<-(d+2)$ then we can take $N=0$ to get $\\tilde{L}(p)=\\check{p}(0)=\\int p(\\xi)d\\xi=L(p)$. Hence $\\tilde{L}$ agrees with $L$ on ${\\ensuremath{S^{\\text{int}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})\\cap S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nLet $(p(z))_{z \\in \\Omega}$ be a holomorphic family of symbols such that $w(z)={{{\\operatorname{ord}}}}p(z)$ is never an integer and let us study the analyticity of $\\tilde{L}(p(z))$. As the functional $L$ is holomorphic on ${\\ensuremath{S^{\\text{int}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ we may assume that we have $|\\Re w(z)-m|<1$ for some integer $m\\geq -(d+2)$. In this case in\u00a0(\\[eq:Spectral.tildeL\\]) we can set $N=m+d+2$ and for $j=0,\\ldots,m+d+1$ we can represent $\\tau(z)_{w(z)-j}$ by $p(z)_{w(z)-j}$. Then, picking $\\varphi \\in C_{c}^\\infty({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $\\varphi=1$ near the origin, we see that $ \\tilde{L}(p(z))$ is equal to $$\\begin{gathered}\n     \\int [p(z)(\\xi)- (1-\\varphi(\\xi) )\\sum_{j\\leq m+d+2} p(z)_{w(z)-j}(\\xi)] d\\xi \n                             -  \\sum_{j\\leq m+d+2} {\\ensuremath{\\langle \\tau (z)_{w(z)-j} , \\varphi \\rangle}} \\\\\n       = L(\\tilde{p}(z)) -{\\ensuremath{\\langle \\tau(z) , \\varphi \\rangle}}- \\sum_{j\\leq m+d+1} \\int p(z)_{ w(z)-j}(\\xi)\\varphi(\\xi)d\\xi ,  \n    \\label{eq:Spectral.tildeLbis} \\end{gathered}$$ where we have let $\\tau(z)= \\tau(z)_{w(z)-m-(d+2)}$ and $\\tilde{p}(z)=p(z)-(1-\\varphi)\\sum_{j\\leq m+d+2} p(z)_{w(z)-j}$.\n\nIn the r.h.s.\u00a0of\u00a0(\\[eq:Spectral.tildeLbis\\]) the only term that may fail to be analytic is $- {\\ensuremath{\\langle \\tau(z) , \\varphi \\rangle}}$. Notice that by the formulas\u00a0(\\[eq:Appendix.almosthomogeneous-extension\\]) and\u00a0(\\[eq:Appendix1.h\u2019\\]) in Appendix we have $${\\ensuremath{\\langle \\tau(z) , \\varphi \\rangle}}= \\int p(z)_{w(z)-m-(d+2)}(\\varphi(\\xi)-\\psi_{z}(\\xi))d\\xi, \n$$ with $\\psi_{z}\\in C^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ of the form $\\psi_{z}(\\xi)= \\int^{\\infty}_{\\log\\|\\xi\\|} \n[(\\frac 1{w(z)-m}\\frac{d}{ds} +1)g](t)dt$, where $g(t)$ can be any function in $C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}})$ such that $\\int g(t)dt=1$. Without any loss of generality we may suppose that $\\varphi(\\xi)= \\int^{\\infty}_{\\log\\|\\xi\\|} \ng(t)dt$ with $g\\in C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}})$ as above. Then we have $\\psi_{z}(\\xi)= -\\frac 1{w(z)-m} g(\\log \\|\\xi\\|) + \\varphi(\\xi)$, which gives $$\\begin{gathered}\n    {\\ensuremath{\\langle \\tau(z) , \\varphi \\rangle}}  =\\frac 1{w(z)-m} \\int p(z)_{w(z)-m-(d+2)}(\\xi) g(\\log \\|\\xi\\|)d\\xi \\\\ \n     =\\frac1{w(z)-m} \n    \\int \\mu^{w(z)-m}g(\\log \\mu)\\frac{d\\mu}{\\mu}\\ \\int_{\\|\\xi\\|=1}  p(z)_{w(z)-m-(d+2)}(\\xi) \\imath_{E}d\\xi. \n    \\label{eq:NCR.tau-z}\\end{gathered}$$ Together with\u00a0(\\[eq:Spectral.tildeLbis\\]) this shows that $\\tilde{L}(p(z))$ is an analytic function, so the the first part of the lemma is proved.\n\nFinally, let $p\\sim \\sum p_{m-j}$ be a symbol in $S^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and let $(p(z))_{|\\Re z -m|<1}$ be a holomorphic family which is a gauging for $p$. Since $p(z)$ has order $w(z)=m+z$ it follows from (\\[eq:Spectral.tildeLbis\\]) and (\\[eq:NCR.tau-z\\]) that $\\tilde{L}(p(z))$ has at worst a simple pole singularity at $z=0$ such that $$\\begin{gathered}\n   {\\ensuremath{{\\operatorname{Res}}}}_{z=0}\\tilde{L}(p(z))= {\\ensuremath{{\\operatorname{Res}}}}_{z=0} \\frac{-1}{z} \\int \\mu^{z}g(\\log \\mu)\\frac{d\\mu}{\\mu}\\ \\int_{\\|\\xi\\|=1}  \n    p(z)_{z-(d+2)}(\\xi) \\imath_{E}d\\xi \\\\ = - \\int_{\\|\\xi\\|=1}  p_{-(d+2)}(\\xi) \\imath_{E}d\\xi .\n$$ This proves the second part of the lemma.\n\nNow, for $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(U)$ we let $$t_{P}(x) = (2\\pi)^{-(d+2)}|\\psi_{x}'| \\tilde{L}(p(x,.)) + k_{R}(x,x),\n    \\label{eq:NCR.tP-definition}$$ where the pair $(p,R) \\in S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})\\times \\Psi^{\\infty}(U)$ is such that $P=p(x,-iX)+R$. This definition does not depend on the choice of $(p,R)$. Indeed, if $(p',R')$ is another such pair then $p-p'$ is in $S^{-\\infty}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$, so using\u00a0(\\[eq:NCR.kP(x,x)\\]) we that $k_{R'}(x,x)-k_{R}(x,x)$ is equal to $$\\begin{gathered}\n k_{(p-p')(x,-iX)}(x,x) = (2\\pi)^{-(d+2)}|\\psi_{x}'| L((p-p')(x,.))\\\\ = \n         (2\\pi)^{-(d+2)}|\\psi_{x}'| (\\tilde{L}(p(x,.)) -\\tilde{L}(p'(x,.))),  \n$$ which shows that the r.h.s.\u00a0of\u00a0(\\[eq:NCR.tP-definition\\]) is the same for both pairs.\n\nOn the other hand, observe that\u00a0(\\[eq:Spectral.tildeLbis\\]) and (\\[eq:NCR.tau-z\\]) show that $\\tilde{L}(p(x,.))$ depends smoothly on $x$ and that for any holomorphic family $(p(z))(z)\\in \\Omega \\subset  S^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$ the map $z\\rightarrow \\tilde{L}(p(x,.))$ is holomorphic from $\\Omega$ to $C^{\\infty}(U)$. Therefore, the map $P\\rightarrow t_{P}(x)$ is an analytic extension to ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(U)$ of the map $P\\rightarrow k_{P}(x,x)$.\n\nLet $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(U)$ and let $(P(z))_{z \\in \n\\Omega}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(U)$ be a holomorphic gauging for $P$. Then it follows from\u00a0(\\[eq:Spectral.tildeLbis\\]) and (\\[eq:NCR.tau-z\\]) that with respect to the topology of $C^{\\infty}(M,|\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$ the map $z\\rightarrow t_{P(z)}(x)$ has at worst a simple pole singularity at $z=0$ with residue $${\\ensuremath{{\\operatorname{Res}}}}_{z=0} t_{P(z)}(x)=-(2\\pi)^{-(d+2)}  \\int_{\\|\\xi\\|=1}  p_{-(d+2)}(\\xi) \\imath_{E}d\\xi =-c_{P}(x),\n     \\label{eq:NCR.residue.t-P.U}$$ where $p_{-(d+2)}(\\xi)$ denotes the symbol of degree $-(d+2)$ of $P$.\n\nNext, let $\\phi:\\tilde{U}\\rightarrow U$ be a change of $H$-framed local coordinates. Let $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(U)$ and let $(P(z))_{z \\in{\\ensuremath{\\mathbb{C}}}}$ be a holomorphic family which is a gauging for $P$. As shown in\u00a0[@Po:CPDE1] the [$\\Psi_{H}$DO]{}\u00a0family $(\\phi^{*}P(z))_{z\\in {\\ensuremath{\\mathbb{C}}}}$ is holomorphic and is a gauging for $\\phi^{*}P$. Moreover, as for $\\Re z$ negatively large enough we have $k_{\\phi^{*}P(z)}=|\\phi'(x)|k_{P(z)}(\\phi(x),\\phi(x))$, an analytic continuation gives $$t_{\\phi^{*}P}(x)=|\\phi'(x)|t_{P}(\\phi(x)).    \n     \\label{eq:NCR.functoriality-tP}$$\n\nNow, in the same way as in the construction of the density $c_{P}(x)$ in the proof of Proposition\u00a0\\[thm:NCR.log-singularity\\], it follows from all this that if $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ then there exists a unique ${\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}$-valued density $t_{P}(x)$ such that, for any local $H$-framed chart $\\kappa:U\\rightarrow V$ and any trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|_{U}}\\rightarrow U\\times {\\ensuremath{\\mathbb{C}}}^{r}$, we have $$t_{P}(x)|_{U}=\\tau^{*}\\kappa^{*}(t_{\\kappa_{*}\\tau_{*}(P_{|_{U}})}(x)dx).\n$$ On every trivializing $H$-framed chart the map $P\\rightarrow t_{P}(x)$ is analytic and satisfies\u00a0(\\[eq:NCR.residue.t-P.U\\]). Therefore, we obtain:\n\n\\[thm:NCR.TR.local\\] 1) The map $P \\rightarrow t_{P}(x)$ is the unique analytic continuation of the map $P \\rightarrow k_{P}(x,x)$ to ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\n2\\) Let $P \\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ and let $(P(z))_{z\\in\\Omega}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic family which is a gauging for $P$. Then, in $C^{\\infty}(M,|\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$, the map $z\\rightarrow t_{P(z)}(x)$ has at worst a simple pole singularity at $z=0$ with residue given by $${\\ensuremath{{\\operatorname{Res}}}}_{z=0} t_{P(z)}(x)=- c_{P}(x),\n$$ where $c_{P}(x)$ denotes the ${\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}$-valued density on $M$ given by Theorem\u00a0\\[thm:NCR.log-singularity\\].\n\n3\\) The map $P\\rightarrow t_{P}(x)$ is functorial with respect to Heisenberg diffeomorphisms as in\u00a0(\\[eq:Log.functoriality-cP\\]).\n\nTaking residues at $z=0$ in\u00a0(\\[eq:NCR.functoriality-tP\\]) allows us to recover\u00a0(\\[eq:Log.functoriality-cP\\]).\n\nFrom now one we assume $M$ compact. We then define the *canonical trace* for the Heisenberg calculus as the functional ${\\ensuremath{{\\operatorname{TR}}}}$ on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ given by the formula, $${\\ensuremath{{\\operatorname{TR}}}}P := \\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} t_{P}(x) \\qquad \\forall P\\in  {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}}).$$\n\n\\[thm:NCR.TR.global\\] The canonical trace ${\\ensuremath{{\\operatorname{TR}}}}$ has the following properties:\n\n1\\) ${\\ensuremath{{\\operatorname{TR}}}}$ is the unique analytic continuation to ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ of the usual trace.\n\n2\\) We have $ {\\ensuremath{{\\operatorname{TR}}}}P_{1}P_{2}={\\ensuremath{{\\operatorname{TR}}}}P_{2}P_{1}$ whenever ${{{\\operatorname{ord}}}}P_{1}+{{{\\operatorname{ord}}}}P_{2}\\not\\in{\\ensuremath{\\mathbb{Z}}}$.\n\n3\\) ${\\ensuremath{{\\operatorname{TR}}}}$ is invariant by Heisenberg diffeomorphisms, i.e., for any Heisenberg diffeomorphism $\\phi:(M,H)\\rightarrow (M',H')$ we have $ {\\ensuremath{{\\operatorname{TR}}}}\\phi_{*}P={\\ensuremath{{\\operatorname{TR}}}}P$ $\\forall P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\nThe first and third properties are immediate consequences of Theorem\u00a0\\[thm:NCR.TR.local\\], so we only have to prove the second one.\n\nFor $j=1,2$ let $P_{j}\\in {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ and let $(P_{j}(z))_{z\\in {\\ensuremath{\\mathbb{C}}}}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic gauging for $P_{j}$. We further assume that ${{{\\operatorname{ord}}}}P_{1}+{{{\\operatorname{ord}}}}P_{2}\\not\\in{\\ensuremath{\\mathbb{Z}}}$. Then $P_{1}(z)P_{2}(z)$ and $P_{2}(z)P_{1}(z)$ have non-integer order for $z$ in ${\\ensuremath{\\mathbb{C}}}\\setminus \\Sigma$, where $\\Sigma:=-({{{\\operatorname{ord}}}}P_{1}+{{{\\operatorname{ord}}}}P_{2})+{\\ensuremath{\\mathbb{Z}}}$. For $\\Re z$ negatively large enough we have ${\\ensuremath{{\\operatorname{Trace}}}}P_{1}(z)P_{2}(z)={\\ensuremath{{\\operatorname{Trace}}}}P_{2}(z)P_{1}(z)$, so by analytic continuation we see that ${\\ensuremath{{\\operatorname{TR}}}}P_{1}(z)P_{2}(z)={\\ensuremath{{\\operatorname{TR}}}}P_{2}(z)P_{1}(z)$ for any $z\\in{\\ensuremath{\\mathbb{C}}}\\setminus \\Sigma$. Setting $z =0$ then shows that we have $ {\\ensuremath{{\\operatorname{TR}}}}P_{1}P_{2}={\\ensuremath{{\\operatorname{TR}}}}P_{2}P_{1}$ as desired.\n\nNext, we define the *noncommutative residue* for the Heisenberg calculus as the linear functional ${\\ensuremath{{\\operatorname{Res}}}}$ on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ given by the formula, $${\\ensuremath{{\\operatorname{Res}}}}P :=\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} c_{P}(x) \\qquad \\forall P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}}).\n$$ This functional provides us with the analogue for the Heisenberg calculus of the noncommutative residue trace of Wodzicki ([@Wo:LISA], [@Wo:NCRF]) and Guillemin\u00a0[@Gu:NPWF], for we have:\n\n\\[thm:NCR.NCR\\] The noncommutative residue ${\\ensuremath{{\\operatorname{Res}}}}$ has the following properties:\n\n1\\) Let $P \\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ and let $(P(z))_{z\\in \\Omega}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic gauging for $P$. Then at $z=0$ the function ${\\ensuremath{{\\operatorname{TR}}}}P(z)$ has at worst a simple pole singularity in such way that we have $${\\ensuremath{{\\operatorname{Res}}}}_{z=0} {\\ensuremath{{\\operatorname{TR}}}}P(z)= - {\\ensuremath{{\\operatorname{Res}}}}P. \n     \\label{eq:NCR.residueTR}$$\n\n2\\) We have ${\\ensuremath{{\\operatorname{Res}}}}P_{1}P_{2}={\\ensuremath{{\\operatorname{Res}}}}P_{2}P_{1}$ whenever ${{{\\operatorname{ord}}}}P_{1}+{{{\\operatorname{ord}}}}P_{2}\\in {\\ensuremath{\\mathbb{Z}}}$. Hence ${\\ensuremath{{\\operatorname{Res}}}}$ is a trace on the algebra ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\n3\\) ${\\ensuremath{{\\operatorname{Res}}}}$ is invariant by Heisenberg diffeomorphisms.\n\n4\\) We have ${\\ensuremath{{\\operatorname{Res}}}}P^{t}={\\ensuremath{{\\operatorname{Res}}}}P$ and ${\\ensuremath{{\\operatorname{Res}}}}P^{*}=\\overline{{\\ensuremath{{\\operatorname{Res}}}}P}$ for any $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\nThe first property follows from Proposition\u00a0\\[thm:NCR.TR.local\\]. The third and fourth properties are immediate consequences of Propositions\u00a0\\[thm:NCR.log-singularity\\] and\u00a0\\[prop.Sing.transpose-adjoint\\].\n\nIt remains to prove the 2nd property. Let $P_{1}$ and $P_{2}$ be operators in ${\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ such that ${{{\\operatorname{ord}}}}P_{1}+{{{\\operatorname{ord}}}}P_{2}\\in {\\ensuremath{\\mathbb{Z}}}$. For $j=1,2$ let $(P_{j}(z))_{z\\in {\\ensuremath{\\mathbb{C}}}}\\subset {\\ensuremath{\\Psi_{H}}}^{*}(M,{\\ensuremath{\\mathcal{E}}})$ be a holomorphic gauging for $P_{j}$. Then the family $(P_{1}(\\frac{z}{2})P_{2}(\\frac{z}{2}))_{z\\in {\\ensuremath{\\mathbb{C}}}}$ (resp.\u00a0$(P_{2}(\\frac{z}{2})P_{1}(\\frac{z}{2}))_{z\\in {\\ensuremath{\\mathbb{C}}}}$) is a holomorphic gauging for $P_{1}P_{2}$ (resp.\u00a0$P_{2}P_{1}$). Moreover, by Proposition\u00a0\\[thm:NCR.TR.global\\] for any $z \\in{\\ensuremath{\\mathbb{C}\\!\\setminus\\!\\mathbb{Z}}}$ we have ${\\ensuremath{{\\operatorname{TR}}}}P_{1}(\\frac{z}{2})P_{2}(\\frac{z}{2})={\\ensuremath{{\\operatorname{TR}}}}P_{\\frac{z}{2}}(z)P_{1}(\\frac{z}{2}$. Therefore, by taking residues at $z=0$ and using\u00a0(\\[eq:NCR.residueTR\\]) we get ${\\ensuremath{{\\operatorname{Res}}}}P_{1}P_{2}={\\ensuremath{{\\operatorname{Res}}}}P_{2}P_{1}$ as desired.\n\nTraces and sum of commutators {#sec:traces}\n-----------------------------\n\nLet $(M^{d+1},H)$ be a compact Heisenberg manifold and let ${\\ensuremath{\\mathcal{E}}}$ be a vector bundle over $M$. In this subsection, we shall prove that when $M$ is connected the noncommutative residue spans the space of traces on the algebra ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$. As a consequence this will allow us to characterize the sums of commutators in ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\nLet $H\\subset T{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be a hyperplane bundle such that there exists a global $H$-frame $X_{0},X_{1},\\ldots,X_{d}$ of $T{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$. We will now give a series of criteria for an operator $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ to be a sum of commutators of the form, $$P=  [ x_{0}, P_{0}]+\\ldots+ [x_{d}, P_{d}], \\qquad P_{j}\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}). \n         \\label{eq:Traces.sum-commutators}$$\n\nIn the sequel for any $x\\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ we let $\\psi_{x}$ denote the affine change of variables to the privileged coordinates at $x$ with respect to the $H$-frame $X_{0},\\ldots,X_{d}$.\n\n\\[lem:Traces.criterion-logarithmic-kernel\\] Let $P\\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ have a kernel of the form, $$k_{P}(x,y)=|\\psi_{x}'|K_{0}(x,-\\psi_{x}(y)),\n         \\label{eq:Traces.logarithmic-kernel}$$ where $K_{0}(x,y)\\in {\\ensuremath{\\mathcal{K}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is homogeneous of degree $0$ with respect to $y$. Then $P$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]).\n\nSet $\\psi_{x}(y)=A(x).(y-x)$ with $A\\in C^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}, GL_{d+1}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}))$ and for $j,k=0,\\ldots, d$ define $$K_{jk}(x,y):= A_{jk}(x) y_{j}^{\\beta_{j}}\\|y\\|^{-4}K_{0}(x,y), \\qquad (x,y)\\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0},\n$$ where $\\beta_{0}=1$ and $\\beta_{1}=\\ldots=\\beta_{d}=3$. As $K_{jk}(x,y)$ is smooth for $y\\neq 0$ and is homogeneous with respect to $y$ of degree\u00a0$-2$ if $j=0$ and of degree $-1$ otherwise, we see that it belongs to ${\\ensuremath{\\mathcal{K}}}_{*}({\\ensuremath{\\mathbb{R}}}\\times {\\ensuremath{\\mathbb{R}}})$. Therefore, the operator $Q_{jk}$ with Schwartz kernel $k_{Q_{jk}}=|\\psi_{x}'| K_{jk}(x,-\\psi_{x}(y))$ is a [$\\Psi_{H}$DO]{}.\n\nNext, set $A^{-1}(x)=(A^{jk}(x))_{1\\leq j,k\\leq d}$. Since $x_{k}-y_{k}=-\\sum_{l=0}^{d}A^{kl}(x)\\psi_{x}(y)_{l}$ we deduce that the Schwartz kernel of $\\sum_{j,k=0}^{d}[x_{k},Q_{jk}]$ is $|\\psi_{x}'|K(x,-\\psi_{x}(y))$, where $$\\begin{gathered}\n    K(x,y)=   \\sum_{0\\leq j,k,l \\leq d} A^{kl}(x)y_{l}A_{jk}(x)y_{j}^{\\beta_{j}}\\|y\\|^{-4} K_{0}(x,y)\\\\ \n       =\\sum_{0\\leq j\\leq d} y_{j}^{\\beta_{j}+1}\\|y\\|^{-4}K_{0}(x,y)=K_{0}(x,y).\n  \\end{gathered}$$ Hence $P=\\sum_{j,k=0}^{d}[x_{k},Q_{jk}]$. The lemma is thus proved.\n\n\\[lem:Traces.smoothing-operators1\\] Any $R\\in {\\ensuremath{\\Psi^{-\\infty}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ can be written as a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]).\n\nLet $k_{R}(x,y)$ denote the Schwartz kernel of $R$. Since $k_{R}(x,y)$ is smooth we can write $$k_{R}(x,y)=k_{R}(x,x)+(x_{0}-y_{0})k_{R_{0}}(x,y)+\\ldots +(x_{d}-y_{d})k_{R_{d}}(x,y),\n      \\label{eq:Traces.Taylor}$$ for some smooth functions $k_{R_{0}}(x,y),\\ldots,k_{R_{d}}(x,y)$. For $j=0,\\ldots,d$ let $R_{j}$ be the smoothing operator with Schwartz kernel $k_{R_{j}}(x,y)$, and let $Q$ be the operator with Schwartz kernel $k_{Q}(x,y)=k_{R}(x,x)$. Then by\u00a0(\\[eq:Traces.Taylor\\]) we have $$R=Q+[x_{0},R_{0}]+\\ldots + [x_{d},R_{d}].\n    \\label{eq:Traces.commutators.smoothing-RQ}$$\n\nObserve that the kernel of $Q$ is of the form\u00a0(\\[eq:Traces.logarithmic-kernel\\]) with $K_{0}(x,y)=|\\psi_{x}'|^{-1}k_{R}(x,x)$. Here $K_{0}(x,y)$ belongs to ${\\ensuremath{\\mathcal{K}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and is homogeneous of degree $0$ with respect to $y$, so by Lemma\u00a0\\[lem:Traces.criterion-logarithmic-kernel\\] the operator $Q$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]). Combining this with\u00a0(\\[eq:Traces.commutators.smoothing-RQ\\]) then shows that $R$ is of that form too.\n\n\\[lem:Traces.sum-commutators\\] Any $P\\in {\\ensuremath{\\Psi_{H}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $c_{P}(x)=0$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]).\n\nFor $j=0,\\ldots,d$ we let $\\sigma_{j}(x,\\xi)=\\sum_{k=0}^{d}\\sigma_{jk}(x)\\xi_{k}$ denote the classical symbol of $-iX_{j}$. Notice that $\\sigma(x):=(\\sigma_{jk}(x))$ belongs to $C^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}, GL_{d+1}({\\ensuremath{\\mathbb{C}}}))$.\n\n\\(i) Let us first assume that $P= (\\partial_{\\xi_{j}}q)(x,-iX)$ for some $q\\in S^{{\\ensuremath{\\mathbb{Z}}}}({U\\times{\\ensuremath{\\mathbb{R}}}^{d+1}})$. Set $q_{\\sigma}(x,\\xi)=q(x,\\sigma(x,\\xi))$. Then we have $$[q(x,-iX),x_{k}]=   [q_{\\sigma}(x,D),x_{k}]= (\\partial_{\\xi_{k}}q_{\\sigma})(x,D)=\\sum_{l} \\sigma_{lk}(x)(\\partial_{\\xi_{l}}q)(x,-iX). \n$$ Therefore, if we let $(\\sigma^{kl}(x))$ be the inverse matrix of $\\sigma(x)$, then we see that $$\\sum_{k}[\\sigma^{jk}(x)q(x,-iX),x_{k}]= \\sum_{k,l} \\sigma^{jk}(x)\\sigma_{lk}(x)(\\partial_{\\xi_{l}}q)(x,-iX)=(\\partial_{\\xi_{j}}q)(x,-iX)=P.\n$$ Hence $P$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]).\n\n\\(ii) Suppose now that $P$ has symbol $p \\sim \\sum_{j\\leq m}p_{j}$ with $p_{-(d+2)}=0$. Since $p_{l}(x,\\xi)$ is homogeneous of degree $l$ with respect to $\\xi$, the Euler identity, $$2\\xi_{0}\\partial_{\\xi_{0}}p_{l} + \\xi_{1}\\partial_{\\xi_{1}}p_{l}+\\ldots+ \\xi_{d}\\partial_{\\xi_{d}}p_{l} \n            = l p_{l},$$ implies that we have $$2\\partial_{\\xi_{0}}(\\xi_{0}p_{l}) +   \\partial_{\\xi_{1}}(\\xi_{1}p_{l})+\\ldots+ \n                  \\partial_{\\xi_{d}}(\\xi_{d}p_{l})= (l+d+2)p_{l}.$$\n\nFor $j=0, \\ldots, d$ let $q^{(j)}$ be a symbol so that $q^{(j)} \n  \\sim \\sum_{l\\neq -(d+2)} (l+d+2)^{-1} \\xi_{j}p_{l}$. Then for $l\\neq -(d+2)$ the symbol of degree $l$ of $2\\partial_{\\xi_{0}}q^{(0)}+  \n        \\partial_{\\xi_{1}} q^{(1)}+\\ldots+ \\partial_{\\xi_{j}} q^{(d)}$ is equal to $$(l+d+2)^{-1}(2\\partial_{\\xi_{0}}(\\xi_{0}p_{l}) +   \\partial_{\\xi_{1}}(\\xi_{1}p_{l}))+\\ldots+  \n                    \\partial_{\\xi_{d}}(\\xi_{d}p_{l}))= p_{l}. \n$$ Since $p_{-(d+2)}=0$ this shows that $p- 2\\partial_{\\xi_{0}}q^{(0)} +  \n        \\partial_{\\xi_{1}} q^{(1)}+\\ldots+ \\partial_{\\xi_{j}} q^{(d)}$ is in $S^{-\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Thus, there exists $R$ in ${\\ensuremath{\\Psi^{-\\infty}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $$P=2(\\partial_{\\xi_{0}}q^{(0)})(x,-iX) +  \n        (\\partial_{\\xi_{1}} q^{(1)})(x,-iX)+\\ldots+ (\\partial_{\\xi_{j}} q^{(d)})(x,-iX)+R,\n$$\n\nThanks to the part (i) and to Lemma\u00a0\\[lem:Traces.smoothing-operators1\\] the operators $(\\partial_{\\xi_{j}}q^{(j)})(x,-iX)$ and $R$ are sums of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]), so $P$ is of that form as well.\n\n\\(iii) The general case is obtained as follows. Let $p_{-(d+2)}(x,\\xi)$ be the symbol of degree $-(d+2)$ of $P$. Then by Lemma\u00a0\\[lem:NCR.extension-symbolU\\] we can extend $p_{-(d+2)}(x,\\xi)$ into a distribution $\\tau(x,\\xi)$ in $C^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}){\\hat\\otimes}{\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ in such way that $K_{0}(x,y):=\\check{\\tau}_{{{\\xi\\rightarrow y}}}(x,y)$ belongs to ${\\ensuremath{\\mathcal{K}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Furthermore, with the notation of\u00a0(\\[eq:NCR.log-homogeneity-Km\\]) we have $c_{K,0}(x)=(2\\pi)^{-(d+2)}\\int_{\\|\\xi\\|=1}p_{-(d+2)}(x,\\xi)\\iota_{E}d\\xi$. Therefore, by using\u00a0(\\[eq:NCR.formula-cP\\]) and the fact $c_{P}(x)$ is zero, we see that $c_{K,0}(x)=|\\psi'_{x}|^{-1}c_{P}(x)=0$. In view of\u00a0(\\[eq:NCR.log-homogeneity-Km\\]) this show that $K_{0}(x,y)$ is homogeneous of degree $0$ with respect to $y$.\n\nLet $Q\\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be the [$\\Psi_{H}$DO]{}\u00a0with Schwartz kernel $|\\psi_{x}'|K_{0}(x,-\\psi_{x}(y))$. Then by Lemma\u00a0\\[lem:Traces.criterion-logarithmic-kernel\\] the operator $Q$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]). Moreover, observe that by Proposition\u00a0\\[prop:PsiVDO.characterisation-kernel1\\] the operator $Q$ has symbol $q\\sim \n       q_{-(d+2)}$, where for $\\xi \\neq 0$ we have $q_{-(d+2)}(x,\\xi)=(K_{0})^{\\wedge}_{{{y\\rightarrow\\xi}}}(x,\\xi)=p_{-(d+2)}(x,\\xi)$. Therefore $P-Q$ is a [$\\Psi_{H}$DO]{}\u00a0whose symbol of degree $-(d+2)$ is zero. It then follows from the part (ii) of the proof that $P-Q$ is a sum of commutators of the form\u00a0(\\[eq:Traces.sum-commutators\\]). All this shows that $P$ is the sum of two operators of the form\u00a0(\\[eq:Traces.sum-commutators\\]), so $P$ is of that form too.\n\nIn the sequel we let ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and ${\\ensuremath{\\Psi^{-\\infty}_{c}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ respectively denote the classes of [$\\Psi_{H}$DOs]{}\u00a0and smoothing operators on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ with compactly supported Schwartz kernels.\n\n\\[lem:Traces.sum-commutators.compact\\] There exists $\\Gamma \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that, for any $P\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, we have $$P= ({\\ensuremath{{\\operatorname{Res}}}}P)\\Gamma \\quad \\bmod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}), {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})].\n         \\label{eq:Traces.sum-commutators-compact}$$\n\nLet $P\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. We will put $P$ into the form\u00a0(\\[eq:Traces.sum-commutators-compact\\]) in 3 steps.\n\n\\(i) Assume first that $c_{P}(x)=0$. Then by Lemma\u00a0\\[lem:Traces.sum-commutators\\] we can write $P$ in the form, $$P=  [ x_{0}, P_{0}]+\\ldots+ [x_{d}, P_{d}], \\qquad P_{j}\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}). \n$$ Let $\\chi$ and $\\psi$ in $C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\psi(x)\\psi(y)=1$ near the support of the kernel of $P$ and $\\chi=1$ near $ {{\\operatorname{supp}}}\\psi$. Since $\\psi P \\psi=P$ we obtain $$P=\\sum_{j=0}^{d} \\psi [x_{d}, P_{d}]\\psi= \\sum_{j=0}^{d} [x_{d}, \\psi P_{d}\\psi] =\\sum_{j=0}^{d}[\\chi x_{d}, \\psi P_{d}\\psi].  \n     \\label{eq:Traces.commutators.vanishing-cP}$$ In particular $P$ is a sum of commutators in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\n\\(ii) Let $\\Gamma_{0}\\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}$ have kernel $k_{\\Gamma_{0}}(x,y)=-\\log\\|\\phi_{x}(y)\\|$ and suppose that $P=c \\Gamma_{0} \\psi$ where $c\\in \nC^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is such that $\\int c(x)dx=0$ and $\\psi \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is such that $\\psi=1$ near ${{\\operatorname{supp}}}c$. First, we have:\n\nIf $c\\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is such that $\\int c(x)dx=0$, then there exist $c_{0}, \\ldots,c_{d}$ in $C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $c=\\partial_{x_{0}}c_{0}+\\ldots+\\partial_{x_{d}}c_{d}$.\n\nWe proceed by induction on the dimension $d+1$. In dimension $1$ the proof follows from the the fact that if $c\\in \n    C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}})$ is such that $\\int_{-\\infty}^{\\infty}c(x_{0})dx_{0}=0$, then $\\tilde{c}(x_{0})=\\int_{-\\infty}^{x_{0}}c(t)dt$ is an antiderivative of $c$ with compact support.\n\nAssume now that the claim is true in dimension $d$ and under this assumption let us prove it in dimension $d+1$. Let $c\\in C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}}^{d+1})$ be such that $\\int_{{\\ensuremath{\\mathbb{R}}}^{d+1}} c(x)dx=0$. For any $(x_{0},\\ldots,x_{d-1})$ in ${\\ensuremath{\\mathbb{R}}}^{d}$ we let $\\tilde{c}(x_{0},\\ldots,x_{d-1})=\\int_{{\\ensuremath{\\mathbb{R}}}}c(x_{0},\\ldots,x_{d-1},x_{d})dx_{d}$. This defines a function in $C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}}^{d})$ such that $$\\int_{{\\ensuremath{\\mathbb{R}}}^{d}}\\tilde{c}(x_{0},\\ldots,x_{d-1})dx_{0}\\ldots dx_{d-1}= \\int_{{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}}c(x_{0},\\ldots,x_{d})dx_{0}\\ldots dx_{d}=0.\n$$ Since the claim is assumed to hold in dimension $d$, it follows that there exist $\\tilde{c}_{0}, \n \\ldots,\\tilde{c}_{d-1}$ in $C_{c}^{\\infty}({\\ensuremath{\\mathbb{R}}}^{d})$ such that $ \\tilde{c}=\\sum_{j=0}^{d-1}\\partial_{x_{j}}\\tilde{c}_{j}$.\n\nNext, let $\\varphi\\in C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}})$ be such that $\\varphi(x_{d})dx_{d}=1$. For any $(x_{0},\\ldots,x_{d})$ in ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ we let $$b(x_{0},\\ldots,x_{d})=c(x_{0},\\ldots,x_{d})-\\varphi(x_{d})\\tilde{c}(x_{0},\\ldots,x_{d-1}). \n$$ This defines a function in $C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}}^{d+1})$ such that $$\\int_{-\\infty}^{\\infty}b(x_{0},\\ldots,x_{d})dx_{d}=\\int_{-\\infty}^{\\infty}c(x_{0},\\ldots,x_{d})dx_{d}-\\tilde{c}(x_{0},\\ldots,x_{d-1})=0.\n$$ Therefore, we have $b=\\partial_{x_{d}}c_{d}$, where $c_{d}(x_{0},\\ldots,x_{d}):=\\int_{-\\infty}^{x_{d}}b(x_{0},\\ldots,x_{d-1},t)dt$ is a function in $C^{\\infty}_{c}({\\ensuremath{\\mathbb{R}}}^{d+1})$.\n\nIn addition, for $j=0,\\ldots,d-1$ and for $(x_{0},\\ldots,x_{d})$ in ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ we let $c_{j}(x_{0},\\ldots,x_{d})=\\varphi(x_{d})\\tilde{c}(x_{0},\\ldots,x_{d-1})$. Then $c_{0},,\\ldots,c_{d-1}$ belong to $C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and we have $$\\begin{gathered}\n  c(x_{0},\\ldots,x_{d})=    b(x_{0},\\ldots, x_{d})+\\varphi(x_{d})\\tilde{c}(x_{0},\\ldots,x_{d-1})  \\\\ = \\partial_{x_{d}} c_{d}(x_{0},\\ldots,x_{d}) \n     +\\varphi(x_{d})\\sum_{j=0}^{d-1}\\partial_{x_{j}}\\tilde{c}_{j}(x_{0},\\ldots,x_{d-1}) \n     = \\sum_{j=0}^{d}\\partial_{x_{j}}{c}_{j}.\n \\end{gathered}$$ This shows that the claim is true in dimension $d+1$. The proof is now complete.\n\nLet us now go back to the proof of the lemma. Since we have $\\int c(x)dx=0$ the above claim tells us that $c$ can be written in the form $c=\\sum_{j=0}^{d}\\partial_{j}c_{j}$ with $c_{0},\\ldots,c_{d}$ in $C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Observe also that the Schwartz kernel of $[\\partial_{x_{j}},\\Gamma_{0}]$ is equal to $$\\begin{gathered}\n          ( \\partial_{x_{j}}- \\partial_{y_{j}})[- \\log \\|\\psi_{x}(y)\\|] \\\\ = \\sum_{k,l}  ( \\partial_{x_{j}}- \\partial_{y_{j}}) \n          [\\varepsilon_{kl}(x)(x_{l}-y_{l})][\\partial_{z_{k}}\\log \\|z\\|]_{z=-\\psi_{x}(y)}\\\\\n          = \\sum_{k,l} (x_{k}-y_{k}) (\\partial_{x_{j}}\\varepsilon_{kl})(x) \n          \\gamma_{k}(-\\psi_{x}(y))\\|\\psi_{x}(y)\\|^{-4},\n  \\end{gathered}$$ where we have let $\\gamma_{0}(y)=\\frac{1}{2} y_{0}$ and $\\gamma_{k}(y)=y_{k}^{3}$, $k=1,\\ldots,d$. In particular $k_{[\\partial_{x_{j}},\\Gamma_{0}]}(x,y)$ has no logarithmic singularity near the diagonal, that is, we have $c_{[\\partial_{x_{j}},\\Gamma_{0}]}(x)=0$.\n\nNext, let $\\psi \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\psi=1$ near ${{\\operatorname{supp}}}c\\cup{{\\operatorname{supp}}}c_{1}\\cup \\cdots \\cup {{\\operatorname{supp}}}c_{d}$ and let $\\chi \\in \nC^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\chi=1$ near ${{\\operatorname{supp}}}\\psi$. Then we have $$\\begin{gathered}\n  [\\chi \\partial_{x_{j}}, c_{j}\\Gamma_{0}\\psi]= [\\partial_{x_{j}}, c_{j}\\Gamma_{0}\\psi] =\n    [\\partial_{x_{j}},c_{j}]\\Gamma_{0} \\psi + c_{j} \n          [\\partial_{x_{j}}, \\Gamma_{0}]\\psi+ c_{j}\\Gamma_{0}  [\\partial_{x_{j}},\\psi ]\\\\\n         = \\partial_{x_{j}}c_{j} \\Gamma_{0} \\psi + c_{j} [\\partial_{x_{j}}, \\Gamma_{0}]\\psi + c_{j}\\Gamma_{0}  \\partial_{x_{j}}\\psi.\\end{gathered}$$ Since $ c_{j}\\Gamma_{0}  \\partial_{x_{j}}\\psi$ is smoothing and $c_{c_{j} [\\partial_{x_{j}}, \\Gamma_{0}]\\psi}(x)=c_{j}c_{[\\partial_{x_{j}}, \n\\Gamma_{0}]}(x)=0$ we deduce from this that $P$ is of the form $P= \\sum_{j=0}^{d}[\\chi \\partial_{x_{j}}, c_{j}\\Gamma_{0}\\psi] +Q$ with $Q\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $c_{Q}(x)=0$. It then follows from the part (i) that $P$ belongs to the commutator space of ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\n\\(iii) Let $\\rho \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\int \\rho(x)dx=1$, let $\\psi \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\psi=1$ near ${{\\operatorname{supp}}}\\rho$, and set $\\Gamma=\\rho \\Gamma_{0}\\psi$. Let $P\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and let $\\tilde{\\psi}\\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\tilde{\\psi}=1$ near ${{\\operatorname{supp}}}c_{P}\\cup {{\\operatorname{supp}}}\\psi$. Then we have $$P=({\\ensuremath{{\\operatorname{Res}}}}P) \\Gamma + ({\\ensuremath{{\\operatorname{Res}}}}P)\\rho \\Gamma_{0}(\\tilde{\\psi}-\\psi)+ (c_{P}-({\\ensuremath{{\\operatorname{Res}}}}P)\\rho)\\Gamma_{0}\\tilde{\\psi}+ P-c_{P}\\Gamma_{0}\\tilde{\\psi}. \n    \\label{eq:Traces.decomposition-P-compact-support}$$\n\nNotice that $({\\ensuremath{{\\operatorname{Res}}}}P)\\rho \\Gamma_{0}(\\tilde{\\psi}-\\psi)$ belongs to ${\\ensuremath{\\Psi^{-\\infty}_{c}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Observe also that the logarithmic singularity of $P-c_{P}\\Gamma_{0}\\tilde{\\psi}$ is equal to $c_{P}(x)-\\tilde{\\psi}(x)c_{P}(x)=0$. Therefore, it follows from (i) that these operators belong to commutator space of ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. In addition, as $\\int (c_{P}(x)-({\\ensuremath{{\\operatorname{Res}}}}P)\\rho(x))dx=0$ we see that $(c_{P}-({\\ensuremath{{\\operatorname{Res}}}}P)\\rho)\\Gamma_{0}\\tilde{\\psi}$ is as in (ii), so it also belongs to the commutator space of ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Combining all this with\u00a0(\\[eq:Traces.decomposition-P-compact-support\\]) then shows that $P$ agrees with $({\\ensuremath{{\\operatorname{Res}}}}P) \\Gamma $ modulo a sum of commutators in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. The lemma is thus proved.\n\nNext, we quote the well known lemma below.\n\n\\[lem:Traces.smoothing-operators2\\] Any $R \\in {\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$ such that ${\\ensuremath{{\\operatorname{Tr}}}}R=0$ is the sum of two commutators in ${\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$.\n\nWe are now ready to prove the main result of this section.\n\n\\[thm:Traces.traces\\] Assume that $M$ is connected. Then any trace on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ is a constant multiple of the noncommutative residue.\n\nLet $\\tau$ be a trace on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$. By Lemma\u00a0\\[lem:Traces.sum-commutators.compact\\] there exists $\\Gamma \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that any $P=(P_{ij})$ in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}},{\\ensuremath{\\mathbb{C}}}^{r})$ can be written as $$P=\\Gamma \\otimes R \\bmod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}), {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})]\\otimes M_{r}({\\ensuremath{\\mathbb{C}}}),\n$$ where we have let $R=({\\ensuremath{{\\operatorname{Res}}}}P_{ij})\\in M_{r}({\\ensuremath{\\mathbb{C}}})$. Notice that ${\\ensuremath{{\\operatorname{Tr}}}}R= \\sum \n{\\ensuremath{{\\operatorname{Res}}}}P_{ii}={\\ensuremath{{\\operatorname{Res}}}}P$. Thus $R-\\frac{1}{r}({\\ensuremath{{\\operatorname{Res}}}}P)I_{r}$ has a vanishing trace, hence belongs to the commutator space of $M_{r}({\\ensuremath{\\mathbb{C}}})$. Therefore, we have $$P=({\\ensuremath{{\\operatorname{Res}}}}P) \\Gamma\\otimes (\\frac{1}{r}I_{r}) \\quad \\bmod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}, {\\ensuremath{\\mathbb{C}}}^{r}), {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}},{\\ensuremath{\\mathbb{C}}}^{r})].\n     \\label{eq:Traces.decomposition-P-Rd-Cr}$$\n\nLet $\\kappa:U\\rightarrow {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be a local $H$-framed chart mapping onto ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ and such that ${\\ensuremath{\\mathcal{E}}}$ is trivializable over its domain. For sake of terminology\u2019s brevity we shall call such a chart a *nice $H$-framed chart*. As $U$ is $H$-framed and is Heisenberg diffeomorphic to ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ and as${\\ensuremath{\\mathcal{E}}}$ is trivializable over $U$, it follows from\u00a0(\\[eq:Traces.decomposition-P-Rd-Cr\\]) that there exists $\\Gamma_{U}\\in \n{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|_{U}})$ such that, for any $P \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}((U,{\\ensuremath{\\mathcal{E}}}_{|_{U}})$, we have $$P=({\\ensuremath{{\\operatorname{Res}}}}P)\\Gamma_{U} \\quad \\bmod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(U,{\\ensuremath{\\mathcal{E}}}_{|_{U}}), {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(U,{\\ensuremath{\\mathcal{E}}}_{|_{U}})].\n     \\label{eq:Traces.local-form-Psivdos}$$ If we apply the trace $\\tau$, then we see that, for any $P \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(U,{\\ensuremath{\\mathcal{E}}}_{|_{U}})$, we have $$\\tau(P) = \\Lambda_{U}{\\ensuremath{{\\operatorname{Res}}}}P, \\qquad \\Lambda_{U}:=\\tau(\\Gamma_{U}).\n$$\n\nNext, let ${\\ensuremath{\\mathcal{U}}}$ be the set of points $x \\in M$ near which there a domain $V$ of a nice $H$-framed chart such that $\\Lambda_{V}=\\Lambda_{U}$. Clearly ${\\ensuremath{\\mathcal{U}}}$ is a non-empty open subset of $M$. Let us prove that ${\\ensuremath{\\mathcal{U}}}$ is closed. Let $x \\in \\overline{{\\ensuremath{\\mathcal{U}}}}$ and let $V$ be an open neighborhood of $x$ which is the domain a nice $H$-framed chart (such a neighborhood always exists). Since $x$ belongs to the closure of ${\\ensuremath{\\mathcal{U}}}$ the set ${\\ensuremath{\\mathcal{U}}}\\cup V$ is non-empty. Let $y \\in {\\ensuremath{\\mathcal{U}}}\\cup V$. As $y$ belongs to ${\\ensuremath{\\mathcal{U}}}$ there exists an open neighborhood $W$ of $y$ which is the domain a nice $H$-frame chart such that $\\Lambda_{W}=\\Lambda_{U}$. Then for any $P$ in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(V\\cap W, {\\ensuremath{\\mathcal{E}}}_{|V\\cap W})$ we have $\\tau(P)=\\Lambda_{V}{\\ensuremath{{\\operatorname{Res}}}}P =\\Lambda_{W}{\\ensuremath{{\\operatorname{Res}}}}P$. Choosing $P$ so that ${\\ensuremath{{\\operatorname{Res}}}}P\\neq 0$ then shows that $\\Lambda_{V}=\\Lambda_{W}=\\Lambda_{U}$. Since $V$ contains $x$ and is a domain of a nice $H$-framed chart we deduce that $x$ belongs to ${\\ensuremath{\\mathcal{U}}}$. Hence ${\\ensuremath{\\mathcal{U}}}$ is both closed and open. As $M$ is connected it follows that ${\\ensuremath{\\mathcal{U}}}$ agrees with $M$. Therefore, if we set $\\Lambda=\\Lambda_{U}$ then, for any domain $V$ of a nice $H$-framed chart, we have $$\\tau(P)=\\Lambda {\\ensuremath{{\\operatorname{Res}}}}P \\qquad \\forall P \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(V,{\\ensuremath{\\mathcal{E}}}_{|_{V}}).\n     \\label{eq:Traces.mutiple-local}$$\n\nNow, let $(\\varphi_{i})$ be a finite partition of the unity subordinated to an open covering $(U_{i})$ of $M$ by domains of nice $H$-framed charts. For each index $i$ let $\\psi_{i}\\in C^{\\infty}_{c}(U_{i})$ be such that $\\psi_{i}=1$ near ${{\\operatorname{supp}}}\\varphi_{i}$. Then any $P \\in \n{\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ can be written as $P=\\sum \\varphi_{i} P\\psi_{i}+R$, where $R$ is a smoothing operator whose kernel vanishes near the diagonal of $M\\times M$. In particular we have ${\\ensuremath{{\\operatorname{Trace}}}}R=0$, so by Lemma\u00a0\\[lem:Traces.smoothing-operators2\\] the commutator space of ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ contains $R$. Since each operator $\\varphi_{i} P\\psi_{i}$ can be seen as an element of ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}(U_{i},{\\ensuremath{\\mathcal{E}}}_{|_{U_{i}}})$, using\u00a0(\\[eq:Traces.mutiple-local\\]) we get $$\\tau(P)=\\sum \\tau(\\varphi_{i}P\\psi_{i}) = \\sum \\Lambda {\\ensuremath{{\\operatorname{Res}}}}\\varphi_{i}P\\psi_{i}=\\Lambda {\\ensuremath{{\\operatorname{Res}}}}P.\n$$ Hence we have $\\tau =\\Lambda {\\ensuremath{{\\operatorname{Res}}}}$. This shows that any trace on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ is proportional to the noncommutative residue.\n\nSince the dual of ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})/[{\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}}),{\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})]$ is isomorphic to the space of traces on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$, as a consequence of Theorem\u00a0\\[thm:Traces.traces\\] we get:\n\nAssume $M$ connected. Then an operator $P \\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ is a sum of commutators in ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ if and only if its noncommutative residue vanishes.\n\nIn\u00a0[@EM:HAITH] Epstein and Melrose computed the Hochschild homology of the algebra of symbols ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})/{\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$ when $(M,H)$ is a contact manifold. In fact, as the algebra ${\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$ is $H$-unital and its Hochschild homology is known, the long exact sequence of\u00a0[@Wo:LESCHAEA] holds and allows us to relate the Hochschild homology of ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ to that of ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})/{\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$. In particular, we can recover from this that the space of traces on ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ is one-dimensional when the manifold is connected.\n\nAnalytic Applications on general Heisenberg manifolds {#sec:Analytic-Applications}\n=====================================================\n\nIn this section we derive several analytic applications of the construction of the noncommutative residue trace for the Heisenberg calculus. First, we deal with zeta functions of hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0and relate their singularities to the heat kernel asymptotics of the corresponding operators. Second, we give logarithmic metric estimates for Green kernels of hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0 whose order is equal to the Hausdorff dimension $\\dim M +1$. This connects nicely with previous results of Fefferman, Stein and their students and collaborators. Finally, we show that the noncommutative residue for the Heisenberg calculus allows us to extend the Dixmier trace to the whole algebra of integer order [$\\Psi_{H}$DOs]{}. This is the analogue for the Heisenberg calculus of a well-known result of Alain Connes.\n\nZeta functions of hypoelliptic [$\\Psi_{H}$DOs]{}\n------------------------------------------------\n\nLet $(M^{d+1}, H)$ be a compact Heisenberg manifold equipped with a smooth density\u00a0$>0$, let ${\\ensuremath{\\mathcal{E}}}$ be a Hermitian vector bundle over $M$ of rank $r$, and let $P:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a [$\\Psi_{H}$DO]{}\u00a0of integer order $m\\geq 1$ with an invertible principal symbol. In addition, assume that there is a ray $L_{\\theta}=\\{\\arg \\lambda =\\theta\\}$ which is is not through an eigenvalue of $P$ and is a principal cut for the principal symbol $\\sigma_{m}(P)$ as in Section\u00a0\\[sec:Heisenberg-calculus\\].\n\nLet $(P_{\\theta}^{s})_{s\\in {\\ensuremath{\\mathbb{C}}}}$ be the associated family of complex powers associated to $\\theta$ as in Proposition\u00a0\\[prop:Heisenberg.powers2\\]. Since $(P_{\\theta}^{s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ is a holomorphic family of [$\\Psi_{H}$DOs]{}, Proposition\u00a0\\[thm:NCR.TR.global\\] allows us to directly define the zeta function $\\zeta_{\\theta}(P;s)$ as the meromorphic function, $$\\zeta_{\\theta}(P;s):={\\ensuremath{{\\operatorname{TR}}}}P_{\\theta}^{-s}, \\qquad s \\in {\\ensuremath{\\mathbb{C}}}.\n$$\n\n\\[prop:Zeta.zeta-function\\] Let $\\Sigma=\\{-\\frac{d+2}{m}, -\\frac{d+1}{m},\\ldots, \\frac{-1}{m},\\frac{1}{m}, \n    \\frac{2}{m}, \\ldots\\}$. Then the function $\\zeta_{\\theta}(P;s)$ is analytic outside $\\Sigma$, and on $\\Sigma$ it has at worst simple pole singularities such that $${\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma}\\zeta_{\\theta}(P;s)=m{\\ensuremath{{\\operatorname{Res}}}}P^{-\\sigma}_{\\theta}, \\qquad \\sigma\\in \\Sigma. \n     \\label{eq:Zeta.residue-zeta}$$ In particular, $\\zeta_{\\theta}(P;s)$ is always regular at $s=0$.\n\nSince ${{{\\operatorname{ord}}}}P_{\\theta}^{-s}=ms$ it follows from Proposition\u00a0\\[thm:NCR.NCR\\] that $\\zeta_{\\theta}(P;s)$ is analytic outside $\\Sigma':=\\Sigma\\cup\\{0\\}$ and on $\\Sigma'$ has at worst simple pole singularities satisfying\u00a0(\\[eq:Zeta.residue-zeta\\]). At $s=0$ we have $ {\\ensuremath{{\\operatorname{Res}}}}_{s=0}\\zeta_{\\theta}(P;s)=m{\\ensuremath{{\\operatorname{Res}}}}P^{0}_{\\theta}=m{\\ensuremath{{\\operatorname{Res}}}}[1-\\Pi_{0}(P)]$, but as $\\Pi_{0}(P)$ is a smoothing operator we have ${\\ensuremath{{\\operatorname{Res}}}}[1-\\Pi_{0}(P)]=-{\\ensuremath{{\\operatorname{Res}}}}\\Pi_{0}(P)=0$. Thus $\\zeta_{\\theta}(P;s)$ is regular at $s=0$.\n\nAssume now that $P$ is selfadjoint and the union set of its principal cuts is $\\Theta(P)={\\ensuremath{\\mathbb{C}}}\\setminus [0,\\infty)$. This implies that $P$ is bounded from below (see\u00a0[@Po:CPDE1]), so its spectrum is real and contains at most finitely many negative eigenvalues. We will use the subscript $\\uparrow$ (resp.\u00a0$\\downarrow$) to refer to a spectral cutting in the upper halfplane $\\Im \\lambda>0$ (resp.\u00a0lower halfplane $\\Im \n\\lambda<0$).\n\nSince $P$ is bounded from below it defines a heat semigroup $e^{-tP}$, $t\\geq 0$, and, as the principal symbol of $P$ is invertible, for $t>0$ the operator $e^{-tP}$ is smoothing, hence has a smooth Schwartz kernel $k_{t}(x,y)$ in $C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}}){\\hat\\otimes}C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}}^{*}\\otimes |\\Lambda|(M))$. Moreover, as $t\\rightarrow 0^{+}$ we have the heat kernel asymptotics, $$k_{t}(x,x)\\sim t^{-\\frac{d+2}{m}}\\sum_{j\\geq 0} t^{\\frac{j}{m}}a_{j}(P)(x) + \\log t\\sum_{k\\geq 0}t^{k}b_{k}(P)(x),\n     \\label{eq:Zeta.heat-kernel-asymptotics}$$ where the asymptotics takes place in $C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}\\otimes |\\Lambda|(M))$, and when $P$ is a differential operator we have $a_{2j-1}(P)(x)=b_{j}(P)(x)=0$ for all $j\\in {\\ensuremath{\\mathbb{N}}}$ (see\u00a0[@BGS:HECRM], [@Po:MAMS1] when $P$ is a differential operator and see\u00a0[@Po:CPDE1] for the general case).\n\n\\[prop:Zeta.heat-zeta-local\\] For $j=0,1,\\ldots$ set $\\sigma_{j}=\\frac{d+2-j}{m}$. Then:\n\n1\\) When $\\sigma_{j}\\not \\in {\\ensuremath{\\mathbb{Z}}}_{-}$ we have $${\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma_{j}}t_{P_{{\\uparrow \\downarrow}}^{-s}}(x)=m c_{P^{-\\sigma_{j}}}(x) = \\Gamma(\\sigma_{j})^{-1}a_{j}(P)(x).\n      \\label{eq:Zeta.tPs-heat1}\n$$ 2) For $k=1,2,\\ldots$ we have $$\\begin{gathered}\n       {\\ensuremath{{\\operatorname{Res}}}}_{s=-k}t_{P_{{\\uparrow \\downarrow}}^{-s}}(x)=m c_{P^{k}}(x) = (-1)^{k+1}k!b_{k}(P)(x),\n             \\label{eq:Zeta.tPs-heat2}\\\\\n       \\lim_{s\\rightarrow -k}[t_{P_{{\\uparrow \\downarrow}}^{-s}}(x)-m (s+k)^{-1}c_{P^{k}}(x)] = (-1)^{k}k! a_{d+2+mk}(P)(x).\\end{gathered}$$ 3) For $k=0$ we have $$\\lim_{s\\rightarrow 0} t_{P_{{\\uparrow \\downarrow}}^{-s}}(x) =a_{d+2}(P)(x)-t_{\\Pi_{0}}(x).   \n     \\label{eq:Zeta.tPs-heat4}$$\n\nWhen $P$ is positive and invertible the result is a standard consequence of the Mellin formula (see, e.g., [@Gi:ITHEASIT]). Here it is slightly more complicated because we don\u2019t assume that $P$ is positive or invertible.\n\nFor $\\Re s>0$ set $Q_{s}= \\Gamma(s)^{-1}\\int_{0}^{1}t^{s-1}e^{-tP}dt$. Then we have:\n\nThe family $(Q_{s})_{\\Re s>0}$ can be uniquely extended to a holomorphic family of [$\\Psi_{H}$DOs]{}\u00a0parametrized by ${\\ensuremath{\\mathbb{C}}}$ in such way that:\n\n\\(i) The families $(Q_{s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ and $(P_{{\\uparrow \\downarrow}}^{-s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ agree up to a holomorphic family of smoothing operators;\n\n\\(ii) We have $Q_{0}=1$ and $Q_{-k}=P^{k}$ for any integer $k\\geq 1$.\n\nFirst, let $\\Pi_{+}(P)$ and $\\Pi_{-}(P)$ denote the orthogonal projections onto the positive and negative eigenspaces of $P$. Notice that $\\Pi_{-}(P)$ is a smoothing operator because $P$ has at most only finitely many negative eigenvalues. For $\\Re s>0$ the Mellin formula allows us to write $$P_{{\\uparrow \\downarrow}}^{-s}=\\Pi_{-}(P) P_{{\\uparrow \\downarrow}}^{-s}+\\Gamma(s)^{-1}\\int_{0}^{\\infty}t^{s}\\Pi_{+}(P)e^{-tP}\\frac{dt}{t}=Q_{s}+R_{{\\uparrow \\downarrow}}(s),\n    \\label{eq:Zeta.claim-heat.PQs}\\\\$$ where $R_{{\\uparrow \\downarrow}}(s)$ is equal to $$\\Pi_{-}(P) P_{{\\uparrow \\downarrow}}^{-s}-s^{-1}\\Gamma(s)^{-1}\\Pi_{0}(P)-\\Pi_{-}(P)\\int_{0}^{1}t^{s}e^{-tP}\\frac{dt}{t}+ \n        \\int_{1}^{\\infty} t^{s}\\Pi_{+}(P)e^{-tP}\\frac{dt}{t}.\n$$ Notice that $ (\\Pi_{-}(P) P_{{\\uparrow \\downarrow}}^{-s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ and $(s^{-1}\\Gamma(s)^{-1}\\Pi_{0}(P))_{s \\in {\\ensuremath{\\mathbb{C}}}}$ are holomorphic families of smoothing operators because $\\Pi_{-}(P)$ and $\\Pi_{0}(P)$ are smoothing operators. Moreover, upon writing $$\\begin{gathered}\n    \\Pi_{-}(P)\\int_{0}^{1}t^{s}e^{-tP}\\frac{dt}{t}=\\Pi_{-}(P)(\\int_{0}^{1} t^{s}e^{-tP}\\frac{dt}{t})\\Pi_{-}(P),\\\\ \n    \\int_{1}^{\\infty} t^{s}\\Pi_{+}(P)e^{-tP}\\frac{dt}{t}=  e^{-\\frac{1}{4}P}(\\int_{1/2}^{\\infty} t^{s}\\Pi_{+}(P)e^{-tP}\\frac{dt}{t})e^{-\\frac{1}{4}P},\n$$ we see that $( \\Pi_{-}(P)\\int_{0}^{1}t^{s}e^{-tP}\\frac{dt}{t})_{\\Re s>0}$ and $( \\int_{1}^{\\infty} t^{s}\\Pi_{+}(P)e^{-tP}\\frac{dt}{t})_{\\Re s>0}$ are holomorphic families of smoothing operators. Therefore $(R_{{\\uparrow \\downarrow}}(s))_{\\Re s>0}$ is a holomorphic family of smoothing operators and using\u00a0(\\[eq:Zeta.claim-heat.PQs\\]) we see that $(Q_{s})_{\\Re s>0}$ is a holomorphic family of [$\\Psi_{H}$DOs]{}.\n\nNext, an integration by parts gives $$\\Gamma(s+1)P Q_{s+1}= \\int_{0}^{1} \n        t^{s}\\frac{d}{dt}(e^{-tP})=  e^{-P} + s  \\int_{0}^{1} \n        t^{s-1} e^{-tP}dt. \n$$ Since $\\Gamma(s+1)=s\\Gamma(s)$ we get $$Q_{s}= P Q_{s+1} - \\Gamma(s+1)^{-1}e^{-P}, \\qquad \\Re s>0.\n    \\label{eq:Zeta.Qs-extension1}$$ An easy induction then shows that for $k=1,2,\\ldots$ we have $$Q_{s}= P^{k} Q_{s+k} - \\Gamma(s+k)^{-1}P^{k-1}e^{-P}+\\ldots +(-1)^{k}\\Gamma(s+1)^{-1}e^{-P}.\n     \\label{eq:Zeta.Qs-extension2}$$ It follows that the family $(Q_{s})_{\\Re s>0}$ has a unique analytic continuation to each half-space $\\Re s>-k$ for $k=1,2,\\ldots$, so it admits a unique analytic continuation to ${\\ensuremath{\\mathbb{C}}}$. Furthermore, as for $\\Re s>-k$ we have $P^{-s}_{{\\uparrow \\downarrow}}=P^{k}P^{-(s+k)}_{{\\uparrow \\downarrow}}$ we get $$Q_{s}-P^{-s}_{{\\uparrow \\downarrow}}=P^{k} R_{{\\uparrow \\downarrow}}(s+k) -\\Gamma(s+k)^{-1}P^{k-1}e^{-P}+\\ldots +(-1)^{k}\\Gamma(s+1)^{-1}e^{-P},\n$$ from which we deduce that $(Q_{s}-P^{-s}_{{\\uparrow \\downarrow}})_{\\Re s >-k}$ is a holomorphic family of smoothing operators. Hence the families $(Q_{s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ and $(P^{-s}_{{\\uparrow \\downarrow}})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ agree up to a holomorphic family of smoothing operators.\n\nFinally, we have $$Q_{1}=\\Pi_{0}(P)+\\int_{0}^{1}(1-\\Pi_{0}(P))e^{-tP}dt=\\Pi_{0}(P)-P^{-1}(e^{-P}-1).\n$$ Thus setting $s=1$ in\u00a0(\\[eq:Zeta.Qs-extension1\\]) gives $$\\begin{gathered}\n    Q_{0}=P[\\Pi_{0}(P)-P^{-1}(e^{-P}-1)]+e^{-P} =  -(1-\\Pi_{0}(P))(e^{-P}-1)+e^{-P}\\\\ = 1-\\Pi_{0}(P)+\\Pi_{0}e^{-P}=1.\n     \\label{eq:Zeta.Q0}\\end{gathered}$$ Furthermore, as $\\Gamma(s)^{-1}$ vanishes at every non-positive integer, from\u00a0(\\[eq:Zeta.Qs-extension2\\]) and\u00a0(\\[eq:Zeta.Q0\\]) we see that we have $Q_{-k}=P^{k}Q_{0}=P^{k}$ for any integer $k\\geq 1$. The proof of the claim is thus achieved.\n\nNow, for $j=0,1,\\ldots$ we set $\\sigma_{j}=\\frac{d+2-j}{m}$. As $(R_{{\\uparrow \\downarrow}}(s))_{s \\in {\\ensuremath{\\mathbb{C}}}}:=(P_{{\\uparrow \\downarrow}}^{-s}-Q_{s})_{s \\in {\\ensuremath{\\mathbb{C}}}}$ is a holomorphic family of smoothing operators, the map $s \\rightarrow \nt_{R_{{\\uparrow \\downarrow}}(s)}(x)$ is holomorphic from ${\\ensuremath{\\mathbb{C}}}$ to $C^{\\infty}(M, |\\Lambda|(M)\\otimes {\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}})$. By combining this with Proposition\u00a0\\[prop:Zeta.zeta-function\\] we deduce that for $j=0,1,\\ldots$ we have $${\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma_{j}}t_{P_{{\\uparrow \\downarrow}}^{-s}}(x)=m c_{P^{-\\sigma_{j}}}(x) =  {\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma_{j}}t_{Q_{s}}(x),\n     \\label{eq:Zeta.tPs-TQs'1}$$ Moreover, as for $k=1,2,\\ldots$ we have $R_{{\\uparrow \\downarrow}}(-k)=0$ we also see that $$\\begin{gathered}\n  \\lim_{s\\rightarrow -k}[t_{P_{{\\uparrow \\downarrow}}^{-s}}(x)-m (s+k)^{-1}c_{P^{k}}(x)] \\\\ =     \\lim_{s\\rightarrow -k}[t_{Q_{s}}(x)-(s+k)^{-1}{\\ensuremath{{\\operatorname{Res}}}}_{s=-k}t_{Q_{s}}(x)].\\end{gathered}$$ Similarly, as $P_{{\\uparrow \\downarrow}}^{0}=1-\\Pi_{0}(P)=Q_{0}-\\Pi_{0}(P)$ we get $$\\lim_{s\\rightarrow 0} t_{P_{{\\uparrow \\downarrow}}^{-s}}(x) =\\lim_{s\\rightarrow 0}t_{Q_{s}}(x)-t_{\\Pi_{0}}(x).\n           \\label{eq:Zeta.tPs-TQs'3}$$\n\nNext, let $k_{Q_{s}}(x,y)$ denote the kernel of $Q_{s}$. As $Q_{s}$ has order $-m s$, for $\\Re s>-\\frac{d+2}{m}$ this is a trace-class operator and thanks to\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) we have $$\\Gamma(s) k_{Q_{s}}(x,x)= \\int_{0}^{1}t^{s-1}k_{t}(x,x) dt.\n$$ Moreover\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) implies that, for any integer $N\\geq 0$, in $C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}\\otimes |\\Lambda|(M))$ we have $$k_{t}(x,x)=\\sum_{-\\sigma_{j}<N}t^{-\\sigma_{j}}a_{j}(P)(x)+\\sum_{k<N}(t^{k}\\log t)b_{k}(P)(x) +{\\operatorname{O}}(t^{N}). \n$$ Therefore, for $\\Re s >\\frac{d+2}{m}$ the density $\\Gamma(s)k_{Q_{s}}(x,x)$ is of the form $$\\sum_{\\sigma_{j}<N}(\\int_{0}^{1}t^{s-\\sigma_{j}}\\frac{dt}{t})a_{j}(P)(x)+ \n      \\sum_{k<N}(\\int_{0}^{1}t^{k+s}\\log t \\frac{dt}{t})b_{k}(P)(x) + \\Gamma(s) h_{N,s}(x),\n$$ with $h_{N,s}(x) \\in {{\\operatorname{Hol}}}(\\Re s>-N, C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}{\\ensuremath{\\mathcal{E}}}\\otimes |\\Lambda|(M))$. Since for $\\alpha >0$ we have $$\\int_{0}^{1}t^{\\alpha}\\log t \\frac{dt}{t}=-\\frac{1}{\\alpha}\\int_{0}^{1}t^{\\alpha-1}dt = -\\frac{1}{\\alpha},\n$$ we see that $k_{Q_{s}}(x,x)$ is equal to $$\\Gamma(s)^{-1} \\sum_{\\sigma_{j}<N}\\frac{1}{s+\\sigma_{j}}a_{j}(P)(x)-\n     \\Gamma(s)^{-1}  \\sum_{k<N}\\frac{1}{(s+k)^{2}}b_{k}(P)(x) + h_{N,s}(x). \n$$ Since $\\Gamma(s)$ is analytic on ${\\ensuremath{\\mathbb{C}}}\\setminus ({\\ensuremath{\\mathbb{Z}}}_{-}\\cup\\{0\\})$ and for $k=0,1,\\ldots$ near $s=-k$ we have $\\Gamma(s)^{-1}\\sim (-1)^{k}k!(s+k)^{-1}$ , we deduce that:\n\n- when $\\sigma_{j}\\not \\in {\\ensuremath{\\mathbb{N}}}$ we have $ {\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma_{j}}t_{Q_{s}}(x)= \\Gamma(\\sigma_{j})^{-1}a_{j}(P)(x)$.\n\n- for $k=1,2,\\ldots$ we have $$\\begin{gathered}\n {\\ensuremath{{\\operatorname{Res}}}}_{s=-k}t_{Q_{s}}(x)= (-1)^{k+1}k!b_{k}(P)(x),\\\\\n       \\lim_{s\\rightarrow -k}[t_{Q_{s}}(x)-(s+k)^{-1}{\\ensuremath{{\\operatorname{Res}}}}_{s=-k}t_{Q_{s}}(x)] = (-1)^{k}k! a_{d+2+mk}(P)(x).\n   \\end{gathered}$$ - for $k=0$ we have $\\lim_{s\\rightarrow 0} t_{Q_{s}}(x) =a_{d+2}(P)(x)$.\n\nCombining this with\u00a0(\\[eq:Zeta.tPs-TQs\u20191\\])\u2013(\\[eq:Zeta.tPs-TQs\u20193\\]) then proves the equalities\u00a0(\\[eq:Zeta.tPs-heat1\\])\u2013(\\[eq:Zeta.tPs-heat4\\]).\n\nFrom Proposition\u00a0\\[prop:Zeta.heat-zeta-local\\] we immediately get:\n\n\\[prop:Zeta.heat-zeta-global\\] 1) For $j=0,1,\\ldots$ let $\\sigma_{j}=\\frac{d+2-j}{m}$. When $\\sigma_{j}\\not \\in {\\ensuremath{\\mathbb{Z}}}_{-}$ we have: $${\\ensuremath{{\\operatorname{Res}}}}_{s=\\sigma_{j}}\\zeta_{{\\uparrow \\downarrow}}(P;s) =m {\\ensuremath{{\\operatorname{Res}}}}P^{-\\sigma_{j}}= \\Gamma(\\sigma_{j})^{-1}\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}a_{j}(P)(x).\n      \\label{eq:Zeta.heat-zeta-global1}$$ 2) For $k=1,2,\\ldots$ we have $$\\begin{gathered}\n      {\\ensuremath{{\\operatorname{Res}}}}_{s=-k}\\zeta_{{\\uparrow \\downarrow}}(P;s) =m {\\ensuremath{{\\operatorname{Res}}}}P^{k} = (-1)^{k+1}k!\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}b_{k}(P)(x), \\\\\n       \\lim_{s\\rightarrow -k}[\\zeta_{{\\uparrow \\downarrow}}(P;s)-m (s+k)^{-1} {\\ensuremath{{\\operatorname{Res}}}}P^{k}] = (-1)^{k}k! \\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} a_{d+2+mk}(P)(x).\\end{gathered}$$ 3) For $k=0$ we have $$\\zeta_{{\\uparrow \\downarrow}}(P;0)=\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} a_{d+2}(P)(x)-\\dim \\ker P.\n$$\n\nNext, for $k=0,1,\\ldots$ let $\\lambda_{k}(P)$ denote the $(k+1)$\u2019th eigenvalue of $P$ counted with multiplicity. Then by\u00a0[@Po:MAMS1] and [@Po:CPDE1] as $k\\rightarrow \\infty$ we have the Weyl asymptotics, $$\\lambda_{k}(P)\\sim \\left(\\frac{k}{\\nu_{0}(P)}\\right)^{\\frac{m}{d+2}}, \\qquad \\nu_{0}(P)=\\Gamma(1+\\frac{d+2}{m})^{-1} \\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}a_{0}(P)(x).\n     \\label{eq:Zeta.Weyl-asymptotics1}$$\n\nNow, by Proposition\u00a0\\[prop:Zeta.heat-zeta-global\\] we have $$\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}a_{0}(P)(x)=m\\Gamma(\\frac{d+2}{m}){\\ensuremath{{\\operatorname{Res}}}}P^{-\\frac{d+2}{m}}=\\frac{1}{d+2}  \\Gamma(1+\\frac{d+2}{m}){\\ensuremath{{\\operatorname{Res}}}}P^{-\\frac{d+2}{m}},\n$$ Therefore, we obtain:\n\n\\[prop:Zeta.Weyl-asymptotics\\] As $k\\rightarrow \\infty$ we have $$\\lambda_{k}(P)\\sim \\left(\\frac{k}{\\nu_{0}(P)}\\right)^{\\frac{m}{d+2}}, \\qquad \\nu_{0}(P)= (d+2)^{-1}{\\ensuremath{{\\operatorname{Res}}}}P^{-\\frac{d+2}{m}}.\n$$\n\nFinally, we can make use of Proposition\u00a0\\[prop:Zeta.heat-zeta-global\\] to prove a local index formula for hypoelliptic [$\\Psi_{H}$DOs]{}\u00a0in the following setting. Assume that ${\\ensuremath{\\mathcal{E}}}$ admits a ${\\ensuremath{\\mathbb{Z}}}_{2}$-grading ${\\ensuremath{\\mathcal{E}}}={\\ensuremath{\\mathcal{E}}}^{+}\\oplus {\\ensuremath{\\mathcal{E}}}_{-}$ and let $D:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a selfadjoint [$\\Psi_{H}$DO]{}\u00a0of integer order $m\\geq 1$ with an invertible principal symbol and of the form, $$D= \\left( \n    \\begin{array}{cc}\n        0& D_{-}  \\\\ \n        D_{+}& 0\n    \\end{array}\n    \\right), \\qquad D_{\\pm}:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}}_{\\pm}) \\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}}_{\\mp}).$$ Notice that the selfadjointness of $D$ means that $D_{+}^{*}=D_{-}$.\n\nSince $D$ has an invertible principal symbol and $M$ is compact we see that $D$ is invertible modulo finite rank operators, hence is Fredholm. Then we let $${{\\operatorname{ind}}}D:= {{\\operatorname{ind}}}D_{+}=\\dim \\ker D_{+}-\\dim \\ker D_{-}.\n$$\n\nUnder the above assumptions we have $${{\\operatorname{ind}}}D=\\int_{M} {{\\operatorname{str}}}_{{\\ensuremath{\\mathcal{E}}}} a_{d+2}(D^{2})(x), \n$$ where ${{\\operatorname{str}}}_{{\\ensuremath{\\mathcal{E}}}}:={{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}^{+}}-{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}^{-}}$ denotes the supertrace on the fibers of ${\\ensuremath{\\mathcal{E}}}$.\n\nWe have $D^{2} = \\left( \n    \\begin{array}{cc}\n        D_{-}D_{+}& 0  \\\\\n        0 &  D_{+}D_{-}\n    \\end{array}\n    \\right)$ and $D_{\\mp} D_{\\pm}=D_{\\pm}^{*}D_{\\pm}$. In particular, $D_{\\mp} D_{\\pm}$ is a positive operators with an invertible principal symbol. Moreover, for $\\Re s >\\frac{d+2}{2m}$ the difference $  \\zeta(D_{-}D_{+};s) -\\zeta(D_{+}D_{-};s) $ is equal to $$\\sum_{\\lambda>0} \\lambda^s (\\dim\\ker (D_{-}D_{+} -\\lambda) - \n            \\dim\\ker (D_{+}D_{-} -\\lambda)) = 0,\n$$ for $D$ induces for any $\\lambda>0$ a bijection between $\\ker (D_{-}D_{+}-\\lambda)$ and $\\ker \n    (D_{+}D_{-} -\\lambda)$ (see, e.g.,\u00a0[@BGV:HKDO]). By analytic continuation this yields $ \\zeta(D_{-}D_{+};0) -\\zeta(D_{+}D_{-};0)=0$. On the other hand, by Proposition\u00a0\\[prop:Zeta.heat-zeta-global\\] we have $$\\zeta(D_{\\mp} D_{\\pm};0) = \\int_{M} {{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}_{\\pm}}a_{d+2}(D_{\\mp} D_{\\pm})(x)-\\dim \\ker D_{\\mp} D_{\\pm}.\n$$ Since $\\dim \\ker D_{\\mp} D_{\\pm}=\\dim \\ker D_{\\pm}$ we deduce that ${{\\operatorname{ind}}}D$ is equal to $$\\int_{M} {{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}_{+}}a_{d+2}(D_{+}D_{-})(x)- \\int_{M} {{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}_{-}}a_{d+2}(D_{-}D_{+})(x)= \\int_{M} {{\\operatorname{str}}}_{{\\ensuremath{\\mathcal{E}}}}a_{d+2}(D^{2})(x).\n     $$ The proof is thus achieved.\n\nMetric estimates for Green kernels of hypoelliptic [$\\Psi_{H}$DOs]{}\n--------------------------------------------------------------------\n\nConsider a compact Heisenberg manifold $(M^{d+1},H)$ endowed with a positive density and let ${\\ensuremath{\\mathcal{E}}}$ be a Hermitian vector bundle over $M$. In this subsection we shall prove that the positivity of a hypoelliptic [$\\Psi_{H}$DO]{}\u00a0pertains in its logarithmic singularity when it has order $-(\\dim \nM+1)$. As a consequence this will allow us to derive some metric estimates for Green kernels of hypoelliptic [$\\Psi$DOs]{}.\n\nLet $P:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a [$\\Psi_{H}$DO]{}\u00a0of order $m>0$ whose principal symbol is invertible and is positive in the sense of\u00a0[@Po:MAMS1], i.e., we can write $\\sigma_{m}(P)=q*q^{*}$ with $q\\in S_{\\frac{m}{2}}({\\ensuremath{\\mathfrak{g}}}^{*}M,{\\ensuremath{\\mathcal{E}}})$. The main technical result of this section is the following.\n\n\\[prop:Metric.positivity-cP\\] The density ${{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P^{-\\frac{d+2}{m}}}(x)$ is\u00a0$>0$.\n\nWe will prove Proposition\u00a0\\[prop:Metric.positivity-cP\\] later on in the section. As a first consequence, by combining with Proposition\u00a0\\[prop:Zeta.heat-zeta-local\\] we get:\n\nLet $a_{0}(P)(x)$ be the leading coefficient in the small time heat kernel asymptotics\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) for $P$. Then the density ${{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}a_{0}(P)(x)$ is\u00a0$>0$.\n\nAssume now that the bracket condition $H+[H,H]=TM$ holds, i.e., $H$ is a Carnot-Carath\u00e9odory distribution in the sense of\u00a0[@Gr:CCSSW]. Let $g$ be a Riemannian metric on $H$ and let $d_{H}(x,y)$ be the associated Carnot-Carath\u00e9odory metric on $M$. Recall that for two points $x$ and $y$ of $M$ the value of $d_{H}(x,y)$ is the infinum of the lengths of all closed paths joining $x$ to $y$ that are tangent to $H$ at each point (such a path always exists by Chow Lemma). Moreover, the Hausdorff dimension of $M$ with respect to $d_{H}$ is equal to $\\dim M+1$.\n\nIn the setting of general Carath\u00e9odory distributions there has been lot of interest by Fefferman, Stein and their collaborators for giving metric estimates for the singularities of the Green kernels of hypoelliptic sublaplacians (see, e.g., [@FS:FSSOSO], [@Ma:EPKLCD], [@NSW:BMDVF1], [@Sa:FSGSSVF]). This allows us relate the analysis of the hypoelliptic sublaplacian to the metric geometry of the underlying manifold.\n\nAn important result is that it follows from the maximum principle of Bony\u00a0[@Bo:PMIHUPCOED] that the Green of kernel of a selfadjoint hypoelliptic sublaplacian is positive near the diagonal. In general the positivity of the principal symbol does not pertain in the Green kernel. However, by making use of Proposition\u00a0\\[prop:Metric.positivity-cP\\] we shall prove:\n\n\\[thm:Metric.metric-estimate\\] Assume that $H+[H,H]=TM$ and let $P:C^{\\infty}(M)\\rightarrow C^{\\infty}(M)$ be a [$\\Psi_{H}$DO]{}\u00a0of order $m>0$ whose principal symbol is invertible and is positive. Let $k_{P^{-\\frac{d+2}{m}}}(x,y)$ be the Schwartz kernel of $P^{-\\frac{d+2}{m}}$. Then near the diagonal we have $$k_{P^{-\\frac{d+2}{m}}}(x,y)\\sim -c_{P^{-\\frac{d+2}{m}}}(x)\\log d_{H}(x,y).\n       \\label{eq:Metric.metric-estimate}$$ In particular $k_{P^{-\\frac{d+2}{m}}}(x,y)$ is\u00a0$>0$ near the diagonal.\n\nIt is enough to proceed in an open of $H$-framed local coordinates $U\\subset {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$. For $x \\in U$ let $\\psi_{x}$ be the affine change to the corresponding privileged coordinates at $x$. Since by Proposition\u00a0\\[prop:Metric.positivity-cP\\] we have $c_{P^{-\\frac{d+2}{m}}}(x)>0$, using Proposition\u00a0\\[thm:NCR.log-singularity\\] we see that near the diagonal we have $ k_{P^{-\\frac{d+2}{m}}}(x,y) \\sim -c_{P^{-\\frac{d+2}{m}}}(x)\\log\\|\\psi_{x}(y)\\|$. Incidentally, we see that $k_{P^{-\\frac{d+2}{m}}}(x,y)$ is positive near the diagonal.\n\nOn the other hand, since $H$ has codimension one our definition of the privileged coordinates agrees with that of\u00a0[@Be:TSSRG]. Therefore, it follows from\u00a0[@Be:TSSRG Thm.\u00a07.34] that the ratio $\\frac{d_{H}(x,y)}{\\|\\psi_{x}(y)\\|}$ remains bounded in $(0, \\infty)$ near the diagonal, that is, we have $\\log d_{H}(x,y)\\sim \\log \\|\\psi_{x}(y)\\|$. It then follows that near the diagonal we have $ k_{P^{-\\frac{d+2}{m}}}(x,y)\\sim -c_{P^{-\\frac{d+2}{m}}}(x)\\log d_{H}(x,y)$. The theorem is thus proved.\n\nIt remains now to prove Proposition\u00a0\\[prop:Metric.positivity-cP\\]. To this end recall that for an operator $Q\\in {\\ensuremath{\\Psi_{H}}}^{l}(M,{\\ensuremath{\\mathcal{E}}})$, $l\\in {\\ensuremath{\\mathbb{C}}}$, the model operator $Q^{a}$ at a given point $a\\in M$ is defined as the left-invariant [$\\Psi_{H}$DO]{}\u00a0on ${\\ensuremath{\\mathcal{S}}}_{0}(G_{a}M,{\\ensuremath{\\mathcal{E}}})$ with symbol $q^{a}(\\xi)=\\sigma_{l}(Q)(a,\\xi)$. Bearing this in mind we have:\n\n\\[lem:Metric.cP-Heisenberg-coordinates\\] Let $Q\\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}})$ and let $Q^{a}$ be its model operator at a point $a \\in M$.\n\n1\\) We have $c_{Q^{a}}(x)=c_{Q^{a}}dx$, where $c_{Q^{a}}$ is a constant and $dx$ denotes the Haar measure of $G_{a}M$.\n\n2\\) In Heisenberg coordinates centered at $a$ we have $c_{Q}(0)=c_{Q^{a}}$.\n\nLet $X_{0},X_{1},\\ldots,X_{d}$ be a $H$ frame near $a$. Since $G_{a}M$ has underlying set $(T_{a}M/H_{a})\\oplus H_{a}$ the vectors $X_{0}(a),\\ldots,X_{d}(a)$ define global coordinates for $G_{a}M$, so that we can identify it with ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ equipped with the group law\u00a0(\\[eq:Heisenberg.group-law-tangent-group-coordinates\\]). In these coordinates set $q^{a}(\\xi):=\\sigma_{-(d+2)}(P)(a,\\xi)$. Then\u00a0(\\[eq:PsiHDO.PsiDO-convolution\\]) tells us that $Q^{a}$ corresponds to the operator $q^{a}(-iX^{a})$ acting on ${\\ensuremath{\\mathcal{S}}}_{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, where $X_{0}^{a},\\ldots,X_{d}^{a}$ is the left-invariant tangent frame coming from the model vector fields at $a$ of $X_{0},\\ldots,X_{d}$.\n\nNotice that the left-invariance of the frame $X_{0}^{a},\\ldots,X_{d}^{a}$ implies that, with respect to this frame, the affine change of variables to the privileged coordinates centered at any given point $x\\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ is just $\\psi^{a}_{x}(y)=y.x^{-1}$. In view of\u00a0(\\[eq:Heisenberg.group-law-tangent-group-coordinates\\]) this implies that $|\\psi_{x}^{a'}|=1$. Therefore, from\u00a0(\\[eq:NCR.formula-cP\\]) we get $$c_{Q^{a}}(x)=(2\\pi)^{-(d+1)}\\int_{\\|\\xi\\|=1}q^{a}(\\xi)\\iota_{E}d\\xi.\n     \\label{eq:Metric.cQa}$$ Since the Haar measure of $G_{a}M$ corresponds to the Lebesgue measure of ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ this proves the 1st part of the lemma.\n\nNext, by Definition\u00a0\\[def:Heisenberg.principal-symbol\\] in Heisenberg coordinates centered at $a$ the principal symbol $\\sigma_{-(d+2)}(Q)(x,\\xi)$ agrees at $x=0$ with the principal symbol $q_{-(d+2)}(x,\\xi)$ of $Q$ in the sense of\u00a0(\\[eq:Heisenberg.asymptotic-expansion-symbols\\]), so we have $q^{a}(\\xi)=q_{-(d+2)}(0,\\xi)$. Furthermore, as we already are in Heisenberg coordinates, hence in privileged coordinates, we see that, with respect to the $H$-frame $X_{0},\\ldots,X_{d}$, the affine change of variables $\\psi_{0}$ to the privileged coordinates centered at the origin is just the identity. Therefore, by using\u00a0(\\[eq:NCR.formula-cP\\]) and\u00a0(\\[eq:Metric.cQa\\]) we see that $c_{Q}(0)$ is equal to $$(2\\pi)^{-(d+1)}\\int_{\\|\\xi\\|=1}q(0,\\xi)\\iota_{E}d\\xi=(2\\pi)^{-(d+1)}\\int_{\\|\\xi\\|=1}q^{a}(\\xi)\\iota_{E}d\\xi=c_{Q^{a}}.\n$$ The 2nd part of the lemma is thus proved.\n\nWe are now ready to prove Proposition\u00a0\\[prop:Metric.positivity-cP\\].\n\nFor sake of simplicity we may assume that ${\\ensuremath{\\mathcal{E}}}$ is the trivial line bundle, since in the general case the proof follows along similar lines. Moreover, for any $a \\in M$ by Lemma\u00a0\\[lem:Metric.cP-Heisenberg-coordinates\\] in Heisenberg coordinates centered at $a$ we have $c_{P^{-\\frac{d+2}{m}}}(0)=c_{(P^{-\\frac{d+2}{m}})^{a}}$. Therefore, it is enough to prove that $c_{(P^{-\\frac{d+2}{m}})^{a}}$ is $>0$ for any $a\\in M$.\n\nLet $a \\in M$ and let $X_{0},\\ldots,X_{d}$ be a $H$-frame near $a$. By using the coordinates provided by the vectors $X_{0}(a),\\ldots,X_{d}(a)$ we can identify $G_{a}M$ with ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ equipped with the group law\u00a0(\\[eq:Heisenberg.group-law-tangent-group-coordinates\\]). We then let $H^{a}\\subset T{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be the hyperplane bundle spanned by the model vector fields $X_{1}^{a},\\ldots,X_{d}^{a}$ seen as left-invariant vector fields on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$. In addition, for any $z\\in {\\ensuremath{\\mathbb{C}}}$ we let $p(z)(\\xi):=\\sigma_{z}(P^{\\frac{z}{m}})(a,\\xi)$ be the principal symbol at $a$ of $P^{\\frac{z}{m}}$, seen as a homogeneous symbol on ${{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0}$. Notice that by\u00a0[@Po:MAMS1 Rem.\u00a04.2.2] the family $(p(z))_{z \\in {\\ensuremath{\\mathbb{C}}}}$ is a holomorphic family with values in $C^{\\infty}({{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0})$.\n\nLet $\\chi\\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\chi(\\xi)=1$ near $\\xi=0$. For any $z \\in {\\ensuremath{\\mathbb{C}}}$ and for any pair $\\varphi$ and $\\psi$ of functions in $C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ we set $$\\tilde{p}(z)(\\xi):=(1-\\chi)p(z) \\qquad \\text{and} \\qquad P_{\\varphi,\\psi}(z):=\\varphi \\tilde{p}(z)(-iX^{a}) \\psi.\n$$ Then $(\\tilde{p}(z))_{z\\in {\\ensuremath{\\mathbb{C}}}}$ and $(P_{\\varphi,\\psi}(z))_{z\\in {\\ensuremath{\\mathbb{C}}}}$ are holomorphic families with values in $S^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and $\\Psi^{*}_{H^{a}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ respectively.\n\nNotice that $P_{\\varphi,\\psi}(z)$ has order $z$ and the support of its Schwartz kernel is contained in the fixed compact set ${{\\operatorname{supp}}}\\varphi \\times {{\\operatorname{supp}}}\\psi$, so by Proposition\u00a0\\[prop:Heisenberg.L2-boundedness\\] the operator $P_{\\varphi,\\psi}(z)$ is bounded on $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ for $\\Re  z\\leq 0$. In fact, by arguing as in the proof of\u00a0[@Po:MAMS1 Prop.\u00a04.6.2] we can show that $(P_{\\varphi,\\psi}(z))_{\\Re z\\leq 0}$ actually is a holomorphic family with values in ${\\ensuremath{\\mathcal{L}}}(L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}))$.\n\nMoreover, by\u00a0[@Po:MAMS1 Prop.\u00a04.6.2] the family $(P_{\\varphi,\\psi}(\\overline{z})^{*})_{z\\in {\\ensuremath{\\mathbb{C}}}}$ is a holomorphic family with values in $\\Psi^{*}_{H^{a}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that ${{{\\operatorname{ord}}}}P_{\\varphi,\\psi}(\\overline{z})^{*}=z$ for any $z \\in {\\ensuremath{\\mathbb{C}}}$. Therefore $(P_{\\varphi,\\psi}(z)P_{\\varphi,\\psi}(\\overline{z})^{*})_{\\Re z <-\\frac{d+2}{2}}$ is a holomorphic family with values in $\\Psi_{H^{a}}^{\\text{int}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. For any $z \\in {\\ensuremath{\\mathbb{C}}}$ let $k(z)(x,y)$ denote the Schwartz kernel of $P_{\\varphi,\\psi}(z)P_{\\varphi,\\psi}(\\overline{z})^{*}$. Then the support of $k(z)(x,y)$ is contained in the fixed compact set ${\\operatorname{supp}}\\varphi \\times \n    {\\operatorname{supp}}\\varphi$, and by using\u00a0\\[eq:NCR.kP(x,x)\\] we can check that $(k(z)(x,y))_{\\Re z <-\\frac{d+2}{2}}$ is a holomorphic family of continuous Schwartz kernels. It then follows that $(P_{\\varphi,\\psi}(z)P_{\\varphi,\\psi}(\\overline{z})^{*})_{\\Re z <-\\frac{d+2}{2}}$ is a holomorphic family with values in the Banach ideal ${\\ensuremath{\\mathcal{L}}}^{1}(L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}))$ of trace-class operators on $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nLet us now choose $\\psi$ so that $\\psi =1$ near ${{\\operatorname{supp}}}\\varphi$. For any $t \\in {\\ensuremath{\\mathbb{R}}}$ the operator $P^{\\frac{t}{m}}$ is selfadjoint, so by Proposition\u00a0\\[prop:Heisenberg.operations-principal-symbols\\] its principal symbol is real-valued. Therefore, by Proposition\u00a0\\[prop:Heisenberg.operations-principal-symbols\\] the principal symbol of $(P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*})$ is equal to $$[ \\varphi p(t)\\psi]*^{a}[\\overline{\\psi}\\overline{p(t)}\\overline{\\varphi}] =|\\varphi|^{2}p(t)*p(t)=|\\varphi|^{2}p(2t).\n     \\label{eq:Metric.principal-symbol}$$ In particular, the principal symbols of $P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}$ and $P_{|\\varphi|^{2},\\psi}(-(d+2))$ agree. By combining this with Lemma\u00a0\\[lem:Metric.cP-Heisenberg-coordinates\\] we see that $$c_{P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}}(x)= \n            c_{P_{|\\varphi|^{2},\\psi}(-(d+2))}(x)=|\\varphi(x)|^{2}c_{(P^{-\\frac{(d+2)}{m}})^{a}}.\n         \\label{eq:Metric.cPphipsi-cPa}$$ It then follows from Proposition\u00a0\\[thm:NCR.TR.local\\] that we have: $$\\begin{gathered}\n        c_{(P^{-\\frac{(d+2)}{m}})^{a}}(\\int |\\varphi(x)|^{2}dx) =\\int c_{P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}}(x) dx \\\\\n        =\\lim_{t \\rightarrow \\frac{-(d+2)}{2}}\\frac{-1}{t+\\frac{d+2}{2}}\\int t_{P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*})}(x) dx\\\\ = \n         \\lim_{t \\rightarrow [\\frac{-(d+2)}{2}]^{-}}\\frac{-1}{t+\\frac{d+2}{2}} {\\ensuremath{{\\operatorname{Trace}}}}[P_{\\varphi,\\psi}(-t)P_{\\varphi,\\psi}(-t)^{*}] \\geq 0.\n    \\end{gathered}$$ Thus, by choosing $\\varphi$ so that $\\int |\\varphi|^{2}>0$ we obtain that $c_{(P^{-\\frac{(d+2)}{m}})^{a}}$ is $\\geq 0$.\n\nAssume now that $c_{(P^{-\\frac{(d+2)}{m}})^{a}}$ vanishes, and let us show that this assumption leads us to a contradiction. Observe that $(P_{\\varphi,\\psi}(\\frac{z-(d+2)}{2})P_{\\varphi,\\psi}(\\frac{\\overline{z-(d+2)}}{2})^{*})_{z\\in {\\ensuremath{\\mathbb{C}}}}$ is holomorphic gauging for $P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}$. Moreover, by\u00a0(\\[eq:Metric.cPphipsi-cPa\\]) we have $c_{P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}}(x)=|\\varphi(x)|^{2}c_{(P^{-\\frac{(d+2)}{m}})^{a}}=0$. Therefore, it follows from Proposition\u00a0\\[prop:Heisenberg.operations-principal-symbols\\] that ${\\ensuremath{{\\operatorname{TR}}}}P_{\\varphi,\\psi}(z)P_{\\varphi,\\psi}(\\overline{z})^{*}$ is analytic near $z=-\\frac{d+2}{2}$. In particular, the limit $\\lim_{t\\rightarrow {\\frac{-(d+2)}{2}}^{-}} {\\ensuremath{{\\operatorname{Trace}}}}P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}$ exists and is finite.\n\nLet $(\\xi_{k})_{k\\geq 0}$ be an orthonormal basis of $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and let $N\\in {\\ensuremath{\\mathbb{N}}}$. For any $t>\\frac{d+2}{2}$ the operator $P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}$ is trace-class and we have $$\\sum_{0\\leq k \\leq N}{\\ensuremath{\\langle P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}\\xi_{k} , \\xi_{k} \\rangle}} \\leq {\\ensuremath{{\\operatorname{Trace}}}}[P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}].\n          \\label{eq:Metric.partial-trace}$$ As $t \\rightarrow {-\\frac{d+2}{2}}^{-}$ the operator $P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}$ converges to $P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}$ in ${\\ensuremath{\\mathcal{L}}}(L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Therefore, letting $t$ go to ${-\\frac{d+2}{2}}^{-}$ in\u00a0(\\[eq:Metric.partial-trace\\]) shows that, for any $N\\in {\\ensuremath{\\mathbb{N}}}$, we have $$\\sum_{0\\leq k \\leq N}{\\ensuremath{\\langle P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}\\xi_{k} , \\xi_{k} \\rangle}} \n        \\leq\\lim_{t\\rightarrow [\\frac{-(d+2)}{2}]^{-}} {\\ensuremath{{\\operatorname{Trace}}}}[P_{\\varphi,\\psi}(t)P_{\\varphi,\\psi}(t)^{*}] <\\infty.$$ This proves that $P_{\\varphi,\\psi}(-\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})^{*}$ is a trace-class operator. Incidentally, we see that $P_{\\varphi,\\psi}(-\\frac{d+2}{2})$ is a Hilbert-Schmidt operator on $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nNext, let $Q \\in \\Psi_{H^{a}}^{-\\frac{d+2}{2}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and let $q(x,\\xi)\\in S_{-\\frac{d+2}{2}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be the principal symbol of $Q$. The principal symbol of $\\varphi Q\\psi$ is $\\varphi(x) q(x,\\xi)$. Moreover, since for any $z \\in {\\ensuremath{\\mathbb{C}}}$ we have $p(z)*p(-z)=p(0)=1$, we see that the principal symbol of $\\psi Q\\psi P_{\\psi,\\psi}(\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})$ is equal to $$(\\psi q \\psi)*(\\psi p(\\frac{d+2}{2})\\psi)*(\\varphi p(-\\frac{d+2}{2})\\psi)= \\varphi q*p(\\frac{d+2}{2})*p(-\\frac{d+2}{2})=\\varphi q.\n$$ Thus $\\varphi Q\\psi$ and $\\psi Q\\psi P_{\\psi,\\psi}(\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2})$ have the same principal symbol. Since they both have a compactly supported Schwartz kernel it follows that we can write $$\\varphi Q\\psi = \\psi Q\\psi P_{\\psi,\\psi}(\\frac{d+2}{2})P_{\\varphi,\\psi}(-\\frac{d+2}{2}) +Q_{1},\n        \\label{eq:Metric.Hilbert-Schmidt-decomposition}$$ for some operator $Q_{1} \\in \\Psi_{H^{a}}^{-\\frac{d+2}{2}-1}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ with a compactly supported Schwartz kernel. Observe that:\n\n- the operator $ \\psi Q\\psi P_{\\psi,\\psi}(\\frac{d+2}{2})$ is a zero\u2019th order [$\\Psi_{H}$DO]{}\u00a0with a compactly supported Schwartz kernel, so this is a bounded operator on $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$;\n\n- as above-mentioned $P_{\\varphi,\\psi}(-\\frac{d+2}{2})$ is a Hilbert-Schmidt operator;\n\n- as $Q_{1}^{*}Q_{1}$ belongs to $\\Psi_{H,c}^{\\text{int}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ this is a trace-class operator, and so $Q_{1}$ is a Hilbert-Schmidt operator.\n\nSince the space ${\\ensuremath{\\mathcal{L}}}^{2}(L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}))$ of Hilbert-Schmidt operators is a two-sided ideal, it follows from\u00a0(\\[eq:Metric.Hilbert-Schmidt-decomposition\\]) and the above observations that $\\varphi Q\\psi $ is a Hilbert-Schmidt operator. In particular, by [@GK:ITLNSO p.\u00a0109] the Schwartz kernel of $\\varphi Q\\psi $ lies in $L^{2}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$.\n\nWe now get a contradiction as follows. Let $Q\\in \\Psi_{H^{a}}^{-\\frac{d+2}{2}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ have Schwartz kernel, $$k_{Q}(x,y)=|{\\psi_{x}^{a}}'| \\|\\psi_{x}^{a}(y)\\|^{-\\frac{d+2}{2}},\n$$ where $\\psi_{x}^{a}$ is the change to the privileged coordinates at $a$ with respect to the $H^{a}$-frame $X_{0}^{a},\\ldots,X_{d}^{a}$ (this makes sense since $\\|y\\|^{-\\frac{d+2}{2}}$ is in ${\\ensuremath{\\mathcal{K}}}_{-\\frac{d+2}{2}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}\\times \n    {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$). As alluded to in the proof of Lemma\u00a0\\[lem:Metric.cP-Heisenberg-coordinates\\] the left-invariance of the frame $X_{0}^{a},\\ldots,X_{d}^{a}$ implies that $\\psi_{x}^{a}(y)=y.x^{-1}$. Therefore, the Schwartz kernel of $\\varphi Q\\psi $ is equal to $$k_{\\varphi Q\\psi}(x,y)=\\varphi(x) \\|y.x^{-1}\\|^{-\\frac{d+2}{2}} \\psi(y).\n$$ However, this not an $L^{2}$-integrable kernel, since $\\|y.x^{-1}\\|^{-(d+2)}$ is not locally integrable near the diagonal.\n\nWe have obtained a contradiction, so $c_{(P^{-\\frac{d+2}{m}})^{a}}$ cannot be zero. Since we know that $c_{(P^{-\\frac{d+2}{m}})^{a}}$ is $\\geq 0$, we see that $c_{(P^{-\\frac{d+2}{m}})^{a}}$ is $>0$. The proof of Proposition\u00a0\\[prop:Metric.positivity-cP\\] is thus complete.\n\nThe Dixmier trace of [$\\Psi_{H}$DOs]{} {#sec:Dixmier}\n--------------------------------------\n\nThe quantized calculus of Connes\u00a0[@Co:NCG] allows us to translate into the language of quantum mechanics the main tools of the classical infinitesimal calculus. In particular, an important device is the Dixmier trace\u00a0([@Di:ETNN], [@CM:LIFNCG Appendix A]), which is the noncommutative analogue of the standard integral. We shall now show that, as in the case of classical [$\\Psi$DOs]{}\u00a0(see\u00a0[@Co:AFNG]), the noncommutative residue allows us to extend the Dixmier trace to the whole algebra of integer order [$\\Psi_{H}$DOs]{}.\n\nLet us first recall the main facts about Connes\u2019 quantized calculus and the Dixmier trace. The general setting is that of bounded operators on a separable Hilbert space ${\\ensuremath{\\mathcal{H}}}$. Extending the well known correspondence in quantum mechanics between variables and operators, we get the following dictionary between classical notions of infinitesimal calculus and their operator theoretic analogues.\n\n               Classical                                     Quantum\n  ----------------------------------- ------------------------------------------------------\n             Real variable             Selfadjoint operator on ${\\ensuremath{\\mathcal{H}}}$\n           Complex variable                  Operator on ${\\ensuremath{\\mathcal{H}}}$\n        Infinitesimal variable           Compact operator on ${\\ensuremath{\\mathcal{H}}}$\n   Infinitesimal of order $\\alpha>0$              Compact operator $T$ such that\n                                           $\\mu_{n}(T)={\\operatorname{O}}(n^{-\\alpha})$\n\nThe third line can be explained as follows. We cannot say that an operator $T$ is an infinitesimal by requiring that $\\|T\\| \\leq \\epsilon$ for any $\\epsilon >0$, for this would give $T=0$. Nevertheless, we can relax this condition by requiring that for any $\\epsilon>0$ we have $\\|T\\|<\\epsilon$ outside a finite dimensional space. This means that $T$ is in the closure of finite rank operators, i.e., $T$ belongs to the ideal ${\\ensuremath{\\mathcal{K}}}$ of compact operators on ${\\ensuremath{\\mathcal{H}}}$.\n\nIn the last line $\\mu_{n}(T)$ denotes the $(n+1)$\u2019th characteristic value of $T$, i.e., the $(n+1)$\u2019th eigenvalue of $|T|=(T^{*}T)^{\\frac12}$. In particular, by the min-max principle we have $$\\begin{aligned}\n    \\mu_{n}(T) & = & \\inf\\{ \\|T_{E^\\perp}\\|; \\dim E=n\\}, \n    \\nonumber \\\\\n     & = & {\\operatorname{dist}}(T,\\mathcal{R}_{n}) , \\qquad \\mathcal{R}_{n}= \n   \\{\\text{operators of rank}\\leq n\\}, \n   \\label{eq:NCG.min-max}\n$$ so the decay of $\\mu_{n}(T)$ controls the accuracy of the approximation of $T$ by finite rank operators. Moreover, by using\u00a0(\\[eq:NCG.min-max\\]) we also can check that, for $S$, $T$ in ${\\ensuremath{\\mathcal{K}}}$ and $A$, $B$ in ${\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})$, we have $$\\mu_{n}(T+S)\\leq \\mu_{n}(T)+\\mu_{n}(S) \\qquad \\text{and} \\qquad \\mu_{n}(ATB)\\leq \\|A\\| \\mu_{n}(T) \\|B\\|,\n     \\label{eq:NCG.inequalities-2sided-ideals}$$ This implies that the set of infinitesimal operators of order $\\alpha$ is a two-sided ideal of ${\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})$.\n\nNext, in this setting the analogue of the integral is provided by the Dixmier trace\u00a0([@Di:ETNN], [@CM:LIFNCG Appendix A]). The latter arises in the study of the logarithmic divergency of the partial traces, $${\\ensuremath{{\\operatorname{Trace}}}}_{N}(T) = \\sum_{n=0}^{N- 1} \\mu_{n}(T), \\qquad T \\in{\\ensuremath{\\mathcal{K}}}, \\quad T\\geq 0.$$ The domain of the Dixmier trace is the Schatten ideal, $${\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}=\\{T\\in {\\ensuremath{\\mathcal{K}}};     \\|T\\|_{1,\\infty} :=\\sup \\frac{\\sigma_{N}(T)}{\\log N} < \\infty\\}. \n$$\n\nWe extend the definition of $ {\\ensuremath{{\\operatorname{Trace}}}}_{N}(T)$ by means of the interpolation formula, $$\\sigma_{\\lambda}(T) =\\inf \\{\\|x\\|_{1}+ \\lambda \\|y\\| ; x+y=T\\}, \\qquad \\lambda>0,$$ where $\\|x\\|_{1}:={\\ensuremath{{\\operatorname{Trace}}}}|x|$ denotes the Banach norm of the ideal ${\\ensuremath{\\mathcal{L}}}^{1}$ of trace-class operators. For any integer $N$ we have $\\sigma_{N}(T)={\\ensuremath{{\\operatorname{Trace}}}}_{N}(T)$. In addition, the Ces\u0101ro mean of $\\sigma_{\\lambda}(T)$ with respect to the Haar measure $\\frac{d\\lambda}{\\lambda}$ of ${\\ensuremath{\\mathbb{R}}}_{+}^{*}$ is $$\\tau_{\\Lambda}(T) = \\frac{1}{\\log\\Lambda}\\int_{e}^\\Lambda \\frac{\\sigma_{\\lambda}(T)}\n    {\\log  \\lambda}\\frac{d\\lambda}{\\lambda}, \\qquad \\Lambda\\geq e.$$\n\nLet ${\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+}=\\{T \\in {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}}); \\ T\\geq 0\\}$. Then by\u00a0[@CM:LIFNCG Appendix A] for $T_{1}$ and $T_{2}$ in ${\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}\\cap {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+}$ we have $$|\\tau_{\\Lambda}(T_{1}+T_{2}) -\\tau_{\\Lambda}(T_{1}) -\\tau_{\\Lambda}(T_{2}) | \\leq \n    3({\\ensuremath{\\|{T_{1}}\\|_{(1,\\infty)}}}+{\\ensuremath{\\|{T_{2}}\\|_{(1,\\infty)}}}) \\frac{\\log\\log\\Lambda}{\\log\\Lambda}.$$ Therefore, the functionals $\\tau_{\\Lambda}$, $\\Lambda \\geq e$, give rise to an additive homogeneous map, $$\\tau:   {\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}\\cap {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+} \\longrightarrow C_{b}[e,\\infty)/C_{0}[e,\\infty).\n$$ It follows from this that for any state $\\omega$ on the $C^{*}$-algebra $C_{b}[e,\\infty)/C_{0}[e,\\infty)$, i.e., for any positive linear form such that $\\omega(1)=1$, there is a unique linear functional ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}:{\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}\\rightarrow {\\ensuremath{\\mathbb{C}}}$ such that $${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}T = \\omega(\\tau(T)) \\qquad \\forall T \\in  {\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}\\cap {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+}.  \n$$\n\nWe gather the main properties of this functional in the following.\n\n\\[prop:NCG.properties-Dixmier-trace\\] For any state $\\omega$ on $C_{b}[e,\\infty)/C_{0}[e,\\infty)$ the Dixmier trace ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ has the following properties:\n\n1\\) If $T$ is trace-class, then ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}T=0$.\n\n2\\) We have ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}(T)\\geq 0$ for any $T\\in {\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}\\cap {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+}$.\n\n3\\) If $S:{\\ensuremath{\\mathcal{H}}}'\\rightarrow {\\ensuremath{\\mathcal{H}}}$ is a topological isomorphism, then we have ${\\ensuremath{{\\operatorname{Tr}}}}_{\\omega,{\\ensuremath{\\mathcal{H}}}'}(T)={\\ensuremath{{\\operatorname{Tr}}}}_{\\omega,{\\ensuremath{\\mathcal{H}}}}(STS^{-1})$ for any $T\\in {\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}({\\ensuremath{\\mathcal{H}}}')$. In particular, ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ does not depend on choice of the inner product on ${\\ensuremath{\\mathcal{H}}}$.\n\n4\\) We have ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}AT={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}TA$ for any $A \\in {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})$ and any $T\\in {\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}$, that is, ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ is a trace on the ideal ${\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}$.\n\nThe functional ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ is called the *Dixmier trace* associated to $\\omega$. We also say that an operator $T \\in {\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}$ is *measurable* when the value of ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}T$ is independent of the choice of the state $\\omega$. We then call *the Dixmier trace* of $T$ the common value, $${\\ensuremath{-\\hspace{-2,4ex}\\int}}T :={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}T. \n$$ In addition, we let ${\\ensuremath{\\mathcal{M}}}$ denote the space of measurable operators. For instance, if $T\\in {\\ensuremath{\\mathcal{K}}}\\cap {\\ensuremath{\\mathcal{L}}}({\\ensuremath{\\mathcal{H}}})_{+}$ is such that $\\lim_{N\\rightarrow \\infty}\\frac{1}{\\log N} \\sum_{n=0}^{N-1} \\mu_{n}(T) = L$, then it can be shown that $T$ is measurable and we have ${\\ensuremath{-\\hspace{-2,4ex}\\int}}T=L$.\n\nAn important example of measurable operator is due to Connes\u00a0[@Co:AFNG]. Let ${\\ensuremath{\\mathcal{H}}}$ be the Hilbert space $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ of $L^{2}$-sections of a Hermitian vector bundle over a compact manifold $M$ equipped with a smooth positive density and let $P:L^{2}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow \nL^{2}(M,{\\ensuremath{\\mathcal{E}}})$ be a classical [$\\Psi$DO]{}\u00a0of order $-\\dim M$. Then $P$ is measurable for the Dixmier trace and we have $${\\ensuremath{-\\hspace{-2,4ex}\\int}}P =\\frac{1}{\\dim M} {\\ensuremath{{\\operatorname{Res}}}}P,\n     \\label{eq:NCG.Trw-NCR-PsiDOs}$$ where ${\\ensuremath{{\\operatorname{Res}}}}P$ denotes the noncommutative residue trace for classical [$\\Psi$DOs]{}\u00a0of Wodzicki\u00a0([@Wo:LISA], [@Wo:NCRF]) and Guillemin\u00a0[@Gu:NPWF]. This allows us to extends the Dixmier trace to all [$\\Psi$DOs]{}\u00a0of integer order, hence to integrate any such [$\\Psi$DO]{}\u00a0even though it is not an infinitesimal of order\u00a0$\\leq 1$.\n\nFrom now one we let $(M^{d+1},H)$ be a compact Heisenberg manifold equipped with a smooth positive density and we let ${\\ensuremath{\\mathcal{E}}}$ be a Hermitian vector bundle over $M$. In addition, we recall that by Proposition\u00a0\\[prop:Heisenberg.L2-boundedness\\] any $P\\in {\\ensuremath{\\Psi_{H}}}^{m}(M,{\\ensuremath{\\mathcal{E}}})$ with $\\Re m\\geq 0$ extends to a bounded operator from $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ to itself and this operator is compact if we further have $\\Re m<0$.\n\nLet $P:C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}}) \\rightarrow C^{\\infty}(M,{\\ensuremath{\\mathcal{E}}})$ be a positive [$\\Psi_{H}$DO]{}\u00a0with an invertible principal symbol of order $m>0$, and for $k=0,1,..$ let $\\lambda_{k}(P)$ denote the $(k+1)$\u2019\u00a0th eigenvalue of $P$ counted with multiplicity. By Proposition\u00a0\\[prop:Zeta.Weyl-asymptotics\\] when $k \\rightarrow \\infty$ we have $$\\lambda_{k}(P) \\sim (\\frac{k}{\\nu_{0}(P)})^{\\frac{m}{d+2}}, \\qquad \\nu_{0}(P)= \\frac{1}{d+2}{\\ensuremath{{\\operatorname{Res}}}}P^{-\\frac{d+2}{m}}.\n$$ It follows that for any $\\sigma \\in {\\ensuremath{\\mathbb{C}}}$ with $\\Re \\sigma <0$ the operator $P^{\\sigma}$ is an infinitesimal operator of order $\\frac{m |\\Re \\sigma|}{d+2}$. Furthermore, for $\\sigma=-\\frac{d+2}{m}$ using\u00a0(\\[eq:NCG.inequalities-2sided-ideals\\]) we see that $P^{-\\frac{d+2}{m}}$ is measurable and we have $${\\ensuremath{-\\hspace{-2,4ex}\\int}}P^{-\\frac{d+2}{m}}=\\nu_{0}(P)=\\frac{1}{d+2}{\\ensuremath{{\\operatorname{Res}}}}P^{-\\frac{d+2}{m}}.\n     \\label{eq:NCG.Dixmier-trace-NCR.hypoelliptic}$$\n\nThese results are actually true for general [$\\Psi_{H}$DOs]{}, for we have:\n\n\\[thm:NCG.Dixmier\\] Let $P: L^{2}(M,{\\ensuremath{\\mathcal{E}}}) \\rightarrow L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ be a [$\\Psi_{H}$DO]{}\u00a0order $m$ with $\\Re m<0$.\n\n1\\) $P$ is an infinitesimal operator of order $(\\dim M+1)^{-1}|\\Re m|$.\n\n2\\) If ${{{\\operatorname{ord}}}}P=-(\\dim M+1)$, then $P$ is measurable and we have $${\\ensuremath{-\\hspace{-2,4ex}\\int}}P = \\frac1{\\dim M+1} {\\ensuremath{{\\operatorname{Res}}}}P. \n     \\label{eq:NCG.bint-NCR}$$\n\nFirst, let $P_{0}\\in {\\ensuremath{\\Psi_{H}}}^{1}(M,{\\ensuremath{\\mathcal{E}}})$ be a positive and invertible [$\\Psi_{H}$DO]{}\u00a0with an invertible principal symbol (e.g.\u00a0$P_{0}=(1+\\Delta^{*}\\Delta)^{\\frac{1}{4}}$, where $\\Delta$ is a hypoelliptic sublaplacian). Then $PP_{0}^{m}$ is a zeroth order [$\\Psi_{H}$DO]{}. By Proposition\u00a0\\[\\] any zeroth order [$\\Psi_{H}$DO]{}\u00a0is bounded on $L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ and as above-mentioned $P^{-m}_{0}$ is an infinitesimal of order $\\alpha:=(\\dim M+1)^{-1}|\\Re m|$. Since we have $P=PP_{0}^{m}.P_{0}^{-m}$ we see that $P$ is the product of a bounded operator and of an infinitesimal operator of order $\\alpha$. As (\\[eq:NCG.inequalities-2sided-ideals\\]) shows that the space of infinitesimal operators of order $\\alpha$ is a two-sided ideal, it follows that $P$ is an infinitesimal of order $\\alpha$. In particular, if ${{{\\operatorname{ord}}}}P=-(d+2)$ then $P$ is an infinitesimal of order $1$, hence is contained in ${\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}$.\n\nNext, let ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ be the Dixmier trace associated to a state $\\omega$ on $C_{b}[e,\\infty)/C_{0}[e,\\infty)$, and let us prove that for any $P \\in \n    {\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}})$ we have ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P=\\frac{1}{d+2}{\\ensuremath{{\\operatorname{Res}}}}P$.\n\nLet $\\kappa:U\\rightarrow {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ be a $H$-framed chart mapping onto ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ such that there is a trivialization $\\tau:{\\ensuremath{\\mathcal{E}}}_{|U} \\rightarrow U\\times \n    {\\ensuremath{\\mathbb{C}}}^{r}$ of ${\\ensuremath{\\mathcal{E}}}$ over $U$ (as in the proof of Theorem\u00a0\\[thm:Traces.traces\\] we shall call such a chart a *nice $H$-framed chart*). As in Subsection\u00a0\\[sec:traces\\] we shall use the subscript $c$ to denote [$\\Psi_{H}$DOs]{}\u00a0with a compactly supported Schwartz kernel (e.g.\u00a0${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ denote the class of integer order [$\\Psi_{H}$DOs]{}\u00a0on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ whose Schwartz kernels have compact supports). Notice that if $P\\in{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}},{\\ensuremath{\\mathbb{C}}}^{r})$ then the operator $\\tau^{*}\\kappa^{*}P$ belongs to ${\\ensuremath{\\Psi_{H}}}^{{\\ensuremath{\\mathbb{Z}}}}(M,{\\ensuremath{\\mathcal{E}}})$ and the support of its Schwartz kernel is a compact subset of $U\\times U$.\n\nSince $P_{0}$ is a positive [$\\Psi_{H}$DO]{}\u00a0with an invertible principal symbol, Proposition\u00a0\\[prop:Metric.positivity-cP\\] tells us that the density ${{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P_{0}^{-(d+2)}}(x)$ is\u00a0$>0$, so we can write $\\kappa_{*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P_{0}^{-(d+2)}}(x)_{|U}]=c_{0}(x)dx$ for some positive function $c_{0}\\in C^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Then for any $c \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and any $\\psi \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $\\psi=1$ near ${{\\operatorname{supp}}}c$ we let $$P_{c,\\psi}:=(\\frac{c\\circ \\kappa}{c_{0}\\circ \\kappa})P_{0}^{-(d+2)} (\\psi\\circ \\kappa).\n     \\label{eq:Dixmier.Pcpsi}$$ Notice that $P_{c,\\psi}$ belongs to ${\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}})$ and it depends on the choice $\\psi$ only modulo operators in ${\\ensuremath{\\Psi^{-\\infty}}}(M,{\\ensuremath{\\mathcal{E}}})$. Since the latter are trace-class operators and the Dixmier trace ${\\ensuremath{{\\operatorname{Tr}}}}_{\\omega}$ vanishes on such operators (cf.\u00a0Proposition\u00a0\\[prop:NCG.properties-Dixmier-trace\\]), we see that the value of ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P_{c,\\psi}$ does not depend on the choice of $\\psi$. Therefore, we define a linear functional $L:C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}) \\rightarrow {\\ensuremath{\\mathbb{C}}}$ by assigning to any $c \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ the value $$L(c):={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P_{c,\\psi}, \n$$ where $\\psi \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is such that $\\psi=1$ near ${{\\operatorname{supp}}}c$.\n\nOn the other hand, let $P\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})$. Then $\\tau_{*}P$ belongs to ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathbb{C}}}^{r}):={\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U)\\otimes M_{r}({\\ensuremath{\\mathbb{C}}})$. Set $\\tau_{*}P=(P_{ij})$ and define ${{\\operatorname{tr}}}P:=\\sum P_{ii}$. In addition, for $i,j=1,\\ldots,r$ let $E_{ij}\\in M_{r}({\\ensuremath{\\mathbb{C}}})$ be the elementary matrix whose all entries are zero except that on the $i$th row and $j$th column which is equal to $1$. Then we have $$\\tau_{*}P=\\frac{1}{r}({{\\operatorname{tr}}}P)\\otimes I_{r} + \\sum_{i} P_{ii}\\otimes (E_{ii}-\\frac{1}{r}I_{r}) +\\sum_{i\\neq j} P_{ij}\\otimes E_{ij}.\n$$ Any matrix $A \\in M_{r}({\\ensuremath{\\mathbb{C}}})$ with vanishing trace is contained in the commutator space $[M_{r}({\\ensuremath{\\mathbb{C}}}),M_{r}({\\ensuremath{\\mathbb{C}}})]$. Notice also that the space ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U)\\otimes [M_{r}({\\ensuremath{\\mathbb{C}}}),M_{r}({\\ensuremath{\\mathbb{C}}})]$ is contained in $[{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}(U,{\\ensuremath{\\mathbb{C}}}^{r}),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathbb{C}}}^{r})]$. Therefore, we see that $$P= \\frac{1}{r}({{\\operatorname{tr}}}P)\\otimes {\\operatorname{id}}_{{\\ensuremath{\\mathcal{E}}}} \\mod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}(U,{\\ensuremath{\\mathcal{E}}}_{|U}),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})].\n     \\label{eq:Dixmier.decomposition-P}$$\n\nLet us write $\\kappa_{*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P}(x)]=a_{P}(x)dx$ with $a_{P} \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, and let $\\psi \\in C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\psi=1$ near ${{\\operatorname{supp}}}a_{P}$. Then we have $$\\kappa_{*}[c_{{{\\operatorname{tr}}}P_{a_{P},\\psi}}(x)=(\\frac{a_{P}(x)}{c_{0}(x)})\\psi(x)\\kappa_{*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P_{0}^{-(d+2)}}(x)]=a_{P}(x)dx=\\kappa_{*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} \n    c_{P}(x)]=\\kappa_{*}[c_{{{\\operatorname{tr}}}P}(x)].$$ In other words $Q:={{\\operatorname{tr}}}P-{{\\operatorname{tr}}}P_{a_{P},\\psi}$ is an element of ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U)$ such that $c_{Q}(x)=0$. By the step (i) of the proof of Lemma\u00a0\\[lem:Traces.sum-commutators.compact\\] we then can write $\\kappa_{*}Q$ in the form $\\kappa_{*}Q=[\\chi_{0},Q_{0}]+\\ldots+[\\chi_{d},Q_{d}]$ for some functions $\\chi_{0},\\ldots,\\chi_{d}$ in $C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and some operators $Q_{0},\\ldots,Q_{d}$ in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{{\\ensuremath{\\mathbb{Z}}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. In fact, it follows from the proof of Lemmas\u00a0\\[lem:Traces.sum-commutators\\] and\u00a0\\[lem:Traces.sum-commutators.compact\\] that $Q_{0},..,Q_{d}$ can be chosen to have order\u00a0$\\leq -(d+2)$. This insures us that $\\kappa_{*}Q$ is contained in $[{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})]$. Thus, $${{\\operatorname{tr}}}P= {{\\operatorname{tr}}}P_{a_{P},\\psi} \\mod [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}(U),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U)].$$ By combining this with\u00a0(\\[eq:Dixmier.decomposition-P\\]) we obtain $$P=  \\frac{1}{r}({{\\operatorname{tr}}}P)\\otimes {\\operatorname{id}}_{{\\ensuremath{\\mathcal{E}}}} =  \\frac{1}{r}({{\\operatorname{tr}}}P_{a_{P},\\psi})\\otimes {\\operatorname{id}}_{{\\ensuremath{\\mathcal{E}}}} =P_{a_{P},\\psi} \\mod \n    [{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}(U,{\\ensuremath{\\mathcal{E}}}_{|U}),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})].\n$$ Notice that $[{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{0}(U,{\\ensuremath{\\mathcal{E}}}_{|U}),{\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})]$ is contained in $[{\\ensuremath{\\Psi_{H}}}^{0}(M,{\\ensuremath{\\mathcal{E}}}),{\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}})]$, which is itself contained in the commutator space $[{\\ensuremath{\\mathcal{L}}}(L^{2}(M)),{\\ensuremath{\\mathcal{L}}}^{(1,\\infty)}(M)]$ of ${\\ensuremath{\\mathcal{L}^{(1,\\infty)}}}$. As the Dixmier trace ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ vanishes on the latter space (cf.\u00a0Proposition\u00a0\\[prop:NCG.properties-Dixmier-trace\\]) we deduce that $${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P_{a_{P},\\psi}=L(a_{P}). \n     \\label{eq:NCG.Trw-tau-cP}$$\n\nNow, let $c \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ and set $c_{1}= \n\\frac{c}{\\sqrt{c_{0}(x)}}$. In addition, let $\\psi \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ be such that $\\psi\\geq 0$ and $\\psi=1$ near ${{\\operatorname{supp}}}c$, and set $\\tilde{c}_{1}=c\\circ \\kappa$ and $\\tilde{\\psi}=\\psi\\circ\\kappa$. Notice that with the notation of\u00a0(\\[eq:Dixmier.Pcpsi\\]) we have $\\overline{\\tilde{c}_{1}}\\tilde{c}_{1}P_{0}^{-(d+2)}\\tilde{\\psi}=P_{|c|^{2},\\psi}$. Observe also that we have $$(\\tilde{c}_{1}P_{0}^{-\\frac{d+2}{2}}\\tilde{\\psi})(\\tilde{c}_{1}P_{0}^{-\\frac{d+2}{2}}\\tilde{\\psi})^{*} \n    =\\tilde{c}_{1}P_{0}^{-\\frac{d+2}{2}}\\tilde{\\psi}^{2}P_{0}^{-\\frac{d+2}{2}}\\overline{\\tilde{c}_{1}}\n    =  \\tilde{c}_{1}P_{0}^{-(d+2)}\\psi \\overline{\\tilde{c}_{1}} \\mod \\Psi^{-\\infty}(M,{\\ensuremath{\\mathcal{E}}}).\n$$ As alluded to earlier the trace ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ vanishes on smoothing operators, so we get $$\\begin{gathered}\n  {\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}[  (\\tilde{c}_{1}P_{0}^{-\\frac{d+2}{2}}\\tilde{\\psi})(\\tilde{c}_{1}P_{0}^{-\\frac{d+2}{2}}\\tilde{\\psi})^{*} ]= \n  {\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}[\\tilde{c}_{1}P_{0}^{-(d+2)}\\tilde{\\psi} \\overline{\\tilde{c}_{1}}]\\\\ ={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}[\\overline{\\tilde{c}_{1}}\\tilde{c}_{1}P_{0}^{-(d+2)}\\tilde{\\psi} ] = {\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P_{|c|^{2},\\psi}=L(|c|).\n$$ Since ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ is a positive trace (cf.\u00a0Proposition\u00a0\\[prop:NCG.properties-Dixmier-trace\\]) it follows that we have $L(|c|^{2})\\geq 0$ for any $c \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, i.e., $L$ is a positive linear functional on $C_{c}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. Since any such functional uniquely extends to a Radon measure on $C_{0}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, this shows that $L$ defines a positive Radon measure.\n\nNext, let $a \\in {\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$ and let $\\phi(x)=x+a$ be the translation by $a$ on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$. Since $\\phi'(x)=1$ we see that $\\phi$ is a Heisenberg diffeomorphism, so for any $P \\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ the operator $\\phi_{*}P$ is in ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{*}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ too. Set $\\phi_{\\kappa}=\\kappa^{-1} \\circ \\phi \\circ \\kappa$. Then by\u00a0(\\[eq:Log.functoriality-cP\\]) we have $$\\kappa_{*}[ {{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}} c_{\\phi_{\\kappa*}P_{c,\\psi}}(x)]=\\kappa_{*}\\phi_{\\kappa*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P_{c,\\psi}}(x)]= \n   \\phi_{*}[c(x)dx]=c(\\phi^{-1}(x))dx.\n$$ Since shows that $a_{\\phi_{\\kappa*}P_{c,\\psi}}(x)= c(\\phi^{-1}(x))$, so from\u00a0(\\[eq:NCG.Trw-tau-cP\\]) we get $${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}\\phi_{\\kappa*}P_{c,\\psi}=L[c\\circ \\phi^{-1}].\n    \\label{eq:Dixmier.Lcphi}$$\n\nLet $K$ be a compact subset of ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$. Then $\\phi_{\\kappa}$ gives rise to a continuous linear isomorpshism $\\phi_{\\kappa*}:L^{2}_{\\kappa^{-1}(K)}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow L^{2}_{\\kappa^{-1}(K+a)}(M,{\\ensuremath{\\mathcal{E}}})$. By combining it with a continuous linear isomorphism $L^{2}_{\\kappa^{-1}(K)}(M,{\\ensuremath{\\mathcal{E}}})^{\\perp}\\rightarrow L^{2}_{\\kappa^{-1}(K+a)}(M,{\\ensuremath{\\mathcal{E}}})^{\\perp}$ we obtain a continuous linear isomorphism $S:L^{2}(M,{\\ensuremath{\\mathcal{E}}})\\rightarrow L^{2}(M,{\\ensuremath{\\mathcal{E}}})$ which agrees with $\\phi_{\\kappa*}$ on $L^{2}_{\\kappa^{-1}(K)}(M,{\\ensuremath{\\mathcal{E}}})$. In particular, we have $\\phi_{\\kappa*}P_{c,\\psi} = S P_{c,\\psi}S^{-1}$. Therefore, by using Proposition\u00a0\\[prop:NCG.properties-Dixmier-trace\\] and\u00a0\\[eq:Dixmier.Lcphi\\] we see that, for any $c \\in C_{K}^{\\infty}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, we have $$L[c]={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P_{c,\\psi}={\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}S P_{c,\\psi}S^{-1}= {\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}\\phi_{\\kappa*}P_{c,\\psi}=L[c\\circ \\phi^{-1}].\n$$ This proves that $L$ is translation-invariant. Since any translation invariant Radon measure on $C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is a constant multiple of the Lebesgue measure, it follows that there exists a constant $\\Lambda_{U}\\in {\\ensuremath{\\mathbb{C}}}$ such that, for any $c \\in C^{\\infty}_{c}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$, we have $$L(c)=\\Lambda_{U} \\int c(x)dx. \n     \\label{eq:Dixmier.L-Lebesgue}$$\n\nNow, combining\u00a0(\\[eq:NCG.Trw-tau-cP\\]) and\u00a0(\\[eq:Dixmier.L-Lebesgue\\]) shows that, for any $P\\in {\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})$, we have $$\\begin{gathered}\n   {\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P=  \\Lambda_{U}\\int_{{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}} a_{P}(x)dx= \\Lambda_{U}\\int_{{\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}} \\kappa_{*}[{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P}(x)] \\\\\n    =\\Lambda_{U}\\int_{M}{{\\operatorname{tr}}}_{{\\ensuremath{\\mathcal{E}}}}c_{P}(x)=(2\\pi)^{d+1}\\Lambda_{U}{\\ensuremath{{\\operatorname{Res}}}}P.\n     \\label{eq:Dixmier-Trw-Res}\\end{gathered}$$ This shows that, for any domain $U$ of a nice $H$-framed chart, on ${\\ensuremath{\\Psi_{H,{\\operatorname{c}}}}}^{-(d+2)}(U,{\\ensuremath{\\mathcal{E}}}_{|U})$ the Dixmier trace ${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}$ is a constant multiple of the noncommutative residue. Therefore, if we let $M_{1}, \\ldots, M_{N}$ be the connected components of $M$, then by arguing as in the proof of Theorem\u00a0\\[thm:Traces.traces\\] we can prove that on each connected component $M_{j}$ there exists a constant $\\Lambda_{j}\\geq 0$ such that $${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P =\\Lambda_{j} {\\ensuremath{{\\operatorname{Res}}}}P \\qquad \\forall P\\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M_{j},{\\ensuremath{\\mathcal{E}}}_{|M_{j}}).\n$$ In fact, if we take $P=P_{0|_{M_{j}}}^{-(d+2)}$ then from\u00a0(\\[eq:NCG.Dixmier-trace-NCR.hypoelliptic\\]) we get $\\Lambda_{j}=(d+2)^{-1}$. Thus, $${\\ensuremath{{\\operatorname{Tr}}_{\\omega}}}P =\\frac{1}{d+2}{\\ensuremath{{\\operatorname{Res}}}}P \\qquad \\forall P \\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}}).\n$$ This proves that any operator $P \\in {\\ensuremath{\\Psi_{H}}}^{-(d+2)}(M,{\\ensuremath{\\mathcal{E}}})$ is measurable and its Dixmier trace then is equal to $(d+2)^{-1}{\\ensuremath{{\\operatorname{Res}}}}P$. The theorem is thus proved.\n\nAs a consequence of Theorem\u00a0\\[thm:NCG.Dixmier\\] we can extend the Dixmier trace to the whole algebra ${\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$ by letting $${\\ensuremath{-\\hspace{-2,4ex}\\int}}P :=\\frac{1}{d+2}{\\ensuremath{{\\operatorname{Res}}}}P \\quad \\text{for any $P\\in {\\ensuremath{\\Psi_{H}^{{\\ensuremath{\\mathbb{Z}}}}}}(M,{\\ensuremath{\\mathcal{E}}})$}.\n$$\n\nIn the language of the quantized calculus this means that we can integrate any [$\\Psi_{H}$DO]{}\u00a0of integer order, even though it is not an infinitesimal operator of order\u00a0$\\geq 1$. This property will be used in Section\u00a0\\[sec:CR\\] to define lower dimensional volumes in pseudohermitian geometry.\n\nNoncommutative residue and contact geometry {#sec:Contact}\n===========================================\n\nIn this section we make use of the results of\u00a0[@Po:MAMS1] to compute the noncommutative residues of some geometric operators on contact manifolds.\n\nThroughout this section we let $(M^{2n+1},H)$ be a compact orientable contact manifold, i.e., $(M^{2n+1},H)$ is a Heisenberg manifold and there exists a contact 1-form $\\theta$ on $M$ such that $H=\\ker \\theta$ (cf.\u00a0Section\u00a0\\[sec:Heisenberg-calculus\\]).\n\nSince $M$ is orientable the hyperplane $H$ admits an almost complex structure $J\\in C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}H)$, $J^{2}=-1$, which is calibrated with respect to $\\theta$, i.e., $d\\theta(.,J.)$ is positive definite on $H$. We then can endow $M$ with the Riemannian metric, $$g_{\\theta,J}=\\theta^{2}+d\\theta(.,J.).\n     \\label{eq:Contact.Riem-metric}$$ The volume of $M$ with respect to $g_{\\theta,J}$ depends only on $\\theta$ and is equal to $${{\\operatorname{Vol}}}_{\\theta}M:=\\frac{1}{n!}\\int_{M}d\\theta^{n}\\wedge \\theta.\n$$\n\nIn addition, we let $X_{0}$ be the *Reeb field* associated to $\\theta$, that is, the unique vector field on $M$ such that $\\iota_{X_{0}}\\theta=1$ and $\\iota_{X_{0}}d\\theta=0$.\n\nNoncommutative residue and the horizontal sublaplacian (contact case)\n---------------------------------------------------------------------\n\nIn the sequel we shall identify $H^{*}$ with the subbundle of $T^{*}M$ annihilating the orthogonal complement $H^{\\perp}\\subset TM$. This yields the orthogonal splitting, $$\\Lambda_{{\\ensuremath{\\mathbb{C}}}}T^{*}M=(\\bigoplus_{0\\leq k \\leq 2n} \\Lambda^{k}_{{\\ensuremath{\\mathbb{C}}}}H^{*})\\oplus (\\theta\\wedge  \\Lambda^{*}T_{{\\ensuremath{\\mathbb{C}}}}^{*}M).\n$$ The horizontal differential $d_{b;k}:C^{\\infty}(M,\\Lambda^{k}_{{\\ensuremath{\\mathbb{C}}}}H^{*})\\rightarrow C^{\\infty}(M,\\Lambda^{k+1}_{{\\ensuremath{\\mathbb{C}}}}H^{*})$ is $$d_{b}=\\pi_{b;k+1}\\circ d,\n$$ where $\\pi_{b;k}\\in C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}\\Lambda_{{\\ensuremath{\\mathbb{C}}}}T^{*}M)$ denotes the orthogonal projection onto $\\Lambda^{k}_{{\\ensuremath{\\mathbb{C}}}}H^{*}$. This is not the differential of a chain complex, for we have $$d_{b}^{2}=-{\\ensuremath{\\mathcal{L}}}_{X_{0}}\\varepsilon(d\\theta)=-\\varepsilon (d\\theta){\\ensuremath{\\mathcal{L}}}_{X_{0}},\n     \\label{eq:CR.square-db}$$ where $\\varepsilon (d\\theta)$ denotes the exterior multiplication by $d\\theta$.\n\nThe horizontal sublaplacian $\\Delta_{b;k}:C^{\\infty}(M,\\Lambda^{k}_{{\\ensuremath{\\mathbb{C}}}}H^{*})\\rightarrow C^{\\infty}(M,\\Lambda^{k+1}_{{\\ensuremath{\\mathbb{C}}}}H^{*})$ is $$\\Delta_{b;k}=d_{b;k}^{*}d_{b;k}+d_{b;k-1}d_{b;k-1}^{*}.\n    \\label{eq:CR.horizontal-sublaplacian}$$ Notice that the definition of $\\Delta_{b}$ makes sense on any Heisenberg manifold equipped with a Riemannian metric. This operator was first introduced by Tanaka\u00a0[@Ta:DGSSPCM], but versions of this operator acting on functions were independently defined by Greenleaf\u00a0[@Gr:FESPM] and Lee\u00a0[@Le:FMPHI]. Since the fact that $(M,H)$ is a contact manifold implies that the Levi form\u00a0(\\[eq:Heisenberg.Levi-form\\]) is nondegenerate, from\u00a0[@Po:MAMS1 Prop.\u00a03.5.4] we get:\n\nThe principal symbol of $\\Delta_{b;k}$ is invertible if and only if we have $k\\neq n$.\n\nNext, for $\\mu\\in (-n,n)$ we let $$\\rho(\\mu)= \\frac{\\pi^{-(n+1)}}{2^{n}n!} \\int_{-\\infty}^{\\infty}e^{-\\mu\\xi_{0}}(\\frac{\\xi_{0}}{\\sinh \\xi_{0}})^{n}d\\xi_{0}.$$ Notice that with the notation of\u00a0[@Po:MAMS1 Eq.\u00a0(6.2.29)] we have $\\rho(\\mu)=(2n+2)\\nu(\\mu)$. For $q \\neq n$ let $\\nu_{0}(\\Delta_{b;k})$ be the coefficient $\\nu_{0}(P)$ in the Weyl asymptotics\u00a0(\\[eq:Zeta.Weyl-asymptotics1\\]) for $\\Delta_{b;k}$, i.e., we have ${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;k}^{-(n+1)}=(2n+2)\\nu_{0}(\\Delta_{b;k})$. By\u00a0[@Po:MAMS1 Prop.\u00a06.3.3] we have $\\nu_{0}(\\Delta_{b;k})=\\tilde{\\gamma}_{nk}{{\\operatorname{Vol}}}_{\\theta}M$, where $\\tilde{\\gamma}_{nk}:=\\sum_{p+q=k}2^{n}\\binom{n}{p} \\binom{n}{q}\\nu(p-q)$. Therefore, we get:\n\n\\[prop:Contact.residue-Deltab\\] For $k \\neq n$ we have $${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;k}^{-(n+1)}= \\gamma_{nk} {{\\operatorname{Vol}}}_{\\theta}M ,\\quad \n \\gamma_{nk}=\\sum_{p+q=k}2^{n}\\binom{n}{p} \\binom{n}{q}\\rho(p-q). \n           \\label{eq:Contact.residue-Deltab}$$ In particular $\\gamma_{nk}$ is a universal constant depending only on $n$ and $k$.\n\nNoncommutative residue and the contact Laplacian\n------------------------------------------------\n\nThe contact complex of Rumin\u00a0[@Ru:FDVC] can be seen as an attempt to get a complex of horizontal forms by forcing the equalities $d_{b}^{2}=0$ and $(d_{b}^{*})^{2}=0$. Because of\u00a0(\\[eq:CR.square-db\\]) there are two natural ways to modify $d_{b}$ to get a chain complex. The first one is to force the equality $d_{b}^{2}=0$ by restricting $d_{b}$ to the subbundle $\\Lambda^{*}_{2}:=\\ker \\varepsilon(d\\theta) \\cap \\Lambda^{*}_{{\\ensuremath{\\mathbb{C}}}}H^{*}$, since the latter is closed under $d_{b}$ and is annihilated by $d_{b}^{2}$. Similarly, we get the equality $(d_{b}^{*})^{2}=0$ by restricting $d^{*}_{b}$ to the subbundle $\\Lambda^{*}_{1}:=\\ker \\iota(d\\theta)\\cap \\Lambda^{*}_{{\\ensuremath{\\mathbb{C}}}}H^{*}=({{\\operatorname{im}}}\\varepsilon(d\\theta))^{\\perp}\\cap \\Lambda^{*}_{{\\ensuremath{\\mathbb{C}}}}H^{*}$, where $\\iota(d\\theta)$ denotes the interior product with $d\\theta$. This amounts to replace $d_{b}$ by $\\pi_{1}\\circ d_{b}$, where $\\pi_{1}$ is the orthogonal projection onto $\\Lambda^{*}_{1}$.\n\nIn fact, since $d\\theta$ is nondegenerate on $H$ the operator $\\varepsilon(d\\theta):\\Lambda^{k}_{{\\ensuremath{\\mathbb{C}}}}H^{*}\\rightarrow \\Lambda^{k+2}_{{\\ensuremath{\\mathbb{C}}}}H^{*}$ is injective for $k\\leq n-1$ and surjective for $k\\geq n+1$. This implies that $\\Lambda_{2}^{k}=0$ for $k\\leq n$ and $\\Lambda_{1}^{k}=0$ for $k\\geq n+1$. Therefore, we only have two halves of complexes. As observed by Rumin\u00a0[@Ru:FDVC] we get a full complex by connecting the two halves by means of the differential operator, $$B_{R}:C^{\\infty}(M,\\Lambda_{{\\ensuremath{\\mathbb{C}}}}^{n}H^{*})\\rightarrow C^{\\infty}(M,\\Lambda_{{\\ensuremath{\\mathbb{C}}}}^{n}H^{*}),   \\qquad \nB_{R}={\\ensuremath{\\mathcal{L}}}_{X_{0}}+d_{b,n-1}\\varepsilon(d\\theta)^{-1}d_{b,n},$$ where $\\varepsilon(d\\theta)^{-1}$ is the inverse of $\\varepsilon(d\\theta):\\Lambda^{n-1}_{{\\ensuremath{\\mathbb{C}}}}H^{*}\\rightarrow \\Lambda^{n+1}_{{\\ensuremath{\\mathbb{C}}}}H^{*}$. Notice that $B_{R}$ is second order differential operator. Thus, if we let $\\Lambda^{k}=\\Lambda_{1}^{k}$ for $k=0,\\ldots,n-1$ and we let $\\Lambda^{k}=\\Lambda_{1}^{k}$ for $k=n+1,\\ldots,2n$, then we get the chain complex, $$\\begin{gathered}\n    C^{\\infty}(M)\\stackrel{d_{R;0}}{\\rightarrow}C^{\\infty}(M,\\Lambda^{1})\\stackrel{d_{R;1}}{\\rightarrow}\n    \\ldots \n    C^{\\infty}(M,\\Lambda^{n-1})\\stackrel{d_{R;n-1}}{\\rightarrow}C^{\\infty}(M,\\Lambda^{n}_{1})\\stackrel{B_{R}}{\\rightarrow}\\\\  \n    C^{\\infty}(M,\\Lambda^{n}_{2})  \\stackrel{d_{R;n}}{\\rightarrow}C^{\\infty}(M,\\Lambda^{n+1})\n    \\ldots \\stackrel{d_{R;2n-1}}{\\longrightarrow} C^{\\infty}(M,\\Lambda^{2n}),\n     \\label{eq:contact-complex}\\end{gathered}$$ where $d_{R;k}:=\\pi_{1}\\circ d_{b;k}$ for $k=0,\\ldots,n-1$ and $d_{R;k}:=d_{b;k}$ for $k=n,\\ldots,2n-1$. This complex is called the *contact complex*.\n\nThe contact Laplacian is defined as follows. In degree $k\\neq n$ it consists of the differential operator $\\Delta_{R;k}:C^{\\infty}(M,\\Lambda^{k})\\rightarrow C^{\\infty}(M,\\Lambda^{k})$ given by $$\\Delta_{R;k}=\\left\\{\n    \\begin{array}{ll}\n        (n-k)d_{R;k-1}d^{*}_{R;k}+(n-k+1) d^{*}_{R;k+1}d_{R;k}& \\text{$k=0,\\ldots,n-1$},\\\\\n         (k-n-1)d_{R;k-1}d^{*}_{R;k}+(k-n) d^{*}_{R;k+1}d_{R;k}& \\text{$k=n+1,\\ldots,2n$}.\n         \\label{eq:contact-Laplacian1}\n    \\end{array}\\right.$$ In degree $k=n$ it consists of the differential operators $\\Delta_{R;nj}:C^{\\infty}(M,\\Lambda_{j}^{n})\\rightarrow C^{\\infty}(M,\\Lambda^{n}_{j})$, $j=1,2$, defined by the formulas, $$\\Delta_{R;n1}= (d_{R;n-1}d^{*}_{R;n})^{2}+B_{R}^{*}B_{R}, \\quad   \\Delta_{R;n2}=B_{R}B_{R}^{*}+  (d^{*}_{R;n+1}d_{R;n}).\n         \\label{eq:contact-Laplacian2}$$\n\nObserve that $\\Delta_{R;k}$, $k\\neq n$, is a differential operator of order $2$, whereas $\\Delta_{R;n1}$ and $\\Delta_{R;n2}$ are differential operators of order $4$. Moreover, Rumin\u00a0[@Ru:FDVC] proved that in every degree the contact Laplacian is maximal hypoelliptic in the sense of\u00a0[@HN:HMOPCV]. In fact, in every degree the contact Laplacian has an invertible principal symbol, hence admits a parametrix in the Heisenberg calculus (see\u00a0[@JK:OKTGSU],\u00a0[@Po:MAMS1 Sect.\u00a03.5]).\n\nFor $k\\neq n$ (resp.\u00a0$j=1,2$) we let $\\nu_{0}(\\Delta_{R;k})$ (resp.\u00a0$\\nu_{0}(\\Delta_{R;nj})$) be the coefficient $\\nu_{0}(P)$ in the Weyl asymptotics\u00a0(\\[eq:Zeta.Weyl-asymptotics1\\]) for $\\Delta_{R;k}$ (resp.\u00a0$\\Delta_{R;nj}$). By Proposition\u00a0\\[prop:Zeta.Weyl-asymptotics\\] we have ${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{R;k}^{-(n+1)}=(2n+2)\\nu_{0}(\\Delta_{R;k})$ and $ {\\ensuremath{{\\operatorname{Res}}}}\\Delta_{R;nj}^{-\\frac{n+1}{2}}=(2n+2)\\nu_{0}(\\Delta_{R;nj})$. Moreover, by\u00a0[@Po:MAMS1 Thm.\u00a06.3.4] there exist universal positive constants $\\nu_{nk}$ and $\\nu_{n,j}$ depending only on $n$, $k$ and $j$ such that $\\nu_{0}(\\Delta_{R;k})=\\nu_{nk}{{\\operatorname{Vol}}}_{\\theta}M$ and $\\nu_{0}(\\Delta_{R;nj})= \\nu_{n,j}{{\\operatorname{Vol}}}_{\\theta}M$. Therefore, we obtain:\n\n\\[prop:Contact.residue-DeltaR\\] 1) For $k \\neq n$ there exists a universal constant $\\rho_{nk}>0$ depending only on $n$ and $k$ such that $${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{R;k}^{-(n+1)}=\\rho_{nk} {{\\operatorname{Vol}}}_{\\theta}M.$$\n\n2\\) For $j=1,2$ there exists a universal constant $\\rho_{n,j}>0$ depending only on $n$ and $j$ such that $${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{R;nj}^{-\\frac{n+1}{2}}= \\rho_{n,j}  {{\\operatorname{Vol}}}_{\\theta}M.$$\n\nWe have $\\rho_{nk}=(2n+2)\\nu_{nk}$ and $\\rho_{n,j}=(2n+2)\\nu_{n,j}$, so it follows from the proof of\u00a0[@Po:MAMS1 Thm.\u00a06.3.4] that we can explicitly relate the universal constants $\\rho_{nk}$ and $\\rho_{n,j}$ to the fundamental solutions of the heat operators $\\Delta_{R;k}+\\partial_{t}$ and $\\Delta_{R;nj}+\\partial_{t}$ associated to the contact Laplacian on the Heisenberg group ${\\ensuremath{\\mathbb{H}}}^{2n+1}$ (cf.\u00a0[@Po:MAMS1 Eq.\u00a0(6.3.18)]). For instance, if $K_{0;k}(x,t)$ denotes the fundamental solution of $\\Delta_{R;0}+\\partial_{t}$ on ${\\ensuremath{\\mathbb{H}}}^{2n+1}$ then we have $\\rho_{n,0}= \n    \\frac{2^{n}}{n!}K_{0;0}(0,1)$.\n\nApplications in CR geometry {#sec:CR}\n===========================\n\nIn this section we present some applications in CR geometry of the noncommutative residue for the Heisenberg calculus. After recalling the geometric set-up, we shall compute the noncommutative residues of some powers of the horizontal sublaplacian and of the Kohn Laplacian on CR manifolds endowed with a pseudohermitian structure. After this we will make use of the framework of noncommutative geometry to define lower dimensional volumes in pseudohermitian geometry. For instance, we will give sense to the area of any 3-dimensional pseudohermitian manifold as a constant multiple the integral of the Tanaka-Webster scalar curvature. As a by-product this will allow us to get a spectral interpretation of the Einstein-Hilbert action in pseudohermitian geometry.\n\nThe geometric set-up\n--------------------\n\nLet $(M^{2n+1},H)$ be a compact orientable CR manifold. Thus $(M^{2n+1},H)$ is a Heisenberg manifold such that $H$ admits a complex structure $J\\in C^{\\infty}(M,{\\ensuremath{{\\operatorname{End}}}}H)$, $J^{2}=-1$, in such way that $T_{1,0}:=\\ker (J+i)\\subset T_{{\\ensuremath{\\mathbb{C}}}}M$ is a complex rank $n$ subbundle which is integrable in Fr\u00f6benius\u2019 sense (cf.\u00a0Section\u00a0\\[sec:Heisenberg-calculus\\]). In addition, we set $T_{0,1}=\\overline{T_{1,0}}=\\ker(J-i)$.\n\nSince $M$ is orientable and $H$ is orientable by means of its complex structure, there exists a global non-vanishing real 1-form $\\theta$ such that $H=\\ker \\theta$. Associated to $\\theta$ is its Levi form, i.e., the Hermitian form on $T_{1,0}$ such that $$L_{\\theta}(Z,W)=-id\\theta(Z,\\overline{W}) \\qquad \\forall Z,W \\in T_{1,0}.\n$$\n\nWe say that $M$ is strictly pseudoconvex (resp.\u00a0$\\kappa$-strictly pseudoconvex) when we can choose $\\theta$ so that $L_{\\theta}$ is positive definite (resp.\u00a0has signature $(n-\\kappa,\\kappa,0)$) at every point.\n\nIf $(M, H)$ is $\\kappa$-strictly pseudoconvex then $\\theta$ is a contact form on $M$. Then in the terminology of [@We:PHSRH] the datum of the contact form $\\theta$ annihilating $H$ defines a *pseudohermitian structure* on $M$.\n\nFrom now we assume that $M$ is $\\kappa$-strictly pseudoconvex, and we let $\\theta$ be a pseudohermitian contact form such that $L_{\\theta}$ has signature $(n-\\kappa,\\kappa,0)$ everywhere. We let $X_{0}$ be the Reeb vector field associated to $\\theta$, so that $\\iota_{X_{0}}\\theta=1$ and $\\iota_{X_{0}}d\\theta=0$ (cf.\u00a0Section\u00a0\\[sec:Contact\\]), and we let ${\\ensuremath{\\mathcal{N}}}\\subset T_{{\\ensuremath{\\mathbb{C}}}}M$ be the complex line bundle spanned by $X_{0}$.\n\nWe endow $M$ with a *Levi metric* as follows. First, we always can construct a splitting $T_{1,0}=T_{1,0}^{+}\\oplus T_{1,0}^{+}$ with subbundles $T_{1,0}^{+}$ and $T_{1,0}^{-}$ which are orthogonal with respect to $L_{\\theta}$ and such that $L_{\\theta}$ is positive definite on $T_{1,0}^{+}$ and negative definite on $T_{1,0}^{-}$ (see, e.g., [@FS:EDdbarbCAHG], [@Po:MAMS1]). Set $T_{0,1}^{\\pm}=\\overline{T_{1,0}^{\\pm}}$. Then we have the splittings, $$T_{{\\ensuremath{\\mathbb{C}}}}M={\\ensuremath{\\mathcal{N}}}\\oplus T_{1,0}\\oplus T_{0,1}={\\ensuremath{\\mathcal{N}}}\\oplus T_{1,0}^{+}\\oplus T_{1,0}^{-}\\oplus T_{0,1}^{+}\\oplus T_{0,1}^{-}.\n    \\label{eq:CR.splitting-TcM}$$ Associated to these splittings is the unique Hermitian metric $h$ on $T_{{\\ensuremath{\\mathbb{C}}}}M$ such that:\n\n- The splittings\u00a0(\\[eq:CR.splitting-TcM\\]) are orthogonal with respect to $h$;\n\n- $h$ commutes with complex conjugation;\n\n- We have $h(X_{0},X_{0})=1$ and $h$ agrees with $\\pm L_{\\theta}$ on $T_{1,0}^{\\pm}$.\n\nIn particular, the matrix of $L_{\\theta}$ with respect to $h$ is ${\\operatorname{diag}}(1,\\ldots,1,-1,\\ldots,-1)$, where $1$ has multiplicity $n-\\kappa$ and $-1$ multiplicity $-1$.\n\nNotice that when $M$ is strictly pseudoconvex $h$ is uniquely determined by $\\theta$, since in this case $T_{1,0}^{+}=T_{1,0}$ and one can check that we have $h=\\theta^{2}+d\\theta(.,J.)$, that is, $h$ agrees on $TM$ with the Riemannian metric $g_{\\theta,J}$ in\u00a0(\\[eq:Contact.Riem-metric\\]). In general, we can check that the volume form of $M$ with respect to $h$ depends only on $\\theta$ and is equal to $$v_{\\theta}(x):=\\frac{(-1)^{\\kappa}}{n!}d\\theta^{n}\\wedge\\theta. \n$$ In particular, the volume of $M$ with respect to $h$ is $${{\\operatorname{Vol}}}_{\\theta}M:=\\frac{(-1)^{\\kappa}}{n!}\\int_{M} d\\theta^{n}\\wedge\\theta.\n$$\n\nFinally, as proved by Tanaka\u00a0[@Ta:DGSSPCM] and Webster\u00a0[@We:PHSRH] the datum of the pseudohermitian contact form $\\theta$ defines a natural connection, the *Tanaka-Webster connection*, which preserves the pseudohermitian structure of $M$, i.e., it preserves both $\\theta$ and $J$. It can be defined as follows.\n\nLet $\\{Z_{j}\\}$ be a local frame of $T_{1,0}$. Then $\\{X_{0},Z_{j},Z_{\\overline{j}}\\}$ forms a frame of $T_{{\\ensuremath{\\mathbb{C}}}}M$ with dual coframe $\\{\\theta,\\theta^{j}, \\theta^{\\overline{j}}\\}$, with respect to which we can write $d\\theta =ih_{j\\overline{k}}\\theta^{j}\\wedge \\theta^{\\overline{k}}$. Using the matrix $(h_{j\\overline{k}})$ and its inverse $(h^{j\\overline{k}})$ to lower and raise indices, the connection 1-form $\\omega=(\\omega_{j}^{~k})$ and the torsion form $\\tau_{k}=A_{jk}\\theta^{j}$ of the Tanaka-Webster connection are uniquely determined by the relations, $$d\\theta^{k}=\\theta^{j}\\wedge \\omega_{j}^{~k}+\\theta \\wedge \\tau^{k}, \\qquad \n     \\omega_{j\\bar{k}} + \\omega_{\\bar{k}j} \n         =dh_{j\\bar{k}}, \\qquad  A_{jk}=A_{k j}. \n$$\n\nThe curvature tensor $\\Pi_{j}^{~k}:=d\\omega_{j}^{~k}-\\omega_{j}^{~l}\\wedge  \\omega_{l}^{~k}$ satisfies the structure equations, $$\\Pi_{j}^{~k}=R_{j\\bar{k} l\\bar{m}} \\theta^{l}\\wedge \\theta^{\\bar{m}} + \n    W_{j\\bar{k}l}\\theta^{l}\\wedge \\theta -  W_{\\bar{k}j\\bar{l}}\\theta^{\\bar{l}}\\wedge \\theta \n    +i\\theta_{j}\\wedge \\tau_{\\bar{k}}-i\\tau_{j}\\wedge \\theta_{\\bar{k}}.\n     \\label{eq:CR.TW-curvature}$$ The *Ricci tensor* of the Tanaka-Webster connection is $ \\rho_{j \\bar{k}}:=R_{l~j \\bar{k}}^{~l}$, and its *scalar curvature* is $R_{n}: =\\rho_{j}^{~j}$.\n\nNoncommutative residue and the Kohn Laplacian {#subsec:CR.NCR-pseudohermitian}\n---------------------------------------------\n\nThe ${\\overline{\\partial}_{b}}$-complex of Kohn-Rossi\u00a0([@KR:EHFBCM],\u00a0[@Ko:BCM]) is defined as follows.\n\nLet $\\Lambda^{1,0}$ (resp.\u00a0$\\Lambda^{0,1}$) be the annihilator of $T_{0,1}\\oplus {\\ensuremath{\\mathcal{N}}}$ (resp.\u00a0$T_{0,1}\\oplus {\\ensuremath{\\mathcal{N}}}$) in $T^{*}_{{\\ensuremath{\\mathbb{C}}}}M$. For $p,q=0,\\ldots,n$ let $\\Lambda^{p,q}:=(\\Lambda^{1,0})^{p}\\wedge (\\Lambda^{0,1})^{q}$ be the bundle of $(p,q)$-covectors on $M$, so that we have the orthogonal decomposition, $$\\Lambda^{*}T_{{\\ensuremath{\\mathbb{C}}}}^{*}M=(\\bigoplus_{p,q=0}^{n}\\Lambda^{p,q})\\oplus (\\theta\\wedge  \\Lambda^{*}T_{{\\ensuremath{\\mathbb{C}}}}^{*}M).\n     \\label{eq:CR-Lambda-pq-decomposition}$$ Moreover, thanks to the integrability of $T_{1,0}$, given any local section $\\eta$ of $\\Lambda^{p,q}$, its differential $d\\eta$ can be uniquely decomposed as $$d\\eta ={\\overline{\\partial}_{b;p,q}}\\eta + \\partial_{b;p,q}\\eta + \\theta \\wedge {\\ensuremath{\\mathcal{L}}}_{X_{0}}\\eta,\n     \\label{eq:CR.dbarb}$$ where ${\\overline{\\partial}_{b;p,q}}\\eta $ (resp.\u00a0$\\partial_{b;p,q}\\eta$) is a section of $\\Lambda^{p,q+1}$ (resp.\u00a0$\\Lambda^{p+1,q}$).\n\nThe integrability of $T_{1,0}$ further implies that $\\overline{\\partial}_{b}^{2}=0$ on $(0,q)$-forms, so that we get the cochain complex $\\overline{\\partial}_{b;0,*}:C^{\\infty}(M,\\Lambda^{0,*})\\rightarrow C^{\\infty}(M,\\Lambda^{0,*+1})$. On $(p,q)$-forms with $p\\geq 1$ the operator ${\\overline{\\partial}_{b}}^{2}$ is a tensor which vanishes when the complex structure $J$ is invariant under the Reeb flow (i.e., when we have $[X_{0},JX]=J[X_{0},X]$ for any local section $X$ of $H$). Let ${\\overline{\\partial}_{b;p,q}}^{*}$ be the formal adjoint of ${\\overline{\\partial}_{b;p,q}}$ with respect to the Levi metric of $M$. Then the *Kohn Laplacian* ${{\\square}_{b;p,q}}:C^{\\infty}(M,\\Lambda^{p,q})\\rightarrow C^{\\infty}(M,\\Lambda^{p,q})$ is defined to be $${{\\square}_{b;p,q}}={\\overline{\\partial}_{b;p,q}}^{*}{\\overline{\\partial}_{b;p,q}}+  \\overline{\\partial}_{b;p,q-1}\\overline{\\partial}_{b;p,q-1}^{*}.$$ This a differential operator which has order 2 in the Heisenberg calculus sense. Furthermore, we have:\n\nThe principal symbol of ${{\\square}_{b;p,q}}$ is invertible if and only if we have $q \\neq \\kappa$ and $q\\neq n-\\kappa$.\n\nNext, for $q \\not\\in\\{\\kappa,n-\\kappa\\}$ let $\\nu_{0}({{\\square}_{b;p,q}})$ be the coefficient $\\nu_{0}(P)$ in the Weyl asymptotics\u00a0(\\[eq:Zeta.Weyl-asymptotics1\\]) for ${{\\square}_{b;p,q}}$. By\u00a0[@Po:MAMS1 Thm.\u00a06.2.4] we have $  \\nu_{0}({{\\square}_{b;p,q}})=\\tilde{\\alpha}_{n\\kappa pq}{{\\operatorname{Vol}}}_{\\theta}M$, where $\\tilde{\\alpha}_{n\\kappa pq}$ is equal to $$\\sum_{\\max(0,q-\\kappa)\\leq  k\\leq \\min(q,n-\\kappa)} \\frac{1}{2} \\binom{n}{p} \\binom{n-\\kappa}{k}\\binom{\\kappa}{q-k} \n        \\nu(n-2(\\kappa-q+2k)).\n        \\label{eq:CR.talphankpq}$$ Therefore, by arguing as in the proof of Proposition\u00a0\\[prop:Contact.residue-Deltab\\] we get:\n\n\\[prop:CR.residue-Boxb1\\] For $q \\neq \\kappa$ and $q\\neq n-\\kappa$ we have $${\\ensuremath{{\\operatorname{Res}}}}{{\\square}_{b;p,q}}^{-(n+1)}=\\alpha_{n\\kappa pq}{{\\operatorname{Vol}}}_{\\theta}M, \n      \\label{eq:CR.residue-Boxb1}$$ where $\\alpha_{n\\kappa pq}$ is equal to $$\\sum_{\\max(0,q-\\kappa)\\leq  k\\leq \\min(q,n-\\kappa)} \\frac{1}{2} \\binom{n}{p} \\binom{n-\\kappa}{k}\\binom{\\kappa}{q-k} \n        \\rho(n-2(\\kappa-q+2k)).\n          \\label{eq:CR.alphapq}  \n$$ In particular $\\alpha_{n\\kappa pq}$ is a universal constant depending only on $n$, $\\kappa$, $p$ and $q$.\n\n\\[rem:CR.residue-Boxb1-local\\] Let $a_{0}({{\\square}_{b;p,q}})(x)$ be the leading coefficient in the heat kernel asymptotics\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) for ${{\\square}_{b;p,q}}$. By\u00a0(\\[eq:Zeta.tPs-heat1\\]) we have $ \\nu_{0}({{\\square}_{b;p,q}})= \\frac{1}{ (n+1)!} \\int_{M}{{\\operatorname{tr}}}_{\\Lambda^{p,q}}a_{0}({{\\square}_{b;p,q}})(x)$. Moreover, a careful look at the proof of\u00a0[@Po:MAMS1 Thm.\u00a06.2.4] shows that we have $${{\\operatorname{tr}}}_{\\Lambda^{p,q}}a_{0}({{\\square}_{b;p,q}})(x)=(n+1)!\\tilde{\\alpha}_{n\\kappa pq}v_{\\theta}(x).\n$$ Since by\u00a0(\\[eq:Zeta.tPs-heat1\\]) we have $2c_{{{\\square}_{b;p,q}}^{-(n+1)}}(x)=(n!)^{-1}a_{0}({{\\square}_{b;p,q}})(x)$, it follows that the equality\u00a0(\\[eq:CR.residue-Boxb1\\]) ultimately holds at the level of densities, that is, we have $$c_{{{\\square}_{b;p,q}}^{-(n+1)}}(x)=\\alpha_{n\\kappa pq}v_{\\theta}(x).\n$$\n\nFinally, when $M$ is strictly pseudoconvex, i.e., when $\\kappa=0$, we have:\n\n\\[prop:CR.residue-Boxb2\\] Assume $M$ strictly pseudoconvex. Then for $q =1,\\ldots, n-1$ there exists a universal constant $\\alpha_{npq}'$ depending only on $n$, $p$ and $q$ such that $${\\ensuremath{{\\operatorname{Res}}}}{{\\square}_{b;p,q}}^{-n}=\\alpha_{npq}'\\int_{M}R_{n}d\\theta^{n}\\wedge \\theta,\n$$ where $R_{n}$ denotes the Tanaka-Webster scalar curvature of $M$.\n\nFor $q=1,\\ldots,n-1$ let $a_{2}({{\\square}_{b;p,q}})(x)$ be the coefficient of $t^{-n}$ in the heat kernel asymptotics\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) for ${{\\square}_{b;p,q}}$. By\u00a0(\\[eq:Zeta.tPs-heat1\\]) we have $2c_{{{\\square}_{b;p,q}}^{-n}}(x)=\\Gamma(n)^{-1}a_{2}({{\\square}_{b;p,q}})(x)$. Moreover, by\u00a0[@BGS:HECRM Thm.\u00a08.31] there exists a universal constant $\\alpha_{npq}'$ depending only on $n$, $p$ and $q$ such that ${{\\operatorname{tr}}}_{\\Lambda^{p,q}}a_{2}({{\\square}_{b;p,q}})(x)=\\alpha_{npq}'R_{n}d\\theta^{n}\\wedge \\theta$. Thus, $${\\ensuremath{{\\operatorname{Res}}}}{{\\square}_{b;p,q}}^{-n}= \\int_{M}{{\\operatorname{tr}}}_{\\Lambda^{p,q}}c_{{{\\square}_{b;p,q}}^{-n}}(x)= \\alpha_{npq}'\\int_{M}R_{n}d\\theta^{n}\\wedge \\theta,\n$$ where $\\alpha_{npq}'$ is a universal constant depending only on $n$, $p$ and $q$.\n\nNoncommutative residue and the horizontal sublaplacian (CR case)\n----------------------------------------------------------------\n\nLet us identify $H^{*}$ with the subbundle of $T^{*}M$ annihilating the orthogonal supplement $H^{\\perp}$, and let $\\Delta_{b}:C^{\\infty}(M,\\Lambda^{*}_{{\\ensuremath{\\mathbb{C}}}}H^{*})\\rightarrow C^{\\infty}(M,\\Lambda^{*}_{{\\ensuremath{\\mathbb{C}}}}H^{*})$ be the horizontal sublaplacian on $M$ as defined in\u00a0(\\[eq:CR.horizontal-sublaplacian\\]).\n\nNotice that with the notation of\u00a0(\\[eq:CR.dbarb\\]) we have $d_{b}={\\overline{\\partial}_{b}}+\\partial_{b}$. Moreover, we can check that ${\\overline{\\partial}_{b}}\\partial_{b}^{*}+\\partial_{b}^{*} {\\overline{\\partial}_{b}}= {\\overline{\\partial}_{b}}^{*} \\partial_{b}+\\partial_{b} \n {\\overline{\\partial}_{b}}^{*}=0$. Therefore, we have $$\\Delta_{b}={\\square}_{b}+ \\overline{{\\square}}_{b}, \\qquad \\overline{{\\square}}_{b}:=\\partial_{b}^{*}\\partial_{b}+\\partial_{b}\\partial_{b}^{*}.\n$$ In particular, this shows that the horizontal sublaplacian $\\Delta_{b}$ preserves the bidegree, so it induces a differential operator $\\Delta_{b;p,q}:C^{\\infty}(M,\\Lambda^{p,q})\\rightarrow C^{\\infty}(M,\\Lambda^{p,q})$. Then the following holds.\n\nThe principal symbol of $\\Delta_{b;p,q}$ is invertible if and only if we have $(p,q)\\neq (\\kappa,n-\\kappa)$ and $(p,q)\\neq (n-\\kappa,\\kappa)$.\n\nBearing this in mind we have:\n\n\\[prop:CR.residue-Deltab1\\] For $(p,q)\\neq (\\kappa,n-\\kappa)$ and $(p,q)\\neq (n-\\kappa,\\kappa)$ we have $${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;p,q}^{-(n+1)}= \\beta_{n\\kappa pq}{{\\operatorname{Vol}}}_{\\theta}M,\n     \\label{eq:CR.residue-Deltab1a}$$ where $\\beta_{n\\kappa pq}$ is equal to $$\\!  \\!  \\!  \\!   \\sum_{\\substack{\\max(0,q-\\kappa)\\leq  k\\leq \\min(q,n-\\kappa)\\\\ \\max(0,p-\\kappa)\\leq l\\leq \\min(p,n-\\kappa)}}  \\!  \\!  \\!  \\!\n        2^{n}\\binom{n-\\kappa}{l}\\binom{\\kappa}{p-l} \\binom{n-\\kappa}{k}\\binom{\\kappa}{q-k} \n        \\rho(2(q-p)+4(l-k)).\n         \\label{eq:CR.residue-Deltab1b}$$ In particular $\\beta_{n\\kappa pq}$ is a universal constant depending only on $n$, $\\kappa$, $p$ and $q$.\n\nLet $\\nu_{0}(\\Delta_{b;p,q})$ be the coefficient $\\nu_{0}(P)$ in the Weyl asymptotics\u00a0(\\[eq:Zeta.Weyl-asymptotics1\\]) for $\\Delta_{b;p,q}$. By\u00a0[@Po:MAMS1 Thm.\u00a06.2.5] we have $\\nu_{0}(\\Delta_{b;p,q})=\\frac{1}{2n+2}\\beta_{n\\kappa pq}{{\\operatorname{Vol}}}_{\\theta}M$, where $\\beta_{n\\kappa pq}$ is given by\u00a0(\\[eq:CR.residue-Deltab1b\\]). We then can show that $ {\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;p,q}^{-(n+1)}= \\beta_{n\\kappa pq}{{\\operatorname{Vol}}}_{\\theta}M$ by arguing as in the proof of Proposition\u00a0\\[prop:Contact.residue-Deltab\\].\n\n\\[rem:CR.residue-Deltab1-local\\] In the same way as\u00a0(\\[eq:CR.residue-Boxb1\\]) (cf.\u00a0Remark\u00a0\\[rem:CR.residue-Boxb1-local\\]) the equality\u00a0(\\[eq:CR.residue-Deltab1a\\]) holds at the level of densities, i.e., we have $c_{\\Delta_{b;p,q}^{-(n+1)}}(x)=\\beta_{n\\kappa pq}v_{\\theta}(x)$.\n\n\\[prop:CR.residue-Deltab2\\] Assume that $M$ is strictly pseudoconvex. For $(p,q)\\neq (0,n)$ and $(p,q)\\neq (n,0)$ there exists a universal constant $\\beta_{npq}'$ depending only $n$, $p$ and $q$ such that $${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;p,q}^{-n}=\\beta_{npq}' \\int_{M}R_{n}d\\theta^{n}\\wedge \\theta. \n         \\label{eq:CR.residue-Deltab2}$$\n\nThe same analysis as that of\u00a0[@BGS:HECRM Sect.\u00a08] for the coefficients in the heat kernel asymptotics\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) for the Kohn Laplacian can be carried out for the coefficients of the heat kernel asymptotics for $\\Delta_{b;p,q}$ (see\u00a0[@St:SICRM]). In particular, if we let $a_{2}(\\Delta_{b;p,q})(x)$ be the coefficient of $t^{-n}$ in the heat kernel asymptotics for $\\Delta_{b;p,q}$, then there exists a universal constant $\\tilde{\\beta}_{npq}$ depending only on $n$, $p$ and $q$ such that ${{\\operatorname{tr}}}_{\\Lambda^{p,q}}a_{2}(\\Delta_{b;p,q})(x)=\\tilde{\\beta}_{npq}R_{n}d\\theta^{n}\\wedge \\theta$. Arguing as in the proof of Proposition\u00a0\\[prop:CR.residue-Boxb2\\] then shows that ${\\ensuremath{{\\operatorname{Res}}}}\\Delta_{b;p,q}^{-n}=\\beta_{npq}' \\int_{M}R_{n}d\\theta^{n}\\wedge \\theta$, where$\\beta_{npq}'$ is a universal constant depending only $n$, $p$ and $q$.\n\nLower dimensional volumes in pseudohermitian geometry {#subsec.CR.area}\n-----------------------------------------------------\n\nFollowing an idea of Connes\u00a0[@Co:GCMFNCG] we can make use of the noncommutative residue for classical [$\\Psi$DOs]{}\u00a0to define lower dimensional dimensional volumes in Riemannian geometry, e.g., we can give sense to the area and the length of a Riemannian manifold even when the dimension is not 1 or 2 (see\u00a0[@Po:LMP07]). We shall now make use of the noncommutative residue for the Heisenberg calculus to define lower dimensional volumes in pseudohermitian geometry.\n\nIn this subsection we assume that $M$ is strictly pseudoconvex. In particular, the Levi metric $h$ is uniquely determined by $\\theta$. In addition, we let $\\Delta_{b;0}$ be the horizontal sublaplacian acting on functions.Then, as explained in Remark\u00a0\\[rem:CR.residue-Deltab1-local\\], we have $c_{\\Delta_{b;0}^{-(n+1)}}(x)=\\beta_{n}v_{\\theta}(x)$, where $\\beta_{n}=\\beta_{n000}=2^{n}\\rho(0)$. In particular, for any $f \\in C^{\\infty}(M)$ we get $c_{f\\Delta_{b;0}^{-(n+1)}}(x)=\\beta_{n}f(x)v_{\\theta}(x)$. Combining this with Theorem\u00a0\\[thm:NCG.Dixmier\\] then gives$${\\ensuremath{-\\hspace{-2,4ex}\\int}}f\\Delta_{b;0}^{-(n+1)}=\\frac{1}{2n+2}\\int_{M}c_{f\\Delta_{b;0}^{-(n+1)}}(x)=\\frac{\\beta_{n}}{2n+2}\\int_{M}f(x)v_{\\theta}(x).\n$$ Thus the operator $\\frac{2n+2}{\\beta_{n}}\\Delta_{b;0}^{-(n+1)}$ allows us to recapture the volume form $v_{\\theta}(x)$.\n\nSince $-(2n+2)$ is the critical order for a [$\\Psi_{H}$DO]{}\u00a0to be trace-class and $M$ has Hausdorff dimension $2n+2$ with respect to the Carnot-Carath\u00e9odory metric defined by the Levi metric on $H$, it stands for reason to define the *length element* of $(M,\\theta)$ as the positive selfadjoint operator $ds$ such that $(ds)^{2n+2}=\\frac{2n+2}{\\beta_{n}}\\Delta_{b;0}^{-(n+1)}$, that is, $$ds:= c_{n}\\Delta_{b;0}^{-1/2}, \\qquad c _{n}=(\\frac{2n+2}{\\beta_{n}})^{\\frac{1}{2n+2}}.\n$$\n\nFor $k=1,2,\\ldots,2n+2$ the $k$-dimensional volume of $(M,\\theta)$\u00a0is $${\\operatorname{Vol}}_{\\theta}^{(k)}M:={\\ensuremath{-\\hspace{-2,4ex}\\int}}ds^{k}.\n$$ In particular, for $k=2$ the area of $(M,\\theta)$ is $ {\\operatorname{Area}}_{\\theta}M:={\\ensuremath{-\\hspace{-2,4ex}\\int}}ds^{2}$.\n\nWe have ${\\ensuremath{-\\hspace{-2,4ex}\\int}}ds^{k}=\\frac{(c_{n})^{k}}{2n+2}\\int_{M}c_{\\Delta_{b;0}^{-\\frac{k}{2}}}(x)$ and thanks to\u00a0(\\[eq:Zeta.tPs-heat1\\]) we know that $2 \nc_{\\Delta_{b;0}^{-\\frac{k}{2}}}(x)$ agrees with $\\Gamma(\\frac{k}{2})^{-1}a_{2n+2-k}(\\Delta_{b;0})(x)$, where $a_{j}(\\Delta_{b;0})(x)$ denotes the coefficient of $t^{\\frac{2n+2-j}{2}}$ in the heat kernel asymptotics\u00a0(\\[eq:Zeta.heat-kernel-asymptotics\\]) for $\\Delta_{b;0}$. Thus, $${\\operatorname{Vol}}_{\\theta}^{(k)}M=\\frac{(c_{n})^{k}}{4(n+1)}\\Gamma(\\frac{k}{2})^{-1}\\int_{M}a_{2n+2-k}(\\Delta_{b})(x).\n$$ Since $\\Delta_{b;0}$ is a differential operator we have $a_{2j-1}(\\Delta_{b;0})(x)=0$ for any $j\\in {\\ensuremath{\\mathbb{N}}}$, so $ {\\operatorname{Vol}}_{\\theta}^{(k)}M$ vanishes when $k$ is odd. Furthermore, as alluded to in the proof of Proposition\u00a0\\[prop:CR.residue-Deltab2\\] the analysis in\u00a0[@BGS:HECRM Sect.\u00a08] of the coefficients of the heat kernel asymptotics for the Kohn Laplacian applies *verbatim* to the heat kernel asymptotics for the horizontal sublaplacian. Thus, we can write $$a_{2j}(\\Delta_{b;0})(x)=\\gamma_{nj}(x)d\\theta^{n}\\wedge \\theta(x),\n    \\label{eq:CR-volumes-gamma-nj}$$ where $\\gamma_{nj}(x)$ is a universal linear combination, depending only on $n$ and $j$, in complete contractions of covariant derivatives of the curvature and torsion tensors of the Tanaka-Webster connection (i.e.\u00a0$\\gamma_{nj}(x)$ is a local pseudohermitian invariant). In particular, we have $\\gamma_{n0}(x)=\\gamma_{n0}$ and $\\gamma_{n1}=\\gamma_{n1}'R_{n}(x)$, where $\\gamma_{n0}$ and $\\gamma_{n1}$ are universal constants and $R_{n}(x)$ is the Tanaka-Webster scalar curvature (in fact the constants $\\gamma_{n0}$ and $\\gamma_{n1}'$ can be explicitly related to the constants $\\beta_{n000}$ and $\\beta_{n00}'$). Therefore, we obtain:\n\n\\[prop:CR.lower-dim.-volumes\\] 1) ${{\\operatorname{Vol}}}^{(k)}_{\\theta}M$ vanishes when $k$ is odd.\n\n2\\) When $k$ is even we have $${\\operatorname{Vol}}_{\\theta}^{(k)}M=\\frac{(c_{n})^{k}}{4(n+1)}\\Gamma(\\frac{k}{2})^{-1}\\int_{M}\\tilde{\\gamma}_{nk}(x)d\\theta^{n}\\wedge \\theta(x).\n     \\label{eq:CR.volumes-even}$$ where $\\tilde{\\gamma}_{nk}(x):=\\gamma_{nn+1-\\frac{k}{2}}(x)$ is a universal linear combination, depending only on $n$ and $k$, of complete contractions of weight $n+1-\\frac{k}{2}$ of covariant derivatives of the curvature and torsion tensors of the Tanaka-Webster connection.\n\nIn particular, thanks to\u00a0(\\[eq:CR.volumes-even\\]) we have a purely differential-geometric formulation of the $k$-dimensional volume $ {\\operatorname{Vol}}_{\\theta}^{(k)}M$. Moreover, for $k=2n+2$ we get: $${\\operatorname{Vol}}_{\\theta}^{(2n+2)}M=\\frac{(c_{n})^{2n+2}}{4(n+1)}\\frac{\\gamma_{n0}}{n!}\\int_{M}d\\theta^{n}\\wedge \\theta. \n$$ Since ${\\operatorname{Vol}}_{\\theta}^{(2n+2)}M={\\operatorname{Vol}}_{\\theta}M=\\frac{1}{n!}\\int_{M}d\\theta^{n}\\wedge \\theta$ we see that $(c_{n})^{2n+2}=\\frac{4(n+1)}{\\gamma_{n0}}$, where $\\gamma_{n0}$ is above.\n\nOn the other hand, when $n=1$ (i.e.\u00a0$\\dim M=3$) and $k=2$ we get $${\\operatorname{Area}}_{\\theta}M=\\gamma_{1}''\\int_{M}R_{1}d\\theta\\wedge \\theta, \\qquad \\gamma_{1}'':=\\frac{(c_{1})^{2}}{8}\\gamma_{11}' \n     =\\frac{\\gamma_{11}'}{\\sqrt{8\\gamma_{10}}}, \n     \\label{eq:CR.area-universal}$$ where $\\gamma_{11}'$ is above. To compute $\\gamma_{1}''$ it is enough to compute $\\gamma_{10}$ and $\\gamma_{11}'$ in the special case of the unit sphere $S^{3}\\subset {\\ensuremath{\\mathbb{C}}}^{2}$ equipped with its standard pseudohermitian structure, i.e., for $S^{3}$ equipped with the CR structure induced by the complex structure of ${\\ensuremath{\\mathbb{C}}}^{2}$ and with the pseudohermitian contact form $\\theta:= \\frac{i}2 (z_{1} d\\bar{z}_{1}+ z_{2} d\\bar{z}_{2})$.\n\nFirst, the volume ${{\\operatorname{Vol}}}_{\\theta}S^{3}$ is equal to $$\\int_{S^{3}}d\\theta\\wedge \\theta = \\frac{-1}{4}\\int_{S^{3}}(z_{2}dz_{1}\\wedge d\\bar{z_{1}} \\wedge d\\bar{z_{2}} + \n     z_{1} dz_{1}\\wedge dz_{2}\\wedge d\\bar{z_{2}})=\\pi^{2}.\n        \\label{eq:CR.volumeS3}$$ Moreover, by\u00a0[@We:PHSRH] the Tanaka-Webster scalar here is $R_{1}=4$, so we get $$\\int_{S^{3}}R_{1}d\\theta\\wedge \\theta =4{{\\operatorname{Vol}}}_{\\theta}S^{3}=4\\pi^{2}. \n$$\n\nNext, for $j=0,1$ set $A_{2j}(\\Delta_{b;0})=\\int_{S^{3}}a_{2j}(\\Delta_{b;0})(x)$. In view of the definition of the constants $\\gamma_{10}$ and $\\gamma_{11}'$ we have $$A_{0}(\\Delta_{b;0})=\\gamma_{10}\\int_{S^{3}}d\\theta\\wedge \\theta =\\pi^{2}\\gamma_{10}, \\quad \n      A_{2}(\\Delta_{b;0})=\\gamma_{11}'\\int_{S^{3}}R_{1}d\\theta\\wedge \\theta =4\\pi^{2}\\gamma_{11}'.\n      \\label{eq:CR.gamma-A2j}$$ Notice that $A_{0}(\\Delta_{b;0})$ and $A_{2}(\\Delta_{b;0})$ are the coefficients of $t^{-2}$ and $t^{-1}$ in the asymptotics of $ {\\ensuremath{{\\operatorname{Tr}}}}e^{-t\\Delta_{b;0}}$ as $t\\rightarrow 0^{+}$. Moreover, we have $\\Delta_{b;0} \n    =\\boxdot_{\\theta}-\\frac{1}{4}R_{1}=\\boxdot_{\\theta}-1$, where $\\boxdot_{\\theta}$ denotes the CR invariant sublaplacian of Jerison-Lee\u00a0[@JL:YPCRM], and by\u00a0[@St:SICRM Thm. 4.34] we have ${\\ensuremath{{\\operatorname{Tr}}}}e^{-t\\boxdot_{\\theta}} =\\frac{\\pi^{2}}{16t^{2}}+ \n    {\\operatorname{O}}(t^\\infty)$ as $t \\rightarrow 0^{+}$. Therefore, as $t\\rightarrow 0^{+}$ we have $${\\ensuremath{{\\operatorname{Tr}}}}e^{-t\\Delta_{b;0}}=e^{t}{\\ensuremath{{\\operatorname{Tr}}}}e^{-t\\boxdot_{\\theta}}\\sim \\frac{\\pi^{2}}{16t^{2}}(1+t+\\frac{t^{2}}{2}+\\ldots).\n$$ Hence $A_{0}(\\Delta_{b;0})=A_{2}(\\Delta_{b;0})=\\frac{\\pi^{2}}{16}$. Combining this with\u00a0(\\[eq:CR.gamma-A2j\\]) then shows that $\\gamma_{10}=\\frac{1}{16}$ and $\\gamma_{11}'=\\frac{1}{64}$, from which we get $\\gamma_{1}''=\\frac{1/64}{\\sqrt{8.\\frac{1}{16}}}=\\frac1{32\\sqrt2}$. Therefore, we get:\n\n\\[thm:spectral.area\\] If $\\dim M=3$, then we have $${\\operatorname{Area}}_{\\theta}M = \\frac1{32\\sqrt2}\\int_{M}R_{1}d\\theta \\wedge\\theta. \n        \\label{eq:CR.area-dimension3}$$\n\nFor instance, for $S^{3}$ equipped with its standard pseudohermitian structure we obtain ${\\operatorname{Area}}_{\\theta}S^{3}=\\frac{\\pi^{2}}{8\\sqrt{2}}$.\n\nAppendix. Proof of Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\] {#appendix.-proof-of-lemmalemheisenberg.extension-symbol .unnumbered}\n============================================================\n\nIn this appendix, for reader\u2019s convenience we give a detailed proof of Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\] about the extension of a homogeneous symbol on ${{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0}$ into a homogeneous distribution on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$.\n\nLet $p\\in C^\\infty({{\\ensuremath{\\mathbb{R}}}^{d+1}\\!\\setminus\\! 0})$ be homogeneous of degree $m$, $m\\in {\\ensuremath{\\mathbb{C}}}$, so that $p(\\lambda.\\xi)=\\lambda^{m}p(\\xi)$ for any $\\lambda>0$. If $\\Re m>-(d+2)$, then $p$ is integrable near the origin, so it defines a tempered distribution which is its unique homogeneous extension.\n\nIf $\\Re m \\leq -(d+2)$, then we can extend $p$ into the distribution $\\tau\\in{\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ defined by the formula, $${\\ensuremath{\\langle \\tau , u \\rangle}}= \\int [u(\\xi)-\\psi(\\|\\xi\\|)\\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\leq k} \n    \\frac{\\xi^\\alpha}{\\alpha!} u^{(\\alpha)}(0)] p(\\xi)d\\xi \\qquad \\forall u\\in{\\ensuremath{\\mathcal{S}}}({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}), \n   \\label{eq:Appendix.almosthomogeneous-extension}$$ where $k$ is an integer $\\geq -(\\Re m +d+2)$ and $\\psi$ is a function in $C_{c}^\\infty({\\ensuremath{\\mathbb{R}}}_{+})$ such that $\\psi=1$ near $0$. Then in view of\u00a0(\\[eq:PsiHDO.homogeneity-K-m\\]) for any $\\lambda>0$ we have $$\\begin{split}\n {\\ensuremath{\\langle \\tau_{\\lambda} , u \\rangle}}-\\lambda^{m}  {\\ensuremath{\\langle \\tau , u \\rangle}} &=     \\lambda^{-(d+2)}\\int [u(\\lambda^{-1}.\\xi)-\\psi(\\|\\xi\\|)\\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\leq k} \n     \\frac{\\xi^\\alpha\\lambda^{-{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}}}{\\alpha!} u^{(\\alpha)}(0)]p(\\xi)d\\xi \\\\  \n     &  -\\lambda^{m}\\int [u(\\xi)-\\psi(\\|\\xi\\|)\\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\leq k} \n    \\frac{\\xi^\\alpha}{\\alpha!} u^{(\\alpha)}(0)] p(\\xi)d\\xi,\\\\\n    &= \\lambda^{m} \\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\leq k} \\frac{u^{(\\alpha)}(0)}{\\alpha!} \\int [\\psi(\\|\\xi\\|)-\\psi(\\lambda\\|\\xi\\|)] \\xi^{\\alpha}p(\\xi)d\\xi,\\\\\n     &=  \\lambda^{m} \\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\leq k} \\rho_{\\alpha}(\\lambda) c_{\\alpha}(p) {\\ensuremath{\\langle \\delta^{(\\alpha)} , u \\rangle}}, \n   \\end{split}$$ where we have let $$c_{\\alpha}(p) = \\frac{(-1)^{|\\alpha|}}{\\alpha!}\\int_{\\|\\xi\\|=1}\\xi^\\alpha p(\\xi)i_{E}d\\xi, \\qquad     \n\\rho_{\\alpha}(\\lambda)=\\int_{0}^\\infty \\mu^{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}+m+d+2} \n(\\psi(\\mu)-\\psi(\\lambda\\mu)) \\frac{d\\mu}{\\mu},$$ and, as in the statement of Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\], $E$ is the vector field $2\\xi_{0}\\partial_{\\xi_{0}}+\\xi_{1}\\partial_{\\xi_{1}}+\\ldots+\\xi_{d}\\partial_{\\xi_{d}}$.\n\nSet $\\lambda=e^s$ and assume that $\\psi$ is of the form $ \\psi(\\mu)=h(\\log \n\\mu) $ with $h\\in C^\\infty({\\ensuremath{\\mathbb{R}}})$ such that $h=1$ near $-\\infty$ and $h=0$ near $+\\infty$. Then, setting $a_{\\alpha}={\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}+m+d+2$, we have $$\\frac{d}{ds}\\rho_{\\alpha}(e^s)=  \\frac{d}{ds} \\int_{-\\infty}^{\\infty}(h(t)-h(s+t))e^{a_{\\alpha}t}dt=- e^{-as}\\int_{-\\infty}^{\\infty} \n    e^{a_{\\alpha}t} h'(t)dt.\n     \\label{eq:Appendix.differentiation-rhoalpha}$$ As $\\rho_{\\alpha}(1)=0$ it follows that $\\tau$ is homogeneous of degree $m$ provided that $$\\int_{-\\infty}^{\\infty} e^{at} h'(t) ds = 0 \\qquad \\text{for $a=m+d+2, \\ldots, m+d+2+k$}.    \n    \\label{eq:Appendix.homogeneous-extension-condition}$$\n\nNext, if $g\\in C_{c}^\\infty({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is such that $\\int g(t)dt=1$, then for any $a \\in {\\ensuremath{\\mathbb{C}}}\\setminus 0$ we have $$\\int _{-\\infty}^{\\infty} e^{at}(\\frac{1}{a}\\frac{d}{dt}+1)g(t)dt=0.\n         \\label{eq:Appendix1.integral-a-g}$$ Therefore, if $m \\not\\in{\\ensuremath{\\mathbb{Z}}}$ then we can check that the conditions\u00a0(\\[eq:Appendix.homogeneous-extension-condition\\]) are satisfied by $$h'(t)=\\prod_{a=m+d+2}^{m+d+2+k} (\\frac{1}{a} \\frac{d}{dt} +1)g(t).\n     \\label{eq:Appendix1.h'}$$ As $\\int_{-\\infty}^{\\infty}h'(t)dt=1$ we then see that the distribution $\\tau$ defined by\u00a0(\\[eq:Appendix.almosthomogeneous-extension\\]) with $\\psi(\\mu)=\\int_{\\log \\mu}^\\infty h'(t)dt$ is a homogeneous extension of $p(\\xi)$.\n\nOn the other hand, if $\\tilde{\\tau}\\in{\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ is another homogeneous extension of $p(\\xi)$ then $\\tau-\\tau_{1}$ is supported at the origin, so we have $\\tau=\\tilde{\\tau} + \\sum b_{\\alpha} \n\\delta^{(\\alpha)}$ for some constants $b_{\\alpha}\\in{\\ensuremath{\\mathbb{C}}}$. Then, for any $\\lambda>0$, we have $$\\tau_{\\lambda}-\\lambda^{m}\\tau=\\tilde{\\tau}_{\\lambda}-\\lambda^{m}\\tilde{\\tau} + \n    \\sum (\\lambda^{-(d+2-{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}})} -\\lambda^m) b_{\\alpha}\\delta^{(\\alpha)}.\n   \\label{eq:Appendix.tau-l-tau-tilde}$$ As both $\\tau$ and $\\tilde{\\tau}$ are homogeneous of degree $m$, we deduce that $\\sum (\\lambda^{-(d+2-{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}})} -\\lambda^m) b_{\\alpha}\\delta^{(\\alpha)}=0$. The linear independence of the family $\\{\\delta^{(\\alpha)}\\}$ then implies that all the constants $b_{\\alpha}$ vanish, that is, we have $\\tilde{\\tau}=\\tau$. Thus $\\tau$ is the unique homogeneous extension of $p(\\xi)$ on ${\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}}$.\n\nNow, assume that $m$ is an integer $\\leq -(d+2)$. Then in the formula\u00a0(\\[eq:Appendix.almosthomogeneous-extension\\]) for $\\tau$ we can take $k=-(m+d+2)$ and let $\\psi$ be of the form, $$\\psi(\\mu)=\\int_{\\log \\mu}^\\infty h'(t) dt, \\qquad h'(t)=\\prod_{a=m+d+2}^{m+d+2+k} (\\frac{1}{a} \\frac{d}{dt} +1) g(t),\n$$ with $g\\in C_{c}^\\infty({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$ such that $\\int g(t)dt=1$. Then thanks to\u00a0(\\[eq:Appendix.differentiation-rhoalpha\\]) and\u00a0(\\[eq:Appendix1.integral-a-g\\]) we have $\\rho_{\\alpha}(\\lambda)=0$ for ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}<-(m+d+2)$, while for ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=-(m+d+2)$ we get $$\\frac{d}{ds}\\rho_{\\alpha}(e^s)=\\int h'(t)dt= \\int g(t)dt=  1. \n$$ Since $\\rho_{\\alpha}(1)=0$ it follows that $\\rho_{\\alpha}(e^{s})=s$, that is, we have $\\rho_{\\alpha}(\\lambda)=\\log \\lambda$. Thus, $$\\tau_{\\lambda}=\\lambda^{m}\\tau +\\lambda^{m}\\log \\lambda\\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=-(m+d+2)} c_{\\alpha}(p)\\delta^{(\\alpha)} \\qquad \\forall \\lambda>0.\n     \\label{eq:Appendix.taulambda-tau}$$ In particular, we see that if all the coefficients $c_{\\alpha}(p)$ with ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=-(m+d+2)$ vanish then $\\tau$ is homogeneous of degree $m$.\n\nConversely, suppose that $p(\\xi)$ admits a homogeneous extension $\\tilde{\\tau}\\in{\\ensuremath{\\mathcal{S}}}'({\\ensuremath{{\\ensuremath{\\mathbb{R}}}^{d+1}}})$. As $\\tau-\\tilde{\\tau}$ is supported at $0$, we can write $\\tau=\\tilde{\\tau} + \\sum b_{\\alpha} \n\\delta^{(\\alpha)}$ with $b_{\\alpha}\\in{\\ensuremath{\\mathbb{C}}}$. For any $\\lambda>0$ we have $ \\tilde{\\tau}_{\\lambda}=\\lambda^{m}\\tilde{\\tau}$, so by combining this with\u00a0(\\[eq:Appendix.tau-l-tau-tilde\\]) we get $$\\tau_{\\lambda}-\\lambda^{m}\\tau  = \\sum_{{\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}\\neq -(m+d+2)} \n    b_{\\alpha}(\\lambda^{-({\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}+d+2)}-\\lambda^{m})\\delta^{(\\alpha)}.\n$$ By comparing this with\u00a0(\\[eq:Appendix.taulambda-tau\\]) and by using linear independence of the family $\\{\\delta^{(\\alpha)}\\}$ we then deduce that we have $c_{\\alpha}(p)=0$ for ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}= -(m+d+2)$. Therefore $p(\\xi)$ admits a homogeneous extension if and only if all the coefficients $c_{\\alpha}(p)$ with ${\\ensuremath{\\langle\\! \\alpha\\!\\rangle}}=-(m+d+2)$ vanish. The proof of Lemma\u00a0\\[lem:Heisenberg.extension-symbol\\] is thus achieved.\n\n[GJMS]{} Beals, R.; Greiner, P.C.: *Calculus on Heisenberg manifolds*. Annals of Mathematics Studies, vol. 119. Princeton University Press, Princeton, NJ, 1988.\n\nBeals, R.; Greiner, P.C. Stanton, N.K.: *The heat equation on a CR manifold*. J. Differential Geom. **20** (1984), no. 2, 343\u2013387.\n\nBella[\u00ef]{}che, A.: *The tangent space in sub-Riemannian geometry*. *Sub-Riemannian geometry*, 1\u201378, Progr. Math., 144, Birkh\u00e4user, Basel, 1996.\n\nBerline, N.; Getzler, E.; Vergne, M.: *Heat kernels and Dirac operators*. Grundlehren der Mathematischen Wissenschaften, vol. 298. Springer-Verlag, Berlin, 1992.\n\nBiquard, O.: *M\u00e9triques d\u2019Einstein asymptotiquement sym\u00e9triques.* Ast\u00e9risque No. 265 (2000).\n\nBony, J.M: *Principe du maximum, in\u00e9galit\u00e9 de Harnack et unicit\u00e9 du probl\u00e8me de Cauchy pour les op\u00e9rateurs elliptiques d\u00e9g\u00e9n\u00e9r\u00e9s*. Ann. Inst. Fourier **19** (1969) 277\u2013304.\n\nBoutet de Monvel, L.: *Hypoelliptic operators with double characteristics and related pseudo-differential operators.* Comm. Pure Appl. Math. **27** (1974), 585\u2013639.\n\nBoutet de Monvel, L.; Guillemin, V. *The spectral theory of Toeplitz operators*. Annals of Mathematics Studies, 99. Princeton University Press, Princeton, NJ, 1981.\n\nChrist, M.; Geller, D.; G\u0142owacki, P.; Polin, L.: *Pseudodifferential operators on groups with dilations.* Duke Math. J. **68** (1992) 31\u201365.\n\nConnes, A.: *The action functional in noncommutative geometry*. Comm. Math. Phys. **117** (1988), no. 4, 673\u2013683.\n\nConnes, A.: *Noncommutative geometry*. Academic Press, Inc., San Diego, CA, 1994.\n\nConnes, A.: *Gravity coupled with matter and the foundation of non-commutative geometry*. Comm. Math. Phys. **182** (1996), no. 1, 155\u2013176.\n\nConnes, A.; Moscovici, H.: *The local index formula in noncommutative geometry*. Geom. Funct. Anal. **5** (1995), no. 2, 174\u2013243.\n\nDixmier, J.: *Existence de traces non normales.* C. R. Acad. Sci. Paris S\u00e9r. A-B **262** (1966) A1107\u2013A1108.\n\nDynin, A.: *Pseudodifferential operators on the Heisenberg group.* Dokl. Akad. Nauk SSSR **225** (1975) 1245\u20131248.\n\nDynin, A.: *An algebra of pseudodifferential operators on the Heisenberg groups. Symbolic calculus.* Dokl. Akad. Nauk SSSR **227** (1976), 792\u2013795.\n\nEliashberg, Y.; Thurston, W.: *Confoliations*. University Lecture Series, 13, AMS, Providence, RI, 1998.\n\nEpstein, C.L.; Melrose, R.B.: *The Heisenberg algebra, index theory and homology*. Preprint, 1998. Available at `http://www-math.mit.edu/\\tilde{}rbm`.\n\nEpstein, C.L.; Melrose, R.B.; Mendoza, G.: *Resolvent of the Laplacian on strictly pseudoconvex domains*. Acta Math. **167** (1991), no. 1-2, 1\u2013106.\n\nFedosov, B.V.; Golse, F.; Leichtnam, E.; Schrohe, E.: *The noncommutative residue for manifolds with boundary*. J. Funct. Anal. **142** (1996), no. 1, 1\u201331.\n\nFefferman, C.: *Monge-Amp\u00e8re equations, the Bergman kernel, and geometry of pseudoconvex domains*. Ann. of Math. (2) **103** (1976), no. 2, 395\u2013416.\n\nFefferman, C.L.; S\u00e1nchez-Calle, A.: *Fundamental solutions for second order subelliptic operators*. Ann. of Math. (2) **124** (1986), no. 2, 247\u2013272.\n\nFolland, G.; Stein, E.M.: *Estimates for the $\\bar \\partial\\sb{b}$ complex and analysis on the Heisenberg group.* Comm. Pure Appl. Math. **27** (1974) 429\u2013522.\n\nGilkey, P.B.: *Invariance theory, the heat equation, and the Atiyah-Singer index theorem*. Mathematics Lecture Series, 11. Publish or Perish, Inc., Wilmington, Del., 1984.\n\nGohberg, I.C.; Kre\u012dn, M.G.: *Introduction to the theory of linear nonselfadjoint operators*. Trans. of Math. Monographs 18, AMS, Providence, 1969.\n\nGover, A.R.; Graham, C.R.: *CR invariant powers of the sub-Laplacian.* J. Reine Angew. Math. **583** (2005), 1\u201327.\n\nGreenleaf, A.: *The first eigenvalue of a sub-Laplacian on a pseudo-Hermitian manifold*. Comm. Partial Differential Equations **10** (1985), no. 2, 191\u2013217.\n\nGromov, M.: *Carnot-Carath\u00e9odory spaces seen from within*. *Sub-Riemannian geometry*, 79\u2013323, Progr. Math., 144, Birkh\u00e4user, Basel, 1996.\n\nGuillemin, V.: *A new proof of Weyl\u2019s formula on the asymptotic distribution of eigenvalues*. Adv. in Math. **55** (1985), no. 2, 131\u2013160.\n\nGuillemin, V.W.: *Gauged Lagrangian distributions.* Adv. Math. **102** (1993), no. 2, 184\u2013201.\n\nGuillemin, V.: *Residue traces for certain algebras of Fourier integral operators*. J. Funct. Anal. **115** (1993), no. 2, 391\u2013417.\n\nHelffer, B.; Nourrigat, J.: *Hypoellipticit\u00e9 maximale pour des op\u00e9rateurs polyn\u00f4mes de champs de vecteurs.* Prog. Math., No. 58, Birkh\u00e4user, Boston, 1986.\n\nJerison, D.; Lee, J.M.: *The Yamabe problem on CR manifolds*. J. Differential Geom. **25** (1987), no. 2, 167\u2013197.\n\nJulg, P.; Kasparov, G.: *Operator $K$-theory for the group ${\\rm SU}(n,1)$*. J. Reine Angew. Math. **463** (1995), 99\u2013152.\n\nKalau, W.; Walze, M.: *Gravity, non-commutative geometry and the Wodzicki residue*. J. Geom. Phys. **16** (1995), no. 4, 327\u2013344.\n\nKassel, C.: *Le r\u00e9sidu non commutatif (d\u2019apr\u00e8s M. Wodzicki)*. S\u00e9minaire Bourbaki, Vol. 1988/89. Ast\u00e9risque No. 177-178, (1989), Exp. No. 708, 199\u2013229.\n\nKastler, D.: *The Dirac operator and gravitation*. Comm. Math. Phys. **166** (1995), no. 3, 633\u2013643.\n\nKohn, J.J.: *Boundaries of complex manifolds*. 1965 Proc. Conf. Complex Analysis (Minneapolis, 1964) pp. 81\u201394 Springer, Berlin\n\nKohn, J.J.; Rossi, H.: *On the extension of holomorphic functions from the boundary of a complex manifold*. Ann. of Math. **81** (1965) 451\u2013472.\n\nKontsevich, M.; Vishik, S.: *Geometry of determinants of elliptic operators.* *Functional analysis on the eve of the 21st century*, Vol. 1 (New Brunswick, NJ, 1993), 173\u2013197, Progr. Math., 131, Birkh\u00e4user Boston, Boston, MA, 1995.\n\nLee, J.M.: *The Fefferman metric and pseudo-Hermitian invariants*. Trans. Amer. Math. Soc. **296** (1986), no. 1, 411\u2013429.\n\nLesch, M.: *On the noncommutative residue for pseudodifferential operators with log-polyhomogeneous symbols*. Ann. Global Anal. Geom. **17** (1999), no. 2, 151\u2013187.\n\nMachedon, M.: *Estimates for the parametrix of the Kohn Laplacian on certain domains*. Invent. Math. **91** (1988), no. 2, 339\u2013364.\n\nMathai, V.; Melrose, R.; Singer, I.: *Fractional index theory*. J. Differential Geom. **74** (2006) 265\u2013292.\n\nMelrose, R.; Nistor, V.: *Homology of pseudodifferential operators I. Manifolds with boundary*. Preprint, arXiv, June \u201896.\n\nNagel, A.; Stein, E.M.; Wainger, S.: *Balls and metrics defined by vector fields. I. Basic properties*. Acta Math. **155** (1985), no. 1-2, 103\u2013147.\n\nPaycha, S.; Rosenberg, S.: *Curvature on determinant bundles and first Chern forms*. J. Geom. Phys. **45** (2003), no. 3-4, 393\u2013429.\n\nPonge, R.: *Calcul fonctionnel sous-elliptique et r\u00e9sidu non commutatif sur les vari\u00e9t\u00e9s de Heisenberg*. C.\u00a0R. Acad. Sci. Paris, S\u00e9rie I, **332** (2001) 611\u2013614.\n\nPonge, R.: *G\u00e9om\u00e9trie spectrale et formules d\u2019indices locales pour les vari\u00e9t\u00e9s CR et contact*. C. R. Acad. Sci. Paris, S\u00e9rie I, **332** (2001) 735\u2013738.\n\nPonge, R.: *Spectral asymmetry, zeta functions and the noncommutative residue*. Int. J. Math. **17** (2006), 1065-1090.\n\nPonge, R.: *The tangent groupoid of a Heisenberg manifold.* Pacific Math. J. **227** (2006) 151\u2013175.\n\nPonge, R.: *Heisenberg calculus and spectral theory of hypoelliptic operators on Heisenberg manifolds.* E-print, arXiv, Sep.\u00a005, 140 pages. To appear in Mem. Amer. Math. Soc..\n\nPonge, R.: *Noncommutative residue invariants for CR and contact manifolds.* E-print, arXiv, Oct.\u00a005, 30 pages. To appear in J. Reine Angew. Math.. Ponge, R.: *Noncommutative geometry and lower dimensional volumes in Riemannian geometry*. E-print, arXiv, July\u00a007.\n\nPonge, R.: *Hypoelliptic functional calculus on Heisenberg manifolds. A resolvent approach.* E-print, arXiv, Sep.\u00a007.\n\nRockland, C.: *Hypoellipticity on the Heisenberg group-representation-theoretic criteria.* Trans. Amer. Math. Soc. **240** (1978) 1\u201352.\n\n\u00caRockland, C.: *Intrinsic nilpotent approximation.* Acta Appl. Math. **8** (1987), no. 3, 213\u2013270.\n\nRothschild, L.; Stein, E.: *Hypoelliptic differential operators and nilpotent groups.* Acta Math. **137** (1976) 247\u2013320.\n\nRumin, M.: *Formes diff\u00e9rentielles sur les vari\u00e9t\u00e9s de contact*. J. Differential Geom. **39** (1994), no.2, 281\u2013330.\n\nS\u00e1nchez-Calle, A.: *Fundamental solutions and geometry of the sum of squares of vector fields*. Invent. Math. **78** (1984), no. 1, 143\u2013160.\n\nSchrohe, E.: *Noncommutative residues and manifolds with conical singularities*. J. Funct. Anal. **150** (1997), no. 1, 146\u2013174.\n\nStanton, N.K.: *Spectral invariants of CR manifolds*. Michigan Math. J. **36** (1989), no. 2, 267\u2013288.\n\nTanaka, N.: *A differential geometric study on strongly pseudo-convex manifolds*. Lectures in Mathematics, Department of Mathematics, Kyoto University, No. 9. Kinokuniya Book-Store Co., Ltd., Tokyo, 1975.\n\nTaylor, M.E.: *Noncommutative microlocal analysis. I.* Mem. Amer. Math. Soc. 52 (1984), no. 313,\n\nWebster, S.: *Pseudo-Hermitian structures on a real hypersurface*. J. Differential Geom. **13** (1978), no. 1, 25\u201341.\n\nVan Erp, E.: PhD thesis, Pennsylvania State University, 2005.\n\nVassout, S.: *Feuilletages et r\u00e9sidu non commutatif longitudinal*. PhD thesis, University of Paris 7, 2001.\n\nWodzicki, M.: *Local invariants of spectral asymmetry*. Invent. Math. **75** (1984), no. 1, 143\u2013177.\n\nWodzicki, M.: *Spectral asymmetry and noncommutative residue* (in Russian), Habilitation Thesis, Steklov Institute, (former) Soviet Academy of Sciences, Moscow, 1984.\n\nWodzicki, M.: *Noncommutative residue. I. Fundamentals*. *$K$-theory, arithmetic and geometry* (Moscow, 1984\u20131986), 320\u2013399, Lecture Notes in Math., 1289, Springer, Berlin-New York, 1987.\n\nWodzicki, M.: *The long exact sequence in cyclic homology associated with extensions of algebras*. C. R. Acad. Sci. Paris S\u00e9r. I Math. **306** (1988), no. 9, 399\u2013403.\n"
}