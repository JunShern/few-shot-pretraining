{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": true,
            "reason": "Text contains ['Q:', 'A:']."
        },
        {
            "criterion": "FullyStructured",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        }
    ],
    "doc_id": "6486",
    "text": "Q:\n\narray not getting values\n\nI am running a script that changes values in a formula with a message box. \nvar searchtext = Browser.inputBox(\"Enter search text\");\nvar replacetext = Browser.inputBox(\"Enter replace text\");\nvar form = ss1.getRange(\"D3\");\nvar formula = form.getFormula();\nvar updated =formula;\nupdated.indexOf(searchtext);\nupdated = updated.replace(searchtext, replacetext);\nform.setFormula(updated);\n\nvar form2 = ss1.getRange(\"D10\");\nvar formula2 = form2.getFormula();\nvar updated2 =formula2;\nupdated2.indexOf(searchtext);\nupdated2 = updated2.replace(searchtext, replacetext);\nform2.setFormula(updated2);\n\nAs you notice I have to repeat the code for the different ranges I have. In the code above I have D3 and D10 ranges. I have around another 20 ranges that I need to replace formula from. I have created this array to hopefully do them all together while the script runs but I am not seeing any changes. Any ideas why would this be happening?\n  function dash(){\nvar ss1 = SpreadsheetApp.getActiveSpreadsheet();\nvar searchtext = Browser.inputBox(\"Enter search text\");\nvar replacetext = Browser.inputBox(\"Enter replace text\");\n\nvar rangeArray =     ss1.setActiveSheet(ss1.getSheetByName(\"Ranges\").getRange(\"A1:A5\").getValues());\nvar daily = ss1.setActiveSheet(ss1.getSheetByName(\"Daily\"));\n\nfor(var i in rangeArray){\nvar form = daily.getRange(rangeArray[i][0]);\n\nvar formula = getRange(form).getFormula();\nvar updated =formula;\nupdated.indexOf(searchtext);\nupdated = updated.replace(searchtext, replacetext);\nform.setFormula(updated);}\n\n}\n\nA:\n\nThere are a few informtion about your sheet layout that I ignore so I had to make some assumptions...\nI suppose the ranges you want to process are columns in the sheet so I would do something like this (see comments in code): (I didn't have the opportunity to test this code, it might need some debugging)\nfunction dash(){\n    var ss1 = SpreadsheetApp.getActiveSpreadsheet();\n    var searchtext = Browser.inputBox(\"Enter search text\");\n    var replacetext = Browser.inputBox(\"Enter replace text\");\n    var rangeArray = ss1.getSheetByName(\"Ranges\").getRange(\"A1:A4\").getValues(); // I suppose these cells contains A1 notation of the useful ranges\n    var daily = ss1.setActiveSheet(ss1.getSheetByName(\"Daily\"));\nLogger.log(rangeArray)\n    for(var i in rangeArray){\n    var formula = daily.getRange(rangeArray[i][0].toString()).getFormula();//\nLogger.log(formula)\n    var updated =formula.toString().replace(searchtext, replacetext);\nLogger.log(updated)    \n}\n    daily.getRange(rangeArray[i][0].toString()).setFormula(updated);//\n}\n\nEDIT : removed first code and replaced following your comment and example sheet\n\n"
}