{
    "criteria": [
        {
            "criterion": "AllDocuments",
            "passed": true,
            "reason": "All documents pass."
        },
        {
            "criterion": "QuestionAnswerStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "FullyStructured",
            "passed": true,
            "reason": "Text contains Markdown."
        },
        {
            "criterion": "ExamStringsV2",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStrings",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesStringsV2",
            "passed": true,
            "reason": "Text contains This includes."
        },
        {
            "criterion": "ListPrefixV2",
            "passed": true,
            "reason": "Text contains ['-', '-', '-', '-', '-', '-', '1', '2', '3', '1', '2', '3', '1', '-', '1', '1', '2', '1', '*', '*', '1', '2', '*', '*', '1', '1', '1', '2', '2', '1', '2', '2']."
        },
        {
            "criterion": "ExamplesMinimalEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesSynonymsEmbed",
            "passed": false,
            "reason": "Does not meet criterion."
        },
        {
            "criterion": "ExamplesDiverseEmbed",
            "passed": true,
            "reason": "Text contains ['Such killing times of around 10 minutes are consistent with the duration of killing events that can be observed in various supplemental videos elsewhere \\\\[[@pcbi.1007972.ref008],[@pcbi.1007972.ref009]\\\\]. (0.180)', 'Thus, our maximum likelihood approach based on contact time monitoring can distinguish multiple-hitting from alternative hypotheses and is expected to work for a relatively small number of samples. (0.196)', 'A particular advantage of a parametric survivorship analysis such as that we employ here is that, having estimated the hitting parameters (*\u03b7*,*\u03bb*), we can revisit the sample data and ask whether different subsets of targets were killed according to our expectation. (0.188)', 'Although CTL cooperativity and multiple-hitting have now been described in a number of settings \\\\[[@pcbi.1007972.ref007],[@pcbi.1007972.ref010]--[@pcbi.1007972.ref012]\\\\], a detailed quantitative description of the sequence of intracellular events which might underlie multiple-hitting does not yet exist. (0.195)', 'Regarding the spatial model, it remains unclear how the \"two CTL motility patterns\" are used in the simulations: how are the two states set for individual cells? (0.196)', 'While this is true and nicely shown, I think the study would substantially benefit if the authors also show how the proposed information from imaging studies should differ in case of the latter scenario or others. (0.192)', 'Maybe there are better ways of representation, e.g. (0.192)']."
        }
    ],
    "doc_id": "6815",
    "text": "All relevant data are within the manuscript and its Supporting Information files.\n\nIntroduction {#sec001}\n============\n\nCytotoxic T Lymphocytes (CTLs) are key effectors in the adaptive immune response, therefore CTL function---or lack thereof---is relevant in many pathologies. A greater quantitative understanding of CTL effector function will aid in interpretation of prior experiments and should yield useful insights for the treatment of diseases in the future. However, the rate at which CTLs kill infected or malignant cells remains poorly characterised. Estimates of CTL killing based on *in vitro* and *in vivo* CTL killing assays vary, with some variation explained by e.g. different susceptibility of target cells to CTL killing or the type of antigen expressed by the targets \\[[@pcbi.1007972.ref001],[@pcbi.1007972.ref002]\\]. Moreover, especially *in vivo* the presence of stimulatory or suppressive factors and difficulty in controlling or estimating the ratio of CTLs to target cells at the site of killing might confound CTL killing estimates \\[[@pcbi.1007972.ref001],[@pcbi.1007972.ref002]\\].\n\nAs a frequently discussed example, consider the *in vivo* CTL killing assay of Barber *et*. *al*. \\[[@pcbi.1007972.ref003]\\], in which CTLs demonstrated rapid killing against Lymphocytic Choriomeningitic Virus (LCMV). Although Barber *et*. *al*. initially estimated that CTLs took 15 minutes to kill targets, subsequent modelling studies based on the same data have estimated much faster killing rates \\[[@pcbi.1007972.ref004],[@pcbi.1007972.ref005],[@pcbi.1007972.ref006]\\], with one study implying an expected target survival time of 16 seconds after contact from a CTL \\[[@pcbi.1007972.ref004]\\] (see also \\[[@pcbi.1007972.ref001]\\] for a detailed summary of these estimates). Given that killing in those experiments was perforin-dependent\\[[@pcbi.1007972.ref003]\\], these fast estimates seem to contradict recent *in-vivo* imaging showing that the perforin-dependent killing process requires a minimal contact time. For example, long-lasting (median: 80s) calcium fluxes linked with CTL killing of virally infected cells occurred, on average, 480s (median) after CTLs established contact with virally infected targets\\[[@pcbi.1007972.ref007]\\]. Such killing times of around 10 minutes are consistent with the duration of killing events that can be observed in various supplemental videos elsewhere \\[[@pcbi.1007972.ref008],[@pcbi.1007972.ref009]\\]. Given this lower bound it is difficult to see how solely granule-mediated killing could plausibly lead to killing rates in excess of \\~6 hour^-1^, even in optimal situations where CTLs are not limited in their supply of targets and do not require time to search for new targets between killing events.\n\nA major limitation of many prior estimates of CTL killing is that analysis is performed on population level data in *in vivo* settings, with no direct measurements of the killing process. This approach has a number of drawbacks: First, it can be challenging to accurately assess the frequency of CTLs and target cells. Second, other immune cells may contribute to the killing process, confounding estimates of the true CTL killing rate. Third, the processes underlying CTL killing are complex and it may be insufficient to describe them with a single, time invariant rate constant. Indeed, recent observations have indicated that target cells may require multiple hits before death either *in vitro* \\[[@pcbi.1007972.ref010]\\], or *in vivo* \\[[@pcbi.1007972.ref007]\\]. We have previously shown that such multiple-hitting can lead to a time-increasing killing kinetic when CTLs are exposed to fresh targets \\[[@pcbi.1007972.ref011],[@pcbi.1007972.ref012]\\], further complicating the killing rate estimation procedure.\n\nBesides analysing CTL killing performance at the population level, a potentially useful approach is to analyse CTL killing at the single cell level. Such analysis can yield greater insights into the dynamics of the killing process. This was exemplified in studies undertaken in the 1970's in which the killing kinetics of CTLs conjugated with 1--4 EL4 tumour cell targets were examined under the microscope for a period of 3 hours \\[[@pcbi.1007972.ref013],[@pcbi.1007972.ref014]\\]. Subsequent mathematical analysis of these studies indicated that the CTL killing process was well described as a Poisson process \\[[@pcbi.1007972.ref015]\\], indicating that CTLs kill targets sequentially rather than simultaneously. This analysis allowed the authors to conclude that CTL killing was mediated by secretory lysosomes, several years before this was demonstrated conclusively \\[[@pcbi.1007972.ref016]\\]. The aforementioned studies also revealed that the rate of CTL killing was not diminished after target lysis, an observation which led the authors to deduce that CTLs were able to discriminate between viable and killed targets. More recently, *in vitro* studies of individual natural killer cells have shown that killing occurs via both granzyme and death receptor mediated pathways, each having different kinetics \\[[@pcbi.1007972.ref017],[@pcbi.1007972.ref018]\\].\n\nDespite the utility of studying CTL killing at the single-cell level, there remains a shortage of *in vitro* CTL killing studies with statistical power sufficient to check the validity of the Poisson model first proposed in the 1980's by Perelson et. al. \\[[@pcbi.1007972.ref015]\\]. Recently one such a study was performed: Over a 12 hour period, image-based killing measurements were taken from human-derived CTL clones, each CTL being separately confined within small micro-wells that contained an excess of JY target cells \\[[@pcbi.1007972.ref019]\\]. During the studied time period, the killing rate of CTLs was dynamic, exhibiting a marked increase in the final hours of the experiment. The total number of targets killed per CTL was overdispersed compared to the Poisson distribution, implying greater heterogeneity between individual CTL killing performance than anticipated. Vasconcelos et. al. [(Vasconcelos et al. 2015)](https://paperpile.com/c/oMBHuP/ZTAi) found the data was well described by a Poisson mixture model, and they postulated the existence of a subset of \"high rate killers\" comprising 30% of the population that emerged 8--10 hours after first exposure to target cells. However, no mechanistic explanation could be found to explain this result, despite a search for membrane markers that might identify and/or explain the variability of CTL killing characteristics.\n\nWe hypothesised that a requirement for \"multiple hits\" to kill targets before apoptosis induction might explain heterogeneous killing amongst clonal CTLs *in vitro*. Perelson et. al. \\[[@pcbi.1007972.ref020]\\] previously considered the possibility of multiple-hitting, noting however that such a model was excessively complex to describe the limited experimental data available at that time. Recent evidence has directly shown that multiple-hitting does occur at least in some settings \\[[@pcbi.1007972.ref007],[@pcbi.1007972.ref010],[@pcbi.1007972.ref021]\\], and our previous modelling work has demonstrated that multiple-hitting can indeed lead to population-level killing kinetics increasing over time when CTLs are exposed to fresh targets \\[[@pcbi.1007972.ref011]\\]. Therefore, we here used stochastic simulations to investigate the compatibility of the multiple-hitting hypothesis with the findings of Vasconcelos et. al. \\[[@pcbi.1007972.ref019]\\]. We found that multiple-hitting was indeed able to explain the late onset, high-rate bursting kinetic of individual CTLs, with physiologically plausible parameters. We also highlight that multiple-hitting is expected to lead to a complex dependence of realised killing rate upon the number of available targets and on the ability of individual CTLs to form and abort conjugates with target cells. We subsequently developed spatially explicit, agent based simulations of CTLs killing targets in micro-wells as a means of generating realistic yet noisy artificial data and assessing methods of recovering CTL hitting parameters from future microscopy data. Using these spatial simulations, we demonstrate how parameter estimation is substantially improved if contacts of individual targets with CTLs can be tracked throughout the duration of the experiments.\n\nResults {#sec002}\n=======\n\nMultiple-hitting CTLs exhibit heterogeneous late onset killing {#sec003}\n--------------------------------------------------------------\n\nWe first sought to establish whether the multiple-hitting hypothesis was a feasible explanation for the heterogeneous, delayed onset, \"burst\" killing kinetics observed and defined by Vasconcelos *et*. *al*. \\[[@pcbi.1007972.ref019]\\]. In brief, these high rate killer CTLs were a subset among a clonal population whose killing suddenly accelerated after 8--10 hours of experimentation, with no explanation readily apparent (Methods). In the current study, we used Monte Carlo simulations of individual CTLs killing targets to identify conditions under which multiple-hitting might lead to heterogeneous, \"burst\" killing. In these Monte Carlo simulations, CTLs hit targets at a constant rate *\u03bb*, then targets died after receiving *\u03b7* hits. We simulated single- and multiple-hitting scenarios on the basis that the expected (mean) time for one target in contact with a CTL to be killed was 1 hour, i.e., we set *\u03bb*/*\u03b7* = 1 (valid for entire [Fig. 1](#pcbi.1007972.g001){ref-type=\"fig\"}).\n\n![Killing kinetics and heterogeneity of multiple-hitting CTLs.\\\nA) Gamma probability density functions describing expected time for a CTL to kill 1 target in monogamous contact (red lines). Each point represents the sample killing density of one series of simulations (N~S~ = 10), each series comprising N~w~ = 100 CTL:target pairs. Observations were binned at 15 minute intervals. B) Theoretical Gamma probability density function (PDF), survival function, and hazard function for different values of *\u03b7* as indicated. C) Estimation of parameters from simulations in panel A, by equating the first two moments (the mean and variance) with their estimators. D) Distribution of targets killed per CTL at 12 hours (red bars), with Poisson distributions for the initial number of targets (using the same initialising distribution for all *\u03b7*; blue bars). Each panel contains results from N~w~ = 5000 CTLs for different *\u03b7*, as indicated by facet labels on the right. Text inside panels indicates the mean and variance of the killed targets. E) Cumulative killing performance of N~w~ = 100 members (thin black lines) of the population shown in D; the red line is the mean calculated for the entire population (N~w~ = 5000). F) Distribution of target killing times over extended (24 hours) simulations with CTL parameters matching D, with the 12 hour censorship indicated by a red line (N~w~ = 5000, bars are kills per 30 min interval). G) Heatmap of the probability density for each simulation in C-D. Observations were binned according to unique combinations of the initial number of targets (individual columns), together with the number of killed targets at the indicated interval (individual rows). Thus, summing across columns will recover the initial Poisson distribution (blue bars in D), and summing across rows will produce the distribution of killed cells at the indicated time (e.g red bars in D at 12 hours).](pcbi.1007972.g001){#pcbi.1007972.g001}\n\nFirstly we simulated CTLs with *\u03b7* = 1,2, or 10, with each simulation containing one CTL interacting with a single target. For such a strictly 1:1 CTL:target ratio, the waiting times for target death were gamma distributed with rate parameter *\u03bb* and shape parameter *\u03b7* ([Fig 1A](#pcbi.1007972.g001){ref-type=\"fig\"}). The gamma distributions ([Fig 1B](#pcbi.1007972.g001){ref-type=\"fig\"}, top panel), together with their accompanying survival probability functions ([Fig 1B](#pcbi.1007972.g001){ref-type=\"fig\"}, middle panel), define the hazard function ([Fig 1B](#pcbi.1007972.g001){ref-type=\"fig\"}, bottom panel), which is the momentary rate of death experienced by a target, given that the target has already survived an interaction for some time, *t*. When *\u03b7* = 1, the hazard experienced by contacted targets does not change with time. In contrast, when *\u03b7*\\>1 the hazard experienced by contacted targets increases over time, as contacted targets become increasingly likely to have received (*\u03b7*\u22121) hits and thus be killed by the next hit. For the case where CTLs interact with targets in a strictly 1:1 ratio, the gamma(\u03b7, \u03bb) distribution parameters could be estimated from the mean and variance of the samples of the waiting time (y~o~): $\\overline{y_{o}} = \\frac{\\eta}{\\lambda}$ and $\\left. {Var\\left( y \\right.}_{o} \\right) = \\frac{\\eta}{\\lambda^{2}}$ ([Fig 1C](#pcbi.1007972.g001){ref-type=\"fig\"}).\n\nWe next extended our Monte Carlo simulations to allow CTL:target interactions in a 1:n ratio, for variable numbers of targets, *n*. CTLs were individually assigned their initial number of targets by drawing *n* from a Poisson distribution, with mean $\\overline{n} = 16$ ([Fig 1D](#pcbi.1007972.g001){ref-type=\"fig\"}, blue bars). The total number of targets killed by a CTL during one simulation, *x*, should also follow the Poisson distribution, if the killing rate of each simulated CTL would be the same. Moreover, the mean and variance should be approximately equal for any set of Poisson distributed samples. Therefore, observation of a ratio $\\frac{var\\left( x \\right)}{\\overline{x}} > 1$ for a set of killed targets would imply that the killing was more heterogeneous than expected under Poisson assumptions. For single-hit killing (*\u03b7* = 1), the variance of the 12 hour killing samples was in fact slightly below the mean ([Fig 1D](#pcbi.1007972.g001){ref-type=\"fig\"}, upper row), resulting from some simulations where CTLs killed all their targets before the simulation had finished. However, for *\u03b7* = 2 ([Fig 1D](#pcbi.1007972.g001){ref-type=\"fig\"}, central row), the variance approached the mean and for *\u03b7* = 10 far exceeded the mean ([Fig 1D](#pcbi.1007972.g001){ref-type=\"fig\"}, bottom row). In the latter case, a bimodal distribution occurred, which could be interpreted as a subpopulation of high-rate killers, yet importantly such a population did not exist in our simulations.\n\nIn our simulations, the additional variability in killing performance of multiple-hitting CTLs was due to the allocation of subsequent hits amongst several different targets. When a group of targets share hits evenly, the time for a specified target to be hit is proportional to the number of other targets sharing. This has no effect on the killing rate observed if *\u03b7* = 1, so the mean killing rate for our simulated single-hitting CTLs initially remained constant over time ([Fig 1E and 1F](#pcbi.1007972.g001){ref-type=\"fig\"}, top row; time\\<8h), gradually decreasing as some CTLs eliminated all their targets ([Fig 1E and 1F](#pcbi.1007972.g001){ref-type=\"fig\"}, top row; time\\>8h). In contrast, hit sharing in the case of multiple-hitting CTLs led to a delayed onset of killing ([Fig 1E and 1F](#pcbi.1007972.g001){ref-type=\"fig\"}), with the length of the delay dependent on the number of targets sharing hits (compare [Fig 1A and 1B](#pcbi.1007972.g001){ref-type=\"fig\"} with single targets to [Fig 1F](#pcbi.1007972.g001){ref-type=\"fig\"} with multiple targets, for identical *\u03b7*). The interaction between *\u03b7* and the number of initial targets can also be understood from heatmaps of targets killed ([Fig 1G](#pcbi.1007972.g001){ref-type=\"fig\"}). The expected cumulative number of kills increases over time for *\u03b7*,*\u03bb* = 1, but this increase is independent of the initial number of targets except for the censorship implying a maximum target number that can be killed. For *\u03b7*,*\u03bb* = 10, the dependency of the observed kills on the initial number of targets is very clear, with killing happening earlier in those wells with initially fewer targets. Moreover, these effects did not only depend on the initial number of targets. When we performed simulations with the hitting rate *\u03bb* a random variable, this in turn increased the variability of killing amongst multiple-hitting CTLs to a greater extent than was the case for single-hitting CTLs ([S1 Fig](#pcbi.1007972.s003){ref-type=\"supplementary-material\"}), implying that the killing of multiple-hitting CTLs is more sensitive to environmental variables than the single-hitting CTLs. Taken together, these results imply that multiple-hitting CTLs could explain both heterogeneous and delayed onset killing among clonal CTL populations.\n\nMultiple-hitting is not identifiable based on population killing statistics only {#sec004}\n--------------------------------------------------------------------------------\n\nWe asked if population-level killing statistics (as e.g. examined in \\[[@pcbi.1007972.ref019]\\])) could be used to identify the hitting parameters (*\u03bb* and *\u03b7*) of CTLs. In our previous simulations ([Fig 1](#pcbi.1007972.g001){ref-type=\"fig\"}) we studied a scenario of simultaneous risk for target cells, yet this may be an oversimplification. For example, due to physical constraints the number of targets CTLs can simultaneously contact and thus hit must be limited. Therefore, we extended our *1*:*n* Monte Carlo simulations to allow dynamic contacts between CTLs and targets, in order to check how the parameter estimates (*\u03bb* and *\u03b7*) would be impacted. To achieve this, we included an additional state for target cells, now distinguishing between targets that are contacting the CTL, versus those not in-contact ([Fig 2A](#pcbi.1007972.g002){ref-type=\"fig\"}; Methods). The killing kinetics realized by CTLs in these dynamic simulations indeed differed from those in our previous simulations ([Fig 1](#pcbi.1007972.g001){ref-type=\"fig\"}), where all the targets shared risk and so the killing rate of each CTL was dictated by the total number of yet-living targets. In contrast, for our Monte Carlo simulations allowing dynamic conjugate formation, only the targets presently being contacted were relevant. Here, small bursting events occurred throughout the simulations, which was the result of accumulating hits followed by rapid sequential killing among a subset of contacted targets ([Fig 2B](#pcbi.1007972.g002){ref-type=\"fig\"}).\n\n![Burst killing and non-identifiability of dynamically interacting, multiple hitting CTLs.\\\nA) Schematic of the dynamic model (example with *\u03b7* = 3). Target cells are represented by circles containing fractions (numerator: hits received; denominator: *\u03b7*). The observable state \\[*C U*\\] consists of the total number of contacting, *C*, and non-contacting targets, *U*. The complete state of the system is represented by a matrix, with *\u03b7* rows indicating the number of hits received (subscript) and with columns indicating whether the target is contacting (*c*~*i*~) or non-contacting (*u*~*i*~). B) Measured killing events (red dots, filled white) during Monte Carlo simulations with *N*~*w*~ *= 10* CTLs and the number of targets drawn from a Poisson distribution with mean $\\overline{n} = 16$ (top panels; *\u03bb*,*\u03b7* = 10,*k*~*off*~ = 0,*k*~*on*~\u2192\u221e), or a subset of targets at risk (bottom panels; *\u03bb*,*\u03b7* = 10,*k*~*on*~ = 1*hr*^\u22121^,*k*~*off*~ = 0.3*hr*^\u22121^). Each horizontal strip is one single simulation, the right panel strips are colored according to the total number of alive targets and the left panel strips are colored according to the number of targets that are in contact with a CTL. C) Each line (coloured according to *\u03b7*) is the mean cumulative killing over time (CTL^-1^) from N~w~ = 10^4^ CTLs, simulated using parameters estimated by fitting the case with $\\overline{n} = 16$ targets (central column). Straight lines show target values for fitting. All parameters except $\\overline{n}$ are constant across columns. D-F) Measured statistics within simulations with $\\overline{n}$ = 16 shown in the central column of C. Shown are the distribution of killed targets after 12 hours, with the mean and variance as indicated for each *\u03b7* (D), and the mean killing rate over time for CTLs grouped by *\u03b7* and shown either separately (E, rows), or together (F, colors), calculated as (*kills*\u22c5(6 *min*\u22c5*N*~*w*~)^\u22121^).](pcbi.1007972.g002){#pcbi.1007972.g002}\n\nUsing our simulations including dynamic conjugate formation we searched for parameters consistent with the statistics reported previously \\[[@pcbi.1007972.ref019]\\]concerning high rate \"burst killing\" CTLs. For fitting we used the reported group mean (4) and variance (6.9) of the number of killed targets per CTL over 12 hours. Additionally, we aimed for a breakpoint in the mean killing rate such that half (2) of the observed kills occurred in the interval 0--9 hours and the other half in the interval 9--12 hours (see [Methods](#sec009){ref-type=\"sec\"}). We performed this fit using different values for *\u03b7* (ranging from 1--5, or 10), and a Poisson variable with $\\overline{n} = 16$ for the initial number of targets ([S2 Fig](#pcbi.1007972.s004){ref-type=\"supplementary-material\"}). We obtained good fits for different values of *\u03b7*; in particular for all *\u03b7*\\>2 the cumulative killing was very closely matched ([Fig 2C](#pcbi.1007972.g002){ref-type=\"fig\"}, intersecting lines for $\\overline{n} = 16$). Moreover, for values *\u03b7*\\>3 the fits to the mean and variance for cumulative targets killed at 12 hours were all similarly close to their target values of 4 and 6.9, respectively ([Fig 2D](#pcbi.1007972.g002){ref-type=\"fig\"}). Some differences for different *\u03b7* were apparent, for example as the number of hits increased towards *\u03b7* = 10 the breakpoint marking transition from low to high rate was more distinct ([Fig 2E](#pcbi.1007972.g002){ref-type=\"fig\"}). However, overall differences between *\u03b7* were quite small ([Fig 2F](#pcbi.1007972.g002){ref-type=\"fig\"}), and many simulated CTLs were required for these differences to emerge consistently (at least N~w~ = 10^3^ CTLs). Our results were also sensitive to the distribution for the initial number of targets per CTL: for simulations with $\\overline{n} = 12$ or 20, substantial differences in the cumulative kills over time occurred ([Fig 2C](#pcbi.1007972.g002){ref-type=\"fig\"}). Thus, we conclude that multiple-hitting is not only qualitatively, but also quantitatively consistent with the experimental results reported previously [(Vasconcelos et al. 2015)](https://paperpile.com/c/oMBHuP/ZTAi). However, our analysis shows that the mean and variance of the killing process measured for a group of CTLs are insufficient statistics to determine the number of hits CTLs require to kill targets, so CTL:target interactions should be explicitly accounted for if killing due to multiple-hitting is to be modelled accurately.\n\nAn Agent Based Model of Multiple-hitting CTLs to test methods for estimation of killing parameters {#sec005}\n--------------------------------------------------------------------------------------------------\n\nSince we found that in many situations the true hitting parameters for CTLs could not be determined based on group level killing mean and variance, we sought methods to compare the likelihood of different hitting models. We did not wish to consider a particular model for the process of CTLs finding targets, preferring a method that could be applied to determine the CTL hitting behaviour in general situations (i.e., in the absence of knowledge on contact dynamics). As a framework for testing we employed an agent based cellular Potts model (CPM) to generate 2D simulations of CTLs interacting with and killing targets ([Fig 3A](#pcbi.1007972.g003){ref-type=\"fig\"}). The resulting datasets were visually similar to realistic microscopy data and could be used to investigate methods for recovering the hitting parameters (*\u03b7* and *\u03bb*) of CTLs from experimental data under various conditions. For all CPM simulations we maintained the same underlying gamma model of CTL hit generation as was used for our Monte-Carlo simulations (Figs [1](#pcbi.1007972.g001){ref-type=\"fig\"} and [2](#pcbi.1007972.g002){ref-type=\"fig\"}), however we made several modifications that would lead to different (yet not [predictable]{.ul} *a priori*) distributions of hits amongst targets. Specifically, instead of allocating hits to all contacted targets with equal probability, target risk of receiving a hit was proportional to the length of the interface between CTL and target at the moment of hit generation ([Fig 3A](#pcbi.1007972.g003){ref-type=\"fig\"}, target coloring on left images indicates interface length). We also considered the effect of a lower bound on the time required for a CTL to complete a hit, by introducing a delay condition that prohibited targets from being hit within an initial time window after contacting a CTL, which was reset every time the target broke contact with the CTL ([Fig 3A](#pcbi.1007972.g003){ref-type=\"fig\"}, target coloring on right images). Note that the delay condition was applied per target and therefore does not preclude the possibility of CTLs hitting other contacted targets simultaneously.\n\n![Characterisation of high- and low-motility *in silico* CTLs within CPM simulations.\\\nA) Still images of a high motility CTL with 15 minute minimal hitting time, interacting with targets. Left color scheme: CTLs are red, uncontacted targets are grey, and contacted targets have various shades of blue based on their share of total CTL:target interface, which determines their probability of receiving a hit. Targets are overlaid with the number of hits they have received. Right color scheme: Lattice sites inhabited by the CTL are colored according to actin activity \\[[@pcbi.1007972.ref022]\\]. Targets are black, turning yellow after 15 minutes of continuous contact with the CTL. Elapsed simulation time is displayed in the upper left corner of the stills, presented in minutes since the first frame shown. B-C) Track plots showing movement of 3 randomly sampled CTLs of high (B) and low (C) motility throughout a simulation, for simulated \u03b7 as shown. D-E) Frequency at which CTLs form new conjugates (D) and mean number of simultaneously contacted targets per CTL (E) for low- and high-motility CTLs. Plots are based on 100 simulations per condition, with each dot representing one CTL, and circles and error bars indicating mean +/- SD.](pcbi.1007972.g003){#pcbi.1007972.g003}\n\nFinally we varied CTL migration to create two groups of CTLs which we termed \"high-motility\" ([Fig 3B](#pcbi.1007972.g003){ref-type=\"fig\"}, [S1 Video](#pcbi.1007972.s009){ref-type=\"supplementary-material\"}) or \"low-motility\" ([Fig 3C](#pcbi.1007972.g003){ref-type=\"fig\"}, [S2 Video](#pcbi.1007972.s010){ref-type=\"supplementary-material\"}) CTLs. For both motility conditions the migration of the CTLs was influenced by the presence of the targets, as CTLs became corralled by surrounding targets. The difference between these models was that high-motility CTLs exhibited an increased propensity to break free from confinement and roam the well. This roaming ensured that over the course of 12 hours the high-motility CTL made new contacts with far greater frequency than low-motility CTLs ([Fig 3D](#pcbi.1007972.g003){ref-type=\"fig\"}), although the average number of simultaneously contacted targets at any time was similar ([Fig 3E](#pcbi.1007972.g003){ref-type=\"fig\"}). Thus, the high-motility CTL is expected to approach the previously modeled 'all targets at risk' scenario more closely than the low-motility CTLs.\n\nWe used the CPM model to simulate CTLs (with *\u03b7*,*\u03bb* = 1,2, *or* 10), in either high- or low-motility scenarios. The total amount of targets killed by each CTL depended on the interaction between the parameters *\u03bb* and *\u03b7*, the CTL motility, and the presence or absence of the delay condition. In particular, the combination of high motility plus 15 minute delay resulted in a substantial decrease in killing in comparison to the other simulation groups, for all values of *\u03b7* ([Fig 4A](#pcbi.1007972.g004){ref-type=\"fig\"}). Together with the high rate of contact formation in that group ([Fig 3D](#pcbi.1007972.g003){ref-type=\"fig\"}), this is consistent with targets spending significant time in transient contacts with the CTL, too short to result in successful hit delivery. The killing rate of the low-motility CTLs was initially greater than of high-motility CTLs, in particular for large *\u03b7* ([Fig 4B](#pcbi.1007972.g004){ref-type=\"fig\"}), due to the more stable nature of the contacts leading to greater accumulation of hits among the contacted targets ([Fig 4C](#pcbi.1007972.g004){ref-type=\"fig\"}). High-motility CTLs reduced this deficit over the course of the simulations due to an accumulation of latent hits among uncontacted targets ([Fig 4D](#pcbi.1007972.g004){ref-type=\"fig\"}). These spatial simulations therefore illustrate how CTL:target contact dynamics can play a role in determining killing performance. Moreover, since in these models CTLs with the same killing parameters---but different motility parameters---generated different killing kinetics, they are useful to test how underlying killing parameters might be recovered from microscopy data that are similar to data emanating from our realistic simulations.\n\n![Killing performance of multiple-hitting CTLs depends on motility.\\\nA) Mean cumulative killing over time (CTL^-1^) for CPM simulations of high- and low- motility CTLs (*\u03b7*,*\u03bb* = 1,2, *or* 10) B) Mean killing rate (CTL^-1^) for each simulated condition in A. C-D) Mean number of hits received per target, sampled over targets currently contacting the CTL (C) or over targets not currently contacting the CTL (D).](pcbi.1007972.g004){#pcbi.1007972.g004}\n\nEstimating CTL hitting parameters through analysis of contact time and target survival {#sec006}\n--------------------------------------------------------------------------------------\n\nSince we found that hitting parameters *\u03b7* and *\u03bb* could not be recovered via analysis of population averages only, we employed a parametric survival analysis to study the hazard experienced by individual targets contacting CTLs. Our analysis considers the different hazard functions identified earlier ([Fig 1B](#pcbi.1007972.g001){ref-type=\"fig\"}), which distinguish CTLs on the basis of their intrinsic hitting rate *\u03bb* and the number of hits required for killing targets, *\u03b7*. Specifically, we analyse the cumulative duration of CTL:target contact events from the perspective of the target cells (example in [Fig 5A](#pcbi.1007972.g005){ref-type=\"fig\"}). To take into account shared hazard amongst a set of co-contacting targets, we recorded for each sampled frame the statistic *\u03b8* = (*c*)^\u22121^ (per-target), representing the probability that each separate target out of the subset of *c* targets co-contacting the CTL is presently being hit ([Fig 5B](#pcbi.1007972.g005){ref-type=\"fig\"}). Note that targets not in contact with the CTL were assigned *\u03b8* = 0. Subsequently, we integrated the *\u03b8* values over time to arrive at a set of 'adjusted' contact times, *\u03c4*, for each target ([Fig 5C](#pcbi.1007972.g005){ref-type=\"fig\"}), which takes into account uncertainty with respect to hitting of multiple co-contacted targets ([Fig 5C](#pcbi.1007972.g005){ref-type=\"fig\"}). This approach has the advantage that no explicit account needs to be taken of the CTL-target interaction dynamics. Moreover, estimation of cellular contact times occurs already frequently in time-lapse imaging data \\[[@pcbi.1007972.ref007],[@pcbi.1007972.ref023]\\], hence is feasible.\n\n![Parameter retrieval for multiple-hitting CTLs based on adjusted contact time.\\\nA) Hypothetical example illustrating sharing of subsequent CTL hits by target cells. Interaction history during a period of 12 hours for each of three target cells contacted by a single CTL, sampled at 30 minute intervals. B) Estimated probability (expressed as fraction *\u03b8*) that each target is being hit by the CTL, corresponding to the hypothetical interaction history shown in A. C) The quantity \u03c4 is defined as the cumulative sum over the course of the simulation of all sampled values of *\u03b8* associated with each individual target. The samples resulting from interaction with this CTL include target 1, which was killed after a cumulative interaction period of \\~1.7h, and targets 2 and 3, which remained alive after cumulative interaction periods of \\~2.4h and \\~7.9h, respectively. D) Heatmaps of the likelihood function around the maximum likelihood estimates for the killing parameters, in CPM simulations without hitting delay. Horizontal and vertical lines mark the values of the CPM parameters used to generate the data for each group. The boundary enclosing the 95% confidence region is also marked with a line. E) Results of fitting 30 randomly chosen subsets, each consisting of N~w~ = 10 simulations, of the CPM simulations without hitting delay.](pcbi.1007972.g005){#pcbi.1007972.g005}\n\nApplying the concept of adjusted contact times, *\u03c4*, on all our CPM simulations, we established maximum likelihood estimates for the hitting parameters within the simulations ([S1 Text](#pcbi.1007972.s002){ref-type=\"supplementary-material\"}; [S3 Fig](#pcbi.1007972.s005){ref-type=\"supplementary-material\"}). This yielded excellent estimates for the parameters in simulations without delay ([Fig 5D](#pcbi.1007972.g005){ref-type=\"fig\"}; *\u03b7*~*CPM*~,*\u03bb*~*CPM*~ indicate input CPM parameter values, and $\\hat{\\lambda},\\ \\hat{\\eta}$ indicate estimated values). We also tested our method of parameter recovery by fitting our model to small subsets taken from the CPM simulations each containing only N~w~ = 10 CTLs ([Fig 5E](#pcbi.1007972.g005){ref-type=\"fig\"}), which led to good estimates. Additionally, we tested our model on sample data generated from a mixed dataset with two subpopulations of single-hitting CTLs, each with a different killing rate ([S1 Text](#pcbi.1007972.s002){ref-type=\"supplementary-material\"}), in order to examine the high-rate-killer hypothesis put forth by Vasconcelos *et*. *al*. \\[[@pcbi.1007972.ref019]\\]. We found that the multiple-hitting model would not predict multiple-hitting unless multiple-hitting was indeed underlying the data, instead predicting a single-hitting population whose killing rate was the mean of the individual subpopulations ([S1 Text](#pcbi.1007972.s002){ref-type=\"supplementary-material\"}; [S4 Fig](#pcbi.1007972.s006){ref-type=\"supplementary-material\"}, [S5 Fig](#pcbi.1007972.s007){ref-type=\"supplementary-material\"}). Thus, our maximum likelihood approach based on contact time monitoring can distinguish multiple-hitting from alternative hypotheses and is expected to work for a relatively small number of samples.\n\nImpact of a hitting threshold on killing parameter estimation {#sec007}\n-------------------------------------------------------------\n\nGiven the time needed for formation of a cytotoxic synapse that is required for hit delivery, brief interactions between CTLs and targets may not contribute to killing. Taking such brief interactions into account in our parameter estimation may thus interfere with correct estimation. Therefore, we tested our parameter recovery on those CPM simulations wherein a 15 minute minimal bound (+15m) was set for the time CTLs required to successfully execute each hit upon a target. In these CPM simulations, we generally obtained robust estimates for the number of hits needed to kill targets, $\\hat{\\eta}$ ([S6A Fig](#pcbi.1007972.s008){ref-type=\"supplementary-material\"}). However, after rounding to the nearest integer value for *\u03b7*, the estimated hitting rate parameter, $\\hat{\\lambda}$, was underestimated compared to the generating value (*\u03bb*~*CPM*~) in simulations with the 15m minimal hitting time. Since the realised killing was reduced in the 15m-delay simulations, particularly for high-motility CTLS ([Fig 4](#pcbi.1007972.g004){ref-type=\"fig\"}), the estimated $\\hat{\\lambda}$ could be considered more appropriate than the generating value *\u03bb*~*CPM*~. Nevertheless, to investigate further we performed additional simulations, using high motility CTLs, with variable hitting delays in the interval between 0--15 mins (Figs [6A](#pcbi.1007972.g006){ref-type=\"fig\"} and [S6B](#pcbi.1007972.s008){ref-type=\"supplementary-material\"}). We found that for the important boundary between single-hitting (*\u03b7* = 1) or multiple-hitting (*\u03b7* = 2), the estimated number of hits parameter $\\hat{\\eta}$ was accurately classified for limited delays of less than 15 minutes ([Fig 6A](#pcbi.1007972.g006){ref-type=\"fig\"}, top row).\n\n![Parameter retrieval for multiple-hitting CTLs with underlying hitting delay.\\\nA) Estimated parameters (points), compared to the underlying parameter values used (red lines) in CPM simulations, featuring high-motility CTLs, in which we varied the lower bound for the time (in minutes, as indicated) needed for hitting. B) Kaplan-Meier survival functions (black lines), or survival functions plotted with estimated parameters fitted to data from N~w~ = 100 CPM simulations generated by multiple-hitting (lower row, *\u03b7*~*CPM*~ = 2) or single-hitting CTLs (upper row, *\u03b7*~*CPM*~ = 1). C) Heatmaps from one CPM simulation containing high-motility, single-hitting CTLs who had a 15 minute lower bound set on the hitting time. Each row represents a single target. Target status is represented by colour: targets not-contacting the CTL are deep purple, and killed targets are grey. Contacted targets are coloured according to their momentary hazard according to two candidate parameter sets (top panel: $\\hat{\\eta} = 1,\\hat{\\lambda} = 0.65$; bottom panel: $\\hat{\\eta} = 2,\\hat{\\lambda} = 1.65$). D) Predicted killing rate according to two different candidate parameter sets ($\\hat{\\eta} = 1$, red lines; $\\hat{\\eta} = 2$, blue lines), candidates being themselves applied to CPM simulations with high-motility, +15m CTLs (*\u03b7*~*CPM*~ = 1, top panel; *\u03b7*~*CPM*~ = 2, bottom panel).](pcbi.1007972.g006){#pcbi.1007972.g006}\n\nA particular advantage of a parametric survivorship analysis such as that we employ here is that, having estimated the hitting parameters (*\u03b7*,*\u03bb*), we can revisit the sample data and ask whether different subsets of targets were killed according to our expectation. We selected the high-motility +15m simulations with *\u03b7*~*CPM*~ = 1 for further study, since for this simulation group there was an ambiguous estimate of $\\hat{\\eta}$. For comparison, we also analysed the data from CPM simulations with multiple-hitting CTLs (*\u03b7*~*CPM*~ = 2). First, we inspected the Kaplan-Meier estimates of the survival functions ([Fig 6B](#pcbi.1007972.g006){ref-type=\"fig\"}, black lines) marking close agreement when the correct parameter estimate ($\\hat{\\eta} = 2$) was applied to CPM data generated by multiple-hitting CTLs ([Fig 6B](#pcbi.1007972.g006){ref-type=\"fig\"} bottom, blue line, *\u03b7*~*CPM*~ = 2), but not when the incorrect $\\hat{\\eta} = 1$ was applied ([Fig 6B](#pcbi.1007972.g006){ref-type=\"fig\"} bottom, red line, *\u03b7*~*CPM*~ = 2). For data generated by single-hitting CTLs, the Kaplan-Meier estimate lay exactly between the estimates using $\\hat{\\eta} = 1$ or 2, yet the shape of the survival function over the entire length better matched that for the single-hitting estimate $\\hat{\\eta} = 1$ ([Fig 6B](#pcbi.1007972.g006){ref-type=\"fig\"} top, red line, *\u03b7*~*CPM*~ = 1) than for the estimate $\\hat{\\eta} = 2$ ([Fig 6B](#pcbi.1007972.g006){ref-type=\"fig\"} top, blue line, *\u03b7*~*CPM*~ = 1). Second, visual inspections of the hazard experienced by individual targets throughout the simulations ([Fig 6C](#pcbi.1007972.g006){ref-type=\"fig\"}), revealed that in many CPM simulations with *\u03b7*~*CPM*~ = 1 and a +15m hitting delay there was substantial killing of targets that had not yet undergone long interactions with the CTL ([Fig 6C](#pcbi.1007972.g006){ref-type=\"fig\"}, first two grey bars), as would not be expected for multiple-hitting. Thus, both results ([Fig 6B and 6C](#pcbi.1007972.g006){ref-type=\"fig\"}) supported $\\hat{\\eta} = 1$ as the most likely candidate for the data derived from simulations with *\u03b7*~*CPM*~ = 1. However, the most conclusive result was obtained by evaluating the mean hazard experienced by contacted targets according to either of the two candidate estimates for the number of hits ($\\hat{\\eta}$ = 1 or 2). Integrating this value over the duration of the experiments ([Fig 6D](#pcbi.1007972.g006){ref-type=\"fig\"}, black lines) led to predictions for the killing rate over time which closely followed the data whenever a correct estimate for $\\hat{\\eta}$ was applied ([Fig 6D](#pcbi.1007972.g006){ref-type=\"fig\"}, comparing black and red lines in the upper panel, or black and blue lines below). In contrast, killing predictions from incorrect estimates of $\\hat{\\eta}$ were extremely poor, thus allowing for correct identification of the underlying *\u03b7*. Thus, our analysis shows that monitoring of cumulative interaction times between targets and single CTLs allows for proper estimates of the number of hits required for target cell death even when brief contacts between CTLs and targets cannot lead to hits, although the hitting rate may be underestimated in that case.\n\nDiscussion {#sec008}\n==========\n\nHere we have used stochastic simulations to show that 'multiple-hitting' is a plausible explanation for the heterogeneous and time-inhomogeneous killing activity recently observed for CTLs *in vitro* \\[[@pcbi.1007972.ref019]\\]. We showed that multiple-hitting leads to an increase in realised killing rate over time. Moreover, the extent of this late onset killing increases when more hits are required to kill targets, or when a greater number of antigen-presenting targets are simultaneously contacted. Furthermore, identical CTLs displayed varying killing performance depending on the number of targets available. Simulating CTLs with variable hitting rates, we also found that the killing performance of multiple-hitting CTLs is more heterogeneous than killing of single-hitting CTLs, given similar variation in underlying hitting rate. Overall, we conclude that multiple-hitting is sufficient to explain heterogeneous killing amongst clonal CTLs and there is no need to invoke an unobserved subpopulation of high-rate killers.\n\nGiven the dependence of the killing performance of multiple-hitting CTLs on several parameters that we describe here, we developed spatially explicit CPM simulations to assess methods for investigating whether multiple hitting occurs *in vitro* or *in vivo*. Our specific goal was retrieval of the hitting rate and number of hits required for CTLs to kill targets. Our model of dynamic conjugate formation can be conceptualised using Kendall's notation as an M/E~r~/1 queue \\[[@pcbi.1007972.ref024]\\]. Within this framework there is 1 \"server\" (in our case the CTL), with markovian arrival times (M: in our case conjugate formation events), and Erlang distributed (E~r~) \"service times\" which represent the killing process. It is known that for such models, the mean and variance (or any similar measure of variability) are insufficient for estimating the true parameters, and can only be used to approximate the distribution \\[[@pcbi.1007972.ref024]\\]. Instead of using population-level killing statistics, we were able to accurately recover model parameters from the CPM data by analysing the 'adjusted' cumulative contact durations between CTLs and individual targets, i.e. the total length of the interaction until either the target was killed or the experiment ended. Importantly, we found that measurements for both killed and surviving cells are required for this approach to be successful. This is because the limited time window of observation renders data that are in part censored, yet elapsed contacts that have not yet resulted in killed targets also contain information on underlying killing parameters. In a similar fashion, we previously developed a method to estimate absolute (i.e., not cumulative) cellular interaction times based on time lapse imaging data \\[[@pcbi.1007972.ref023]\\].\n\nAlthough CTL cooperativity and multiple-hitting have now been described in a number of settings \\[[@pcbi.1007972.ref007],[@pcbi.1007972.ref010]--[@pcbi.1007972.ref012]\\], a detailed quantitative description of the sequence of intracellular events which might underlie multiple-hitting does not yet exist. Several mechanisms can be envisaged which separately or collectively might result in target cells enduring sustained attacks from CTLs before death. A first factor which may explain the ability of target cells to endure sustained attacks is death occurring via the 'extrinsic apoptosis pathway', i.e., via tumour necrosis factor (TNF) or FAS-L. In the study of Vasconcelos et. al. \\[[@pcbi.1007972.ref019]\\], blockade of FAS-L did not diminish overall killing, suggesting that FAS-L was not involved in CTL killing. Moreover, separation of CTLs and targets in a transwell assay showed that contact was required before target cell apoptosis could occur. Although this result suggests that diffusible TNF did not contribute to target cell apoptosis, TNF is also expressed in transmembrane form \\[[@pcbi.1007972.ref025]\\] and may have contributed to contact-dependent killing, or could have synergised with other effector pathways. Furthermore, TNF or interferon-\u03b3---another hallmark cytokine produced by activated CTLs---have been linked to an upregulation of FAS-L receptors in different cell types \\[[@pcbi.1007972.ref026],[@pcbi.1007972.ref027]\\], or might otherwise synergise with FAS-L to induce target cell apoptosis \\[[@pcbi.1007972.ref028]\\]. The possibility of synergistic activators of the extrinsic apoptosis pathway is intriguing since activation of such mechanisms might explain delayed onset of burst-killing. This was observed in recent studies in which natural killer cells initially controlled tumour cell targets with a fast-acting, perforin-dependent mechanism, before switching to a mechanism primarily depending on engagement of death receptors \\[[@pcbi.1007972.ref017],[@pcbi.1007972.ref018]\\]. It would be useful to investigate whether CTLs also utilise this mechanism.\n\nA second factor which may account for multiple-hitting is heterogeneity in delivery of perforin and granzymes. Perforin alone induces rapid pore formation in target cell membranes, with such membrane disruption expected to increase the metabolic burden on target cells. Even if insufficient to directly induce apoptosis, one would expect such depletion to divert resources from adaptive cellular stress responses, thereby sensitising cells to death from other mechanisms. Granzymes are a diverse set of cytotoxic proteases with a broad array of intracellular targets \\[[@pcbi.1007972.ref029]\\]. A recent review highlights that perforin-mediated pore formation may or may not be accompanied by delivery of granzyme molecules into the cytosol \\[[@pcbi.1007972.ref030]\\]; a requirement for granzyme delivery appears to be the establishment of a sufficiently large pore at the point of contact between CTL and target. Examination of recent 4D images of CTL--target engagement highlight potential for heterogeneous delivery of cytotoxic molecules \\[[@pcbi.1007972.ref008]\\]. That study showed the capability of a single CTL to rapidly organise lytic molecules around the centrosome upon initial target recognition and to subsequently polarise the centrosome towards the target. This sequence of events results in a strong and stable cytotoxic synapse with a high local density of perforin and granzymes. Anecdotal evidence from this same work indicates that there can also be an alternative outcome: In one observation a CTL attempted to form two immunological synapses with one target, with the result that effective centrosome polarisation towards either synapse did not occur and ultimately both synapses were aborted without target cell death (see S8 Video in reference \\[[@pcbi.1007972.ref008]\\]). Other observations of CTLs simultaneously polarising granules towards multiple targets \\[[@pcbi.1007972.ref009]\\] demonstrate that the formation of multiple immunological synapses does not necessarily preclude CTLs from killing. Taken together, these observations suggest that due to the diversity of possible damage pathways activated by CTLs as well as the potential for heterogeneity in delivery of granules, several mechanistic explanations for multiple-hit induced killing remain open.\n\nGiven the breadth of cytotoxic weaponry available to a single CTL, it is apparent that experimental interference with one or more CTL effector functions is insufficient to conclude that one or another pathway is primarily involved in target cell death in a given experiment. We suggest high resolution, *in vitro* imaging as an effective means of achieving insight into the CTL killing process. Such high-resolution imaging would have several benefits: clear visualization of the polarisation of the lytic granules towards target cells would allow acquisition of statistics regarding the lethality of hits. Moreover, monitoring of individual target cells over time would provide statistics regarding the formation and abortion rates of immunological synapses and regarding the probability of target cell death after multiple hits. In addition, such approaches would allow investigation of the possibility of target cell recovery between successive hits, along with assessing the timescale over which such recovery might occur. Although such spatio-temporal resolution might be challenging to achieve experimentally, recent approaches using structured environments \\[[@pcbi.1007972.ref031],[@pcbi.1007972.ref032]\\] provide a possible means of achieving more refined control of CTL-target interactions.\n\nIn conclusion, in addition to recent efforts to further characterise heterogeneity amongst CTLs, greater attention is needed to simultaneous monitoring of mechanisms activated in target cells after the target has been contacted by a CTL, assisted by statistical analyses and computational methods such as those presented here. Experimental research particularly involving use of e.g. caspase-8 reporters or reporters of granzyme activity to compare the relative importance of different killing mechanisms, as recently done in NK cells \\[[@pcbi.1007972.ref017],[@pcbi.1007972.ref018]\\] is crucial. Computational models can then be used to compare results between different experimental assays, thereby quantitatively assessing the contribution of identified CTL effector functions in different contexts.\n\nMethods {#sec009}\n=======\n\nMonte Carlo simulations {#sec010}\n-----------------------\n\nWe devised stochastic simulations representing different \"wells\" in which individual CTLs killed targets. The setup of the simulations was based on published data by Vasconcelos *et al*. \\[[@pcbi.1007972.ref019]\\]. In brief, Vasconcelos *et al*. incubated pre-activated human-derived CTL clones with Epstein-Barr virus transformed B cell targets for 12 hours in microwells (*N*~*w*~ = 259). Each microwell contained a single CTL confined with an indeterminate (approximately 10--20, see Fig 4A in reference \\[[@pcbi.1007972.ref019]\\]) number of targets. Microwells were approximately cylindrical and had a cross-section diameter of approximately 100\u03bcm. A caspase reporter was used to determine the killing rate of individual CTLs over time. Similarly, our simulations featured *N*~*w*~ independent simulations, each containing *n* initially unhit targets and lasting for a simulated time period of 12 hours, or until all targets had been killed. The simulations proceed as follows:\n\n1.  A random variable *x*~*wait*~, representing the waiting time until the next CTL hit, is drawn from the exponential distribution with rate parameter equal to the CTL hitting rate *\u03bb*. The current simulation time is increased by *x*~*wait*~.\n\n2.  A random target is selected and its number of hits is increased by one.\n\n3.  If a target has received sufficient hits for death (i.e., *\u03b7* hits), it is immediately removed from the simulation.\n\nIn some simulations, we extended the rules in order to reflect typical *in vitro* assays more accurately:\n\n1.  ***Variable target numbers*.** Each simulation contained a single CTL and a variable number of targets *n*. For each well the number of targets was drawn from a Poisson distribution with mean $\\overline{n}$.\n\n2.  ***Variable hitting rate*.** For each simulation the hitting rate *\u03bb* of each CTL was a normally distributed random variable. The standard deviation of this distribution was used as a model parameter, with larger standard deviation reflecting CTL populations with greater intrinsic heterogeneity in killing performance between individuals.\n\n3.  ***Dynamic conjugate formation*.** We considered that hit delivery had to be preceded by conjugate formation and that at *t* = 0 *hrs* the CTL has not yet encountered any targets, and that CTLs form new conjugates with targets at constant rate *k*~*on*~ and abort conjugates with constant rate *k*~*off*~. Thus these simulations consider 4 distinct types of event: in addition to hitting and dying, we now have conjugate formation and conjugate abortation. The Gillespie algorithm was used to determine the type of event and waiting time between subsequent events \\[[@pcbi.1007972.ref033]\\], except for target cell death which occurs immediately after the lethal hit just as in our \"all at risk\" simulations.\n\nParameter estimation for the dynamic conjugate formation model was based on four reported values from Vasconcelos *et*. *al*. \\[[@pcbi.1007972.ref019]\\]: the population killing averages for the high rate killers (6.4 targets killed per 12 hours) or low rate killers (2.8 targets killed per 12 hours), the fraction of the population reported to be high rate killers (\u2153), and the breakpoint after which the high rate phenotype appeared (8--10 hours; we took 9 hours for this value). From these 4 reported values we derived three statistics for fitting our Monte Carlo simulations with dynamic conjugate formation: the mean (a~1~) and variance (a~2~) of the number of killed targets per CTL after 12 hours, and the expected number of killed targets per CTL at the breakpoint of 9 hours (a~3~). We estimated the killing at 9 hours by noting that the high rate group had not yet emerged at 9 hours, before which all cells killed at an approximately constant rate. Thus extrapolating from the low rate killing average at 12 hours (2.8 x 9/12) gives approximately 2 targets killed at the 9-hour breakpoint (note that this is also consistent with Fig 4B of Vasconcelos et. al \\[[@pcbi.1007972.ref019]\\]). Thus, the experimental estimates were: a~1~ = 4, a~2~ = 6.9 and a~3~ = 2. To fit to these estimates, we measured the same statistics (b~1,2,3~) from our simulations and then minimised the root mean squared error: $$RMSE = \\sqrt{}\\left( 1/3 \\cdot {\\sum_{i:1,2,3}\\left( {a_{i} - b_{i}} \\right)^{2}} \\right),$$ for different values of the parameters *\u03b7*, *\u03bb*, *k*~*on*~, and *k*~*off*~. For the stochastic optimisation we performed 10 repeats for all combinations of selected discrete values of *\u03b7*, *k*~*on*~, and *k*~*off*~ ([S2 Fig](#pcbi.1007972.s004){ref-type=\"supplementary-material\"}), and then for each combination we estimated *\u03bb* based on *N*~*w*~ = 1000 repeats and the optimise function in R. Dynamic conjugate simulations were written in C++ using the Rcpp package. Biological interpretation of parameters for the stochastic simulations are summarised in [Table 1](#pcbi.1007972.t001){ref-type=\"table\"} and the parameter values used throughout the manuscript are provided in [S1 Table](#pcbi.1007972.s001){ref-type=\"supplementary-material\"}.\n\n10.1371/journal.pcbi.1007972.t001\n\n###### Stochastic simulation parameters.\n\n![](pcbi.1007972.t001){#pcbi.1007972.t001g}\n\n  parameter             biological interpretation\n  --------------------- ------------------------------------------\n  *\u03b7*                   number of hits required for target death\n  $\\overline{n}$        mean number of targets in a well\n  *\u03bb* (hr^-1^)          hitting rate\n  *k*~*on*~ (hr^-1^)    conjugate formation rate\n  *k*~*off*~ (hr^-1^)   conjugate dissociation rate\n\nSpatial simulations {#sec011}\n-------------------\n\nWe developed spatial simulations of CTLs killing in microwells, with the aim of generating noisy and undersampled artificial data representative of data generated by microscopy, data which can be used to test methods for recovery of parameters governing CTL hitting. To this end we employed the cellular Potts model (CPM) framework \\[[@pcbi.1007972.ref034]\\], a formalism we used previously to simulate T cell-target cell interactions \\[[@pcbi.1007972.ref011],[@pcbi.1007972.ref035],[@pcbi.1007972.ref036]\\]. The CPM is a lattice based model, with entities such as cells represented by assigning individual lattice sites a 'spin' value, to identify them as belonging to a specific entity. The model evolves via minimisation of an energy function, the Hamiltonian: $$H = H_{sort} + H_{l} + H_{act}.$$\n\nHere, *H*~*sort*~ represents interactions between cell surfaces and deviations from a target cell area; *H*~*sort*~ is defined as \\[[@pcbi.1007972.ref034]\\]: $$H_{sort} = {\\sum_{{(a(\\sigma) - A_{q(\\sigma)})}^{2}}{J\\left( {q\\left( {\\sigma\\left( {i,j} \\right)} \\right),q\\left( {\\sigma\\left( {i^{\\prime},j^{\\prime}} \\right)} \\right)} \\right)\\left( {1 - \\delta_{\\sigma({i,j}),\\sigma({i^{\\prime},j^{\\prime}})}} \\right) + \\zeta_{a}{\\sum_{spin\\ types\\ \\sigma}\\left( a(\\sigma) - A_{q(\\sigma)} \\right)^{2}}},}$$ where *\u03c3*(*i*,*j*) is the spin of an individual cell of type *q* at grid point with *x* coordinate *i* and *y* coordinate *j*; *J*(*q*,*q*\u2032) is the surface energy between cells of type *q* and *q*\u2032; *\u03b4*~*\u03c3*,*\u03c3*\u2032~ represents the Kronecker delta; *a*(*\u03c3*) represents the actual area of a cell and *A*~*q*(*\u03c3*)~ the target area for a cell of type *q* (we refer to this as area rather than volume because we employ 2D simulations); *\u03c2*~*a*~ is a weighting term for the area constraint; Note that the sum of the surface energies are calculated over each third order neighbour of a 2D grid site.\n\nOur model also includes a term for surface area conservation of individual cells \\[[@pcbi.1007972.ref037]\\]: $$H_{l} = \\zeta_{l}{\\sum_{\\sigma}\\left( l(\\sigma) - L_{q(\\sigma)} \\right)^{2},}$$ where *L*~*q*(*\u03c3*)~ is the target perimeter for cells of type *q*, *l*(*\u03c3*) is the current perimeter of a cell with type *\u03c3* (determined as the total length of the boundary interfaces with grid sites of differing spin), and *\u03b6*~*l*~ is the weight of the perimeter constraint. We set $L_{q} = 2\\pi\\sqrt{A_{q}}$, i.e., the ratio of a circle's perimeter to its area, so that the term *H*~*l*~ is minimised when cells become perfectly circular. We set *\u03b6*~*l*~ lower for the CTLs than for the target cells, implying that the targets retained a spherical shape whereas CTLs were much more deformable in our simulations.\n\nFinally, the Hamiltonian includes a term *H*~*Act*~ to drive the motility of CTLs \\[[@pcbi.1007972.ref022]\\]: $$H_{Act} = \\frac{\\varsigma_{Act}}{{Max}_{Act}}\\left( {GM}_{Act}\\left( u \\right) - {GM}_{Act}\\left( v \\right) \\right).$$\n\nThis follows an actin-driven cell motility model with protrusions driving the migration of cells. In this model actin is modelled explicitly and when a cell occupies a new site on the lattice, the site is given an actin value *Max*~*Act*~. The actin activity *Act* in that site then decreases by one at every Monte carlo step until it reaches 0. The function: $${GM}_{Act}\\left( u \\right) = \\left( {\\prod_{y \\in V(u)}{Act\\left( y \\right)}} \\right)^{1/|{V(u)}|}$$ calculates the geometric mean actin activity around site *u*, where \\|*V*(*u*)\\| are the second order Moore neighbours of site *u* (see Fig 1 of reference \\[[@pcbi.1007972.ref022]\\]). The model favours updates from sites *u* with high actin activity into neighbouring sites *v* with low actin activity, resulting in local positive feedback. The CPM parameter *\u03c2*~*Act*~ is a weighting term the strength of which we varied to control the motility of the CTLs. The *H*~*act*~ term was not applied to target cells, which are moved only passively via interactions with the CTL and other targets.\n\nIn our spatial simulations we also implemented a contact-limited hitting behaviour for the CTL. We take CTL killing of targets to occur primarily via the perforin/granzyme pathway so we consider only contacted targets to be at risk, although our model should also apply to FAS-Ligand mediated killing, which is also contact-limited. When multiple targets are contacted by a CTL, it seems likely that the risk of getting hit is not equal for all targets, as polarisation of the lysosome towards specific targets should occur in order to permit delivery of lytic molecules to the target \\[[@pcbi.1007972.ref008],[@pcbi.1007972.ref009]\\]. Although we did not model the polarisation of the lysosome explicitly, we do take into account a tendency for CTLs to unequally distribute hits towards contacted targets. To achieve this, we implement the same baseline hitting probability as in the Gillespie simulations, and multiply this by *\u03b8*~*i*~(*t*), the proportional fraction of CTL: target membrane interface occupied by the target at time point *t*: $$\\theta_{i}\\left( t \\right) = \\frac{l_{i}\\left( t \\right)}{L_{i}\\left( t \\right)},$$ where *l*~*i*~(*t*) is the length of the interaction interface between target *i* and the CTL inhabiting the same well, *L*~*i*~(*t*) the total interaction interface length of the CTL that contacts target *i*, including any other co-contacting targets. Because CTLs are considered to hit targets at a constant rate *\u03bb*, for simulations without delayed hitting each target's risk of being hit during a brief time interval *\u0394t* equals *\u03bb\u03b8*(*t*)\u22c5*\u0394t*. For some simulations we introduced a rule preventing CTLs from hitting targets for a specified delay period each time a CTL contacted or recontacted a target. This was implemented by means of a counting variable inside each target, such that hits would not register until the target had been in continuous contact with the CTL for the specified interval.\n\nSimulations had a spatial scale of 1 \u03bcm pixel^-1^ and were 100 \u03bcm^2^ in area. The simulation space consisted of a circular area representing a microwell within which one CTL and usually between 10--20 targets were constrained to move. Simulations had a temporal scale of 1 second per Monte Carlo step. Parameters employed in the CPM simulations are given in [Table 2](#pcbi.1007972.t002){ref-type=\"table\"}. Simulation output was produced every 120 Monte Carlo steps (2 minute intervals), corresponding to a typical sampling frequency in time-lapse imaging data with multiple wells \\[[@pcbi.1007972.ref019]\\]. CPM simulations were developed within the morpheus framework \\[[@pcbi.1007972.ref038]\\].\n\n10.1371/journal.pcbi.1007972.t002\n\n###### Cellular Potts simulation parameters.\n\n![](pcbi.1007972.t002){#pcbi.1007972.t002g}\n\n  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n  parameter       value                                                                                     Description\n  --------------- ----------------------------------------------------------------------------------------- -----------------------------------------------------------------------------------------------------------------------\n  *J*~*\u03c3*,*\u03c3*\u2032~   *J~tar,tar~* = 0.7; *J*~*ctl*,*tar*~ = \u22123; *J*~*tar*,*well*~ = 0; *J*~*ctl*,*well*~ = 0   surface energies between cell types\n\n  *A*~*q*~        *A*~*ctl*~ = 140 *\u03bcm*^2^\\                                                                 the target area for a cell of type *q*\n                  *A*~*tar*~ = 340 *\u03bcm*^2^\\                                                                 \n\n  *L*~*q*~        $2\\sqrt{\\pi A_{q}}$                                                                       the target perimeter for a cell of type *q*\n\n  *\u03c2*~*l*~        *\u03c2*~*l*,*ctl*~ = 0.1\\                                                                     strength of cell perimeter constraint\n                  *\u03c2*~*l*,*tar*~ = 0.25                                                                     \n\n  *\u03c2*~*a*~        *\u03c2*~*a*,*ctl*~ = 1\\                                                                       strength of cell area constraint\n                  *\u03c2*~*a*,*tar*~ = 1                                                                        \n\n  *\u03c2*~*Act*~      *\u03c2*~*Act*,*low*~ = 2\\                                                                     strength of actin protrusion dynamics: *\u03c2*~*Act*,*low*~ for low-motility and *\u03c2*~*Act*,*high*~ for high motility CTLs\n                  *\u03c2*~*Act*,*high*~ = 10                                                                    \n\n  *Max*~*Act*~    50                                                                                        Actin activity value when CTLs occupy a new lattice site\n  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nSupporting information {#sec012}\n======================\n\n###### Summary of parameters used in stochastic simulations.\n\nData and code used in this project are available (<http://doi.org/10.17605/OSF.IO/6GQYP>).\n\n(PDF)\n\n###### \n\nClick here for additional data file.\n\n###### Fitting procedure and hypothesis comparison for multiple-hitting model and subpopulation model.\n\n(PDF)\n\n###### \n\nClick here for additional data file.\n\n###### Multiple hitting increases inherent variability in killing performance between individual CTLs.\n\nA-B) Distribution of killed target numbers after 12 hours (A) when intrinsic hitting rates *\u03bb* (B) are drawn from a normal distribution with mean $\\overline{\\lambda}$ and standard deviation $\\sigma_{\\lambda}\\left( \\lambda \\sim Normal\\left( \\overline{\\lambda},\\sigma_{\\lambda} \\right) \\right.$). C) Overdispersion for the variance in killed targets in A relative to the variance expected for a Poisson distribution, i.e., the ratio of the variance (*var*(*x*)) to the mean ($\\overline{x}$) number of targets killed after 12 hours (vertical axis). The horizontal axis is the ratio of the standard deviation to the mean value of the intrinsic hitting rate.\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Parameter estimation for Monte Carlo simulations with dynamic contacts.\n\nA\\) Estimated hitting rates (*\u03bb*, represented by colour) for various combinations of the number of hits (*\u03b7*, rows), contact formation rates (k~on~, vertical axes in sub-panels), or contact escape rates (k~off~, horizontal axes in sub-panels). Ten repeats (across columns) were performed for the optimisation step, using N~w~ = 10^3^ CTLs per tested value of *\u03bb*. After fitting we validated our results by performing N~w~ = 10^4^ simulations with each best fitting parameter combination, which is shown here. B) Root mean square residual errors for the best fitting parameter estimates (panel arrangement is as described in S2A Fig legend). Results are from validation simulations, using N~w~ = 10^4^ simulations per parameter combination.\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Monte Carlo simulated CTL:target interaction durations amongst surviving and killed targets.\n\nA\\) Sample density of killed targets in Monte Carlo simulations lasting until all targets were killed, with different numbers of hits (*\u03b7*, on different rows). B) Sample density of killed targets in Monte Carlo simulations stopped after 12 hours. C) Sample density of surviving targets, corresponding to the 'absent' portion of the distribution for killed targets in B. The red line in A and B is the function f~k~, which describes how the relative probability until targets receive \u03b7 hits arriving at a constant rate \u03bb depends on the cumulative interaction time \u03c4, for a gamma distributed waiting time. For all S3 Fig: N~w~ = 100, n = 12 targets per well, all targets equally at risk. Parameter combinations used were: (*\u03b7* = 1,*\u03bb* = 0.34; *\u03b7* = 2,*\u03bb* = 1.17; *\u03b7* = 3,\u03bb = 2.12; *\u03b7* = 4,*\u03bb* = 3.14; *\u03b7* = 5,*\u03bb* = 4.22).\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Maximum likelihood estimation for the killing rate of single-hitting CTLs.\n\nA\\) Poisson distributions for the number of targets used to start simulations in S4 Fig, with mean $\\overline{n} = 8\\ or\\ 16$ as shown. B) Number of killed targets after 12 hours for N~w~ = 2 x 3 x 1000 simulations, each group of N~w~ = 1000 started with one of the 2 distributions in A, and with one of the 3 indicated parameter settings. C) Density of killed targets after 12 hours from 'Mixed' distributions resulting from *\u03b7* = 1,*\u03bb*~***LR***~ = **0**.2,*\u03bb*~*HR*~ = 0.7 and either $\\overline{n}$ = 8 *and m* = 0 (left panel), or $\\overline{n}$ = 16 *and m* = 0.67 (right panel). Note that for $\\overline{n}$ = 8 the killing of multiple-hitting CTLs became greater than the high rate subpopulation of single-hitting CTLs; $\\overline{n}$ = 8 was only used for testing robustness of the estimators on heavily censored data. D) Relative likelihood of candidate hitting rate estimates, $\\hat{\\lambda}$, compared to the maximum likelihood estimate, ${\\hat{\\lambda}}_{ML}$, resulting from application of the Poisson estimator separately to each of the single-hitting (*\u03b7* = 1) datasets shown in B. Relative likelihood are shown either for the dataset in its entirety (dashed lines), or for a randomly selected sample of N~W~ = 10 (solid lines). E) Examples of testing datasets derived from the multiple-hitting population (B, $\\overline{n}$ = 16, *\u03b7* = 10) or from a mixture of single-hitting CTLs (B, $\\overline{n}$ = 16, *\u03b7* = 1, where the true density of killed targets in the mixture distribution is in C). F) Relative likelihood of candidate hitting rate estimates, $\\hat{\\lambda}$, compared to the maximum likelihood estimate, ${\\hat{\\lambda}}_{ML}$, for constrained fits constructed from either the subpopulation datasets, or from multiple-hitting datasets, for three samples with either N~w~ = 30,100, or 1000 (note the multiple-hitting-generated data (*\u03b7* = 10) is therefore fully represented by the N~w~ = 1000 case).\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Testing for multiple-hitting CTLs versus subpopulations of single-hitting CTLs.\n\nA\\) Maximum likelihood estimates for the hitting rate, ${\\hat{\\lambda}}_{ML}$, with either the gamma or Poisson estimators, both constrained to a uniform single-hitting population (i.e. by forcing *\u03b7* = 1 for the gamma estimator and by forcing *m* = 1 for the Poisson estimator). Each of the 2x4x10 = 80 points represents one of the 4x10 testing populations from [S4E Fig](#pcbi.1007972.s006){ref-type=\"supplementary-material\"} (here indicated by facet labels), fit with both of our estimators (x-axis). B) Difference between the log likelihood function evaluated with the constrained versus unconstrained Gamma estimator $log\\ L\\left( {\\hat{\\lambda}}_{ML},{\\hat{\\eta}}_{ML} \\right)$ (dark bars); or with the constrained versus unconstrained Poisson estimator $log\\ L\\left( {\\hat{\\lambda}}_{HR,ML},{\\hat{\\lambda}}_{LR,ML},{\\hat{m}}_{ML} \\right)$ (light bars). Each of the 40 testing populations occupies one horizontal bar, with the details of the testing populations as indicated in facet labels. For the x-axis scaling (negative values are not possible), the relative size of the dark v.s. light bars is proportional to the strength of the evidence for the multiple-hitting hypothesis (dark bars) versus the subpopulation hypothesis (light bars). C) The constrained estimates for the hitting rate parameters, ${\\hat{\\lambda}}_{ML}$, (circles; also shown in A) or their unconstrained counterparts (red asterisks) for each testing population (points on x-axis). For the Gamma estimator (top row) the estimated ${\\hat{\\eta}}_{ML}$ is shown only where ${\\hat{\\eta}}_{ML} > 1$. For the Poisson estimator (bottom row), the unconstrained estimates for ${\\hat{\\lambda}}_{HR,ML},{\\hat{\\lambda}}_{LR,ML}$ are above and below their counterpart constrained estimates, and the Gamma and Poisson estimators can be compared per population. D) Distribution of all cumulative interaction times, *\u03c4* (killed and surviving targets shown separately in columns), for all N~w~ = 1000 members of each of the 3 generating populations (as shown in [S4B Fig](#pcbi.1007972.s006){ref-type=\"supplementary-material\"}). Although the 2 single-hitting populations were combined (upper row), the separate contribution of the *\u03bb*~*HR*~ (red) or *\u03bb*~*LR*~ (blue) populations is indicated by color. Multiple-hitting CTLs (green) are shown separately (bottom row).\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Maximum likelihood estimation for CPM simulations with a hitting threshold time.\n\nA-B) Heatmaps of the likelihood function around the maximum likelihood estimates for the killing parameters *\u03b7* and *\u03bb*, in CPM simulations under various conditions. In A, results are shown for various *\u03b7* values (rows) and for both high-motility (left colum) and low-motility (right column) conditions for simulations with 15 minute hitting delay. In B, results are shown for high motility CTLs at all tested values of the delay (in range 0--15 minutes, across columns). The horizontal and vertical lines in A-B mark the values of the CPM parameters used to generate the data for each group and the boundary enclosing the 95% confidence region is marked with a thin blue line.\n\n(TIFF)\n\n###### \n\nClick here for additional data file.\n\n###### Simulation of high-motility CTL, requiring 5 hits to kill targets.\n\n(AVI)\n\n###### \n\nClick here for additional data file.\n\n###### Simulation of low-motility CTL, requiring 5 hits to kill targets.\n\nIn all videos, CTLs are shown in red whilst uncontacted targets are in grey. Contacted targets are shaded blue based on their share of total CTL:target interface, i.e. the probability that they will receive the next hit generated by the CTL. Targets are overlaid with the number of hits they have received. Elapsed simulation time (hours:minutes) is displayed in the upper right corner of the videos.\n\n(AVI)\n\n###### \n\nClick here for additional data file.\n\nWe would like to thank Delphine Guipouy and Lo\u00efc Dupr\u00e9 for useful discussions on the set-up of previously published microwell experiments.\n\n10.1371/journal.pcbi.1007972.r001\n\nDecision Letter 0\n\nDe Boer\n\nRob J.\n\nDeputy Editor\n\nYates\n\nAndrew J.\n\nAssociate Editor\n\n\u00a9 2020 De Boer, Yates\n\n2020\n\nDe Boer, Yates\n\nThis is an open access article distributed under the terms of the\n\nCreative Commons Attribution License\n\n, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.\n\n12 Feb 2020\n\nDear Dr. Beltman,\n\nThank you very much for submitting your manuscript \\\"Heterogeneous, Delayed-Onset Killing by Multiple-Hitting T Cells: Stochastic Simulations to Assess Methods for Analysis of Imaging data\\\" for consideration at PLOS Computational Biology.\n\nAs with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers\\' comments.\n\nWe cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers\\' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.\n\nWhen you are ready to resubmit, please upload the following:\n\n\\[1\\] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript.\u00a0Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.\n\n\\[2\\] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).\n\nImportant additional instructions are given below your reviewer comments.\n\nPlease prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.\n\nThank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don\\'t hesitate to contact us if you have any questions or comments.\n\nSincerely,\n\nAndrew J. Yates\n\nAssociate Editor\n\nPLOS Computational Biology\n\nRob De Boer\n\nDeputy Editor\n\nPLOS Computational Biology\n\n\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\n\nReviewer\\'s Responses to Questions\n\n**Comments to the Authors:**\n\n**Please note here if the review is uploaded as an attachment.**\n\nReviewer \\#1: Comments:\n\nBeck et al simulate CTL-mediated immune responses in different settings to better understand how CTL-mediated killing of target cells is regulated in vitro.\n\nThey use different simulation approaches to address the very important open question of how CTL-mediated killing of target cells can be better understood. This remains a very important question, given the high clinical importance of CTL-mediated immune responses against infectious diseases and cancer in the current age of immune-cell based therapeutic approaches.\n\nReviewer comments regarding the text:\n\nRegarding the Monte Carlo Simulations in Figure 1, it remains a little unclear how a small increase in simulated target cell numbers (plus 1) would change the outcome of the simulation in the way presented in Figure 1B (for the 100 hit case). Obviously, the \"100 hit case\" is a very extreme situation -- but maybe this outcome of the simulation could be discussed and explained in more detail.\n\nMaybe a plotting of the effector-to-target cell ratio of these simulations would help to better understand this result?\n\nRegarding the \"over-dispersion\" -- maybe a short explanation of how such a conclusion was reached might be helpful (how was dispersion measured, and how can the cut-off that determines over-dispersion be justified).\n\nRegarding the spatial model, it remains unclear how the \"two CTL motility patterns\" are used in the simulations: how are the two states set for individual cells? Does target cell contact decrease motility? Based on what experimental data are these motility features defined?\n\nFinally, to better understand how \"cumulative contact time\" in the simulations can be interpreted a short description of how the simulated CTL deliver the \"lethal hits\" in relation to contact duration would be helpful. How is \"hit delivery\" defined in the spatial model? Could one contact event lead to multiple \"hits\"?\n\nReviewer comments on Material and Methods section:\n\n1.) Monte Carlo simulations:\n\nHow were these simulations performed? How was the data from Vasconcelos et al used exactly and where can the used data be found?\n\nHow many simulations were performed?\n\n2.) Spatial simulations\n\nHow was target cell motility defined? Why are the targets motile -- how much does that affect the different conclusions (Maybe check results with non-motile and motile targets).\n\nReviewer comments on Figures:\n\nFigure 1:\n\nFig 1B: what does the Y-axis label really mean (\"frequency\")? Maybe this can be described in the figure legend.\n\nFig 1D: The Y axis is cut at 10 -- is this really necessary?\n\nFig 1E: what does the Y-axis label mean -- is it different to Fig 1B?\n\nFigure 2:\n\nUsually, target cell binding is expected to alter CTL migration -- so how does target binding affect the CTL motility here?\n\nHow are the high vs low motility states \"regulated\" in these simulations?\n\nReviewer \\#2: In this study, the authors use stochastic simulations to examine if heterogeneity in CTL killing dynamics can be explained by the requirement of target cells to receive multiple lytic hits. Using explicit spatial simulations based on the CPM-framework, they further investigate how this hitting rate and the number of required hits per target cell can be inferred from imaging data. Based on their analyses they show that measuring the cumulative duration of CTL-target contacts would improve the accuracy of estimating CTL killing kinetics.\n\nThe topic is timely and relevant as understanding CTL efficacy is an important aspect for designing optimal therapeutic vaccination and treatment strategies, as e.g. against cancer. The study is well written and thoroughly structured. With this theoretical analysis the authors provide a reasonable explanation for previous observations from experimental studies and propose required measurements for further experiments. However, the study remains a bit limited by focusing on only one explanation for CTL killing dynamics.\n\n\\# Major points:\n\n(1.) The authors state that with the multiple-hitting-scenario, there is no need to invoke an unobserved subpopulation of high-rate killers (p. 22) as suggested by other studies. While this is true and nicely shown, I think the study would substantially benefit if the authors also show how the proposed information from imaging studies should differ in case of the latter scenario or others. It could be quite interesting to know on what type of measurements one has to focus in order to differ between different hypotheses, such as having cell populations that are heterogeneous (either in their killing efficacy (CTL) or susceptibility to killing (target cell)), having serial or multiple-killing, or assuming single- or multiple hit killing.\n\n(2.) The ability to infer the hitting parameters in case of multiple-hitting CTL from CTL-target (cumulative) contact times in case of multiple-hitting is quite robust and interesting. However, measuring the cumulative contact times might be not sufficient in case that active conjugate formation would require the stopping of CTLs to allow them to deliver their lethal hits (Wiedemann et al., PNAS 2006), i.e., requiring a minimal contact time. This seems not to be directly implemented within the CPM as the hitting probability only considers the contact length for distributing the hit across multiple target cells.\n\n(3.) Another question concerns the parameterizations of the CPM. Do \"high-\" and \"low-motility\" CTL correspond in some way to the dynamics observed within the experiments or were they arbitrarily chosen?\n\n(4.) Why is the average number of target cells killed after 12 hours for a density of 15 target cells higher when several hits are required compared to only one? This seems to be counterintuitive unless the hitting rates differ between the scenarios, maybe due to the adjustment done before and mentioned in the text? However, Figure 1E actually shows that for a given target cell concentration, the distribution gets shifted to the left the more hits are required. The values of the rates used for simulation should be mentioned within the text or the figure legends. The corresponding Table (Table 1) seems to be empty.\n\n\\# Minor points:\n\n\\- Figure 4A and Figure 5F are very difficult to read. Maybe there are better ways of representation, e.g. using different colors for each given (correct) parameter combination and similar colors with point sizes corresponding to frequencies for the estimates?\n\n\\- Figure 1B: Does the red dotted line always refer to the 16 targets case for each row separately, i.e. for each number of hits (1,10,100)?\n\n\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\n\n**Have all data underlying the figures and results presented in the manuscript been provided?**\n\nLarge-scale datasets should be made available via a public repository as described in the *PLOS Computational Biology* [data availability policy](http://journals.plos.org/ploscompbiol/s/data-availability), and numerical data that underlies graphs or summary statistics should be provided in spreadsheet form as supporting information.\n\nReviewer \\#1: None\n\nReviewer \\#2: No: The parameters used for simulating the results shown in Figure 1 seem to be missing.\n\n\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\n\nPLOS authors have the option to publish the peer review history of their article ([what does this mean?](https://journals.plos.org/ploscompbiol/s/editorial-and-peer-review-process#loc-peer-review-history)). If published, this will include your full peer review and any attached files.\n\nIf you choose \"no\", your identity will remain anonymous but your review may still be made public.\n\n**Do you want your identity to be public for this peer review?** For information about this choice, including consent withdrawal, please see our [Privacy Policy](https://www.plos.org/privacy-policy).\n\nReviewer \\#1: No\n\nReviewer \\#2: No\n\n[Figure Files:]{.ul}\n\nWhile revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, [[https://pacev2.apexcovantage.com](https://pacev2.apexcovantage.com/)]{.ul}.\u00a0PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at [<figures@plos.org>]{.ul}.\n\n[Data Requirements:]{.ul}\n\nPlease note that, as a condition of publication, PLOS\\' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: <http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5>.\n\n[Reproducibility:]{.ul}\n\nTo enhance the reproducibility of your results, PLOS recommends that you deposit laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. For instructions, please see [[http://journals.plos.org/compbiol/s/submission-guidelines\\#loc-materials-and-methods](http://journals.plos.org/plospathogens/s/submission-guidelines)]{.ul}\n\n10.1371/journal.pcbi.1007972.r002\n\nAuthor response to Decision Letter 0\n\n13 May 2020\n\n###### \n\nSubmitted filename: review response.pdf\n\n###### \n\nClick here for additional data file.\n\n10.1371/journal.pcbi.1007972.r003\n\nDecision Letter 1\n\nDe Boer\n\nRob J.\n\nDeputy Editor\n\nYates\n\nAndrew J.\n\nAssociate Editor\n\n\u00a9 2020 De Boer, Yates\n\n2020\n\nDe Boer, Yates\n\nThis is an open access article distributed under the terms of the\n\nCreative Commons Attribution License\n\n, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.\n\n21 May 2020\n\nDear Dr. Beltman,\n\nWe are pleased to inform you that your manuscript \\'Heterogeneous, Delayed-Onset Killing by Multiple-Hitting T Cells: Stochastic Simulations to Assess Methods for Analysis of Imaging data\\' has been provisionally accepted for publication in PLOS Computational Biology.\n\nBefore your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.\n\nPlease note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.\n\nIMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.\n\nShould you, your institution\\'s press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.\n\nThank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology.\u00a0\n\nBest regards,\n\nAndrew J. Yates\n\nAssociate Editor\n\nPLOS Computational Biology\n\nRob De Boer\n\nDeputy Editor\n\nPLOS Computational Biology\n\n\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\\*\n\n10.1371/journal.pcbi.1007972.r004\n\nAcceptance letter\n\nDe Boer\n\nRob J.\n\nDeputy Editor\n\nYates\n\nAndrew J.\n\nAssociate Editor\n\n\u00a9 2020 De Boer, Yates\n\n2020\n\nDe Boer, Yates\n\nThis is an open access article distributed under the terms of the\n\nCreative Commons Attribution License\n\n, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.\n\n22 Jun 2020\n\nPCOMPBIOL-D-19-02233R1\n\nHeterogeneous, Delayed-Onset Killing by Multiple-Hitting T Cells: Stochastic Simulations to Assess Methods for Analysis of Imaging data\n\nDear Dr Beltman,\n\nI am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.\n\nThe corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript.\n\nSoon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article\\'s publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.\n\nThank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work!\n\nWith kind regards,\n\nLaura Mallard\n\nPLOS Computational Biology \\| Carlyle House, Carlyle Road, Cambridge CB4 3DN \\| United Kingdom <ploscompbiol@plos.org> \\| Phone +44 (0) 1223-442824 \\| [ploscompbiol.org](http://ploscompbiol.org) \\| \\@PLOSCompBiol\n\n[^1]: The authors have declared that no competing interests exist.\n"
}